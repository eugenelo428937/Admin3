# Tasks: Phase 5 - Entry Point Integration (VAT Calculation)

**Based on**: `plans/spec-2025-10-06-121922-plan.md` - Phase 5
**Created**: 2025-10-15
**Feature Branch**: `004-phase-5-entry-point-integration`
**Estimated Duration**: 2.5-3 days (22-25 hours)

## Overview

Phase 5 integrates VAT calculation with checkout entry points using Rules Engine. All VAT calculations are performed by the Rules Engine with ZERO hardcoded Python logic.

### Key Objectives
1. Trigger VAT calculation at `add_to_cart`, `checkout_start`, `checkout_payment`
2. Build cart context from existing cart data
3. Execute Rules Engine for VAT calculation
4. Aggregate VAT results and store in `cart.vat_result` JSONB
5. Update cart serializers for frontend consumption

---

## Prerequisites

✅ **Completed Phases**:
- Phase 1: Database Foundation (utils models, VAT data)
- Phase 2: Rules Engine Custom Functions (lookup_region, calculate_vat_amount, etc.)
- Phase 3: Master VAT Rule Creation (calculate_vat entry point)
- Phase 4: Regional VAT Rules (UK, EU, SA, IE, ROW rules)

✅ **Required Models**:
- `Cart` with `vat_result` JSONB field
- `CartItem` model with VAT fields
- `utils_countrys` with VAT rates
- `utils_country_region` with region mappings
- `VATAudit` model for audit trail

✅ **Required Rules**:
- Master rule: `calculate_vat`
- Regional rules: `calculate_vat_uk`, `calculate_vat_eu`, `calculate_vat_sa`, `calculate_vat_ie`, `calculate_vat_row`
- Product-specific rules for each region

---

## Phase 5.1: VAT Orchestrator Creation (TDD)

### TASK-501: Write VAT Orchestrator Tests (RED) ⚠️
- **TDD Stage**: RED
- **Time**: 2 hours
- **Files**: `backend/django_Admin3/cart/tests/test_vat_orchestrator.py`
- **Dependencies**: None

**Description**: Create comprehensive tests for VAT orchestrator that will build context, execute rules, aggregate results, and persist audit trail.

**Test Cases**:
```python
class VATOrchestratorTests(TestCase):
    def test_build_context_from_cart_single_item(self):
        # Test context building with 1 cart item

    def test_build_context_from_cart_multiple_items(self):
        # Test context building with multiple items

    def test_execute_vat_calculation_uk_customer(self):
        # Test UK customer VAT calculation

    def test_execute_vat_calculation_eu_customer(self):
        # Test EU customer VAT calculation (reverse charge)

    def test_execute_vat_calculation_sa_customer(self):
        # Test SA customer 15% VAT

    def test_execute_vat_calculation_row_customer(self):
        # Test ROW customer 0% VAT

    def test_aggregate_vat_totals_single_item(self):
        # Test aggregation with 1 item

    def test_aggregate_vat_totals_multiple_items_mixed_rates(self):
        # Test aggregation with mixed VAT rates

    def test_store_vat_result_in_cart_jsonb(self):
        # Test cart.vat_result JSONB structure

    def test_create_vat_audit_record(self):
        # Test VATAudit record creation

    def test_handle_rules_engine_failure_gracefully(self):
        # Test error handling when Rules Engine fails
```

**Acceptance Criteria**:
- ✅ All test cases written with proper assertions
- ✅ Tests use realistic cart data with product_type
- ✅ Tests verify JSONB structure matches expected format
- ✅ Tests verify VATAudit creation
- ✅ All tests FAIL when run (RED phase complete)

---

### TASK-502: Implement VAT Orchestrator (GREEN)
- **TDD Stage**: GREEN
- **Time**: 3 hours
- **Files**: `backend/django_Admin3/cart/services/vat_orchestrator.py`
- **Tests**: `backend/django_Admin3/cart/tests/test_vat_orchestrator.py`
- **Dependencies**: TASK-501

**Description**: Implement VAT orchestrator service that coordinates VAT calculation through Rules Engine.

**Implementation**:
```python
# cart/services/vat_orchestrator.py
from decimal import Decimal
from datetime import datetime, date
from rules_engine.services.rule_engine import rule_engine
from vat.models import VATAudit

class VATOrchestrator:
    """Orchestrates VAT calculation through Rules Engine."""

    def execute_vat_calculation(self, cart, entry_point='calculate_vat'):
        """Execute VAT calculation for cart."""
        # 1. Build context from cart
        context = self._build_context(cart)

        # 2. Execute Rules Engine
        results = rule_engine.execute(entry_point, context)

        # 3. Aggregate VAT totals
        aggregated = self._aggregate_totals(results)

        # 4. Store in cart.vat_result
        self._store_vat_result(cart, aggregated, results)

        # 5. Persist audit trail
        self._create_audit_record(cart, context, results)

        return aggregated

    def _build_context(self, cart):
        """Build Rules Engine context from cart."""
        return {
            'user': {
                'id': str(cart.user.id),
                'country': cart.user.country.code
            },
            'cart': {
                'id': str(cart.id),
                'items': [
                    {
                        'id': str(item.id),
                        'product_type': item.product_type,
                        'metadata': item.metadata or {},
                        'actual_price': str(item.actual_price),
                        'quantity': item.quantity,
                        'vat_amount': '0.00',
                        'vat_rate': '0.0000',
                        'exemption_reason': None
                    }
                    for item in cart.items.all()
                ]
            },
            'settings': {
                'effective_date': date.today().isoformat()
            }
        }

    def _aggregate_totals(self, results):
        """Aggregate VAT totals from rule results."""
        items = results.get('cart', {}).get('items', [])

        total_net = sum(
            Decimal(item['actual_price']) * item['quantity']
            for item in items
        )
        total_vat = sum(
            Decimal(str(item.get('vat_amount', '0.00')))
            for item in items
        )
        total_gross = total_net + total_vat

        return {
            'status': 'calculated',
            'items': items,
            'totals': {
                'net': str(total_net),
                'vat': str(total_vat),
                'gross': str(total_gross)
            },
            'region': results.get('context', {}).get('region', 'ROW'),
            'rules_executed': results.get('rules_executed', []),
            'execution_id': results.get('execution_id'),
            'timestamp': datetime.now().isoformat()
        }

    def _store_vat_result(self, cart, aggregated, results):
        """Store VAT result in cart.vat_result JSONB."""
        cart.vat_result = aggregated
        cart.save(update_fields=['vat_result'])

    def _create_audit_record(self, cart, context, results):
        """Create VATAudit record for compliance."""
        VATAudit.objects.create(
            cart=cart,
            order=None,
            rule_id=results.get('rules_executed', [])[0] if results.get('rules_executed') else None,
            input_context=context,
            output_data=results,
            execution_timestamp=datetime.now()
        )

# Singleton instance
vat_orchestrator = VATOrchestrator()
```

**Acceptance Criteria**:
- ✅ All tests from TASK-501 now PASS (GREEN phase complete)
- ✅ Context building includes all required fields
- ✅ Rules Engine execution returns proper results
- ✅ VAT totals aggregated correctly with Decimal precision
- ✅ cart.vat_result JSONB populated correctly
- ✅ VATAudit record created

---

### TASK-503: Refactor VAT Orchestrator (REFACTOR)
- **TDD Stage**: REFACTOR
- **Time**: 1 hour
- **Files**: `backend/django_Admin3/cart/services/vat_orchestrator.py`
- **Tests**: `backend/django_Admin3/cart/tests/test_vat_orchestrator.py`
- **Dependencies**: TASK-502

**Description**: Refactor orchestrator for improved readability, error handling, and maintainability while keeping all tests green.

**Refactoring Tasks**:
- Extract constants for JSONB keys
- Add comprehensive error handling with logging
- Add type hints for better IDE support
- Improve docstrings with examples
- Add performance logging for Rules Engine calls
- Extract helper methods for better separation of concerns

**Acceptance Criteria**:
- ✅ All tests still PASS after refactoring
- ✅ Code more readable and maintainable
- ✅ Error handling comprehensive
- ✅ No duplicate code

---

## Phase 5.2: Entry Point Integration (TDD)

### TASK-504: Write Cart View Integration Tests (RED) ⚠️
- **TDD Stage**: RED
- **Time**: 2 hours
- **Files**: `backend/django_Admin3/cart/tests/test_views_vat_integration.py`
- **Dependencies**: TASK-503

**Description**: Create integration tests for VAT calculation triggered at cart entry points.

**Test Cases**:
```python
class CartViewVATIntegrationTests(APITestCase):
    def test_add_to_cart_triggers_vat_calculation(self):
        # POST /api/cart/add/ → VAT calculated

    def test_add_to_cart_stores_vat_result_jsonb(self):
        # Verify cart.vat_result populated

    def test_checkout_start_recalculates_vat(self):
        # POST /api/checkout/start/ → VAT recalculated

    def test_checkout_payment_validates_vat(self):
        # POST /api/checkout/payment/ → VAT validated

    def test_cart_update_triggers_vat_recalculation(self):
        # PATCH /api/cart/items/{id}/ → VAT recalculated

    def test_cart_item_delete_triggers_vat_recalculation(self):
        # DELETE /api/cart/items/{id}/ → VAT recalculated

    def test_vat_calculation_failure_handled_gracefully(self):
        # Test error handling when Rules Engine fails
```

**Acceptance Criteria**:
- ✅ All test cases written with proper assertions
- ✅ Tests verify API response includes VAT data
- ✅ Tests verify cart.vat_result JSONB structure
- ✅ Tests cover all entry points
- ✅ All tests FAIL when run (RED phase complete)

---

### TASK-505: Integrate VAT Orchestrator into Cart Views (GREEN)
- **TDD Stage**: GREEN
- **Time**: 2 hours
- **Files**: `backend/django_Admin3/cart/views.py`
- **Tests**: `backend/django_Admin3/cart/tests/test_views_vat_integration.py`
- **Dependencies**: TASK-504

**Description**: Integrate VAT orchestrator into cart views to trigger VAT calculation at appropriate entry points.

**Implementation**:
```python
# cart/views.py
from cart.services.vat_orchestrator import vat_orchestrator

class CartViewSet(viewsets.ModelViewSet):
    """Cart API endpoints with VAT calculation."""

    def add_to_cart(self, request):
        """Add item to cart and calculate VAT."""
        # 1. Add item to cart
        cart_item = self._create_cart_item(request.data)

        # 2. Calculate VAT
        vat_result = vat_orchestrator.execute_vat_calculation(
            cart_item.cart,
            entry_point='add_to_cart'
        )

        # 3. Return response with VAT data
        serializer = self.get_serializer(cart_item.cart)
        return Response(serializer.data, status=status.HTTP_201_CREATED)

    def update(self, request, *args, **kwargs):
        """Update cart item and recalculate VAT."""
        # 1. Update cart item
        instance = self.get_object()
        instance.quantity = request.data.get('quantity')
        instance.save()

        # 2. Recalculate VAT
        vat_orchestrator.execute_vat_calculation(instance.cart)

        # 3. Return updated cart
        serializer = self.get_serializer(instance.cart)
        return Response(serializer.data)

    def destroy(self, request, *args, **kwargs):
        """Delete cart item and recalculate VAT."""
        # 1. Get cart reference before deletion
        instance = self.get_object()
        cart = instance.cart

        # 2. Delete item
        instance.delete()

        # 3. Recalculate VAT
        vat_orchestrator.execute_vat_calculation(cart)

        return Response(status=status.HTTP_204_NO_CONTENT)

class CheckoutViewSet(viewsets.ViewSet):
    """Checkout API endpoints with VAT validation."""

    def start(self, request):
        """Start checkout and recalculate VAT."""
        cart = request.user.cart

        # Recalculate VAT at checkout start
        vat_result = vat_orchestrator.execute_vat_calculation(
            cart,
            entry_point='checkout_start'
        )

        serializer = CartSerializer(cart)
        return Response(serializer.data)

    def payment(self, request):
        """Process payment and validate VAT."""
        cart = request.user.cart

        # Validate VAT before payment
        vat_result = vat_orchestrator.execute_vat_calculation(
            cart,
            entry_point='checkout_payment'
        )

        # Process payment with validated VAT amounts
        # ...
```

**Acceptance Criteria**:
- ✅ All tests from TASK-504 now PASS
- ✅ add_to_cart triggers VAT calculation
- ✅ checkout_start recalculates VAT
- ✅ checkout_payment validates VAT
- ✅ Cart updates trigger VAT recalculation
- ✅ Error handling working correctly

---

### TASK-506: Refactor Cart View Integration (REFACTOR)
- **TDD Stage**: REFACTOR
- **Time**: 1 hour
- **Files**: `backend/django_Admin3/cart/views.py`
- **Tests**: `backend/django_Admin3/cart/tests/test_views_vat_integration.py`
- **Dependencies**: TASK-505

**Description**: Refactor cart view integration for better code organization and error handling.

**Refactoring Tasks**:
- Extract VAT calculation trigger into decorator/mixin
- Add comprehensive logging for VAT calculation events
- Improve error responses when VAT calculation fails
- Add performance monitoring

**Acceptance Criteria**:
- ✅ All tests still PASS
- ✅ Code more DRY (Don't Repeat Yourself)
- ✅ Error handling improved
- ✅ Logging added for debugging

---

## Phase 5.3: Cart Serializer Updates (TDD)

### TASK-507: Write Cart Serializer Tests (RED) ⚠️
- **TDD Stage**: RED
- **Time**: 1.5 hours
- **Files**: `backend/django_Admin3/cart/tests/test_serializers_vat.py`
- **Dependencies**: TASK-506

**Description**: Create tests for cart serializer to include VAT data in API responses.

**Test Cases**:
```python
class CartSerializerVATTests(TestCase):
    def test_serializer_includes_vat_result_field(self):
        # Test vat_result JSONB field included

    def test_serializer_includes_vat_calculations_computed_field(self):
        # Test vatCalculations computed field

    def test_vat_calculations_format_for_frontend(self):
        # Test structure matches frontend expectations

    def test_vat_calculations_includes_execution_metadata(self):
        # Test execution_id, rules_executed included

    def test_cart_item_serializer_includes_vat_fields(self):
        # Test item-level VAT data
```

**Acceptance Criteria**:
- ✅ All test cases written
- ✅ Tests verify JSON response structure
- ✅ Tests verify computed fields
- ✅ All tests FAIL (RED phase complete)

---

### TASK-508: Update Cart Serializers with VAT Fields (GREEN)
- **TDD Stage**: GREEN
- **Time**: 2 hours
- **Files**: `backend/django_Admin3/cart/serializers.py`
- **Tests**: `backend/django_Admin3/cart/tests/test_serializers_vat.py`
- **Dependencies**: TASK-507

**Description**: Update cart serializers to expose VAT data to frontend.

**Implementation**:
```python
# cart/serializers.py
from rest_framework import serializers
from cart.models import Cart, CartItem

class CartItemSerializer(serializers.ModelSerializer):
    """Cart item with VAT details."""

    vat_amount = serializers.DecimalField(max_digits=10, decimal_places=2, read_only=True)
    vat_rate = serializers.DecimalField(max_digits=5, decimal_places=4, read_only=True)
    gross_amount = serializers.SerializerMethodField()

    class Meta:
        model = CartItem
        fields = ['id', 'product', 'quantity', 'actual_price',
                  'vat_amount', 'vat_rate', 'gross_amount', 'metadata']

    def get_gross_amount(self, obj):
        """Calculate gross amount (net + VAT)."""
        return obj.actual_price + (obj.vat_amount or Decimal('0.00'))

class CartSerializer(serializers.ModelSerializer):
    """Cart with VAT calculations."""

    items = CartItemSerializer(many=True, read_only=True)
    vat_result = serializers.JSONField(read_only=True)
    vat_calculations = serializers.SerializerMethodField()

    class Meta:
        model = Cart
        fields = ['id', 'user', 'items', 'vat_result', 'vat_calculations',
                  'created_at', 'updated_at']

    def get_vat_calculations(self, obj):
        """Format VAT data for frontend consumption."""
        if not obj.vat_result:
            return None

        return {
            'status': obj.vat_result.get('status'),
            'totals': {
                'net_amount': obj.vat_result.get('totals', {}).get('net'),
                'vat_amount': obj.vat_result.get('totals', {}).get('vat'),
                'gross_amount': obj.vat_result.get('totals', {}).get('gross'),
                'effective_vat_rate': self._calculate_effective_rate(obj.vat_result)
            },
            'region': obj.vat_result.get('region'),
            'items': obj.vat_result.get('items', []),
            'execution_metadata': {
                'execution_id': obj.vat_result.get('execution_id'),
                'rules_executed': obj.vat_result.get('rules_executed'),
                'timestamp': obj.vat_result.get('timestamp')
            }
        }

    def _calculate_effective_rate(self, vat_result):
        """Calculate effective VAT rate as percentage."""
        totals = vat_result.get('totals', {})
        net = Decimal(totals.get('net', '0'))
        vat = Decimal(totals.get('vat', '0'))

        if net == 0:
            return '0.00'

        rate = (vat / net) * 100
        return str(rate.quantize(Decimal('0.01')))
```

**Acceptance Criteria**:
- ✅ All tests from TASK-507 now PASS
- ✅ vat_result JSONB field exposed
- ✅ vatCalculations computed field works correctly
- ✅ Frontend-friendly format
- ✅ Execution metadata included

---

### TASK-509: Refactor Cart Serializers (REFACTOR)
- **TDD Stage**: REFACTOR
- **Time**: 0.5 hours
- **Files**: `backend/django_Admin3/cart/serializers.py`
- **Tests**: `backend/django_Admin3/cart/tests/test_serializers_vat.py`
- **Dependencies**: TASK-508

**Description**: Refactor serializers for better code organization.

**Refactoring Tasks**:
- Extract effective rate calculation to utility function
- Add validation for vat_result structure
- Improve docstrings

**Acceptance Criteria**:
- ✅ All tests still PASS
- ✅ Code cleaner and more maintainable

---

## Phase 5.4: Integration Testing

### TASK-510: [P] Write End-to-End Integration Tests (RED) ⚠️
- **TDD Stage**: RED
- **Time**: 3 hours
- **Files**: `backend/django_Admin3/cart/tests/test_vat_integration_e2e.py`
- **Dependencies**: TASK-509

**Description**: Create comprehensive end-to-end integration tests for complete VAT calculation flows.

**Test Cases**:
```python
class VATIntegrationE2ETests(APITestCase):
    def test_uk_customer_add_digital_item_0_percent_vat(self):
        # Complete flow: create cart → add digital item → verify 0% VAT

    def test_uk_customer_add_printed_item_20_percent_vat(self):
        # Complete flow: create cart → add printed item → verify 20% VAT

    def test_eu_customer_b2b_reverse_charge_0_percent_vat(self):
        # Complete flow: EU customer → verify 0% VAT (reverse charge)

    def test_sa_customer_15_percent_vat(self):
        # Complete flow: SA customer → verify 15% VAT

    def test_row_customer_0_percent_vat(self):
        # Complete flow: ROW customer → verify 0% VAT

    def test_mixed_cart_uk_digital_and_printed(self):
        # Mixed cart: digital (0%) + printed (20%)

    def test_cart_update_quantity_recalculates_vat(self):
        # Update quantity → verify VAT recalculated

    def test_cart_remove_item_recalculates_vat(self):
        # Remove item → verify VAT recalculated

    def test_checkout_start_validates_vat(self):
        # Checkout → verify VAT validated

    def test_vat_audit_trail_created(self):
        # Verify VATAudit records created throughout flow
```

**Acceptance Criteria**:
- ✅ All E2E test cases written
- ✅ Tests cover all customer regions
- ✅ Tests cover all product types
- ✅ Tests verify audit trail
- ✅ All tests FAIL (RED phase complete)

---

### TASK-511: Fix Integration Issues Until E2E Tests Pass (GREEN)
- **TDD Stage**: GREEN
- **Time**: 4 hours
- **Files**: Various (as needed to fix integration issues)
- **Tests**: `backend/django_Admin3/cart/tests/test_vat_integration_e2e.py`
- **Dependencies**: TASK-510

**Description**: Fix any integration issues discovered during E2E testing until all tests pass.

**Expected Issues**:
- Context building missing fields
- Rules Engine not returning expected format
- Serializer format issues
- Discount allocation edge cases
- Audit trail creation failures

**Acceptance Criteria**:
- ✅ ALL E2E tests PASS
- ✅ No integration issues remaining
- ✅ All entry points working correctly
- ✅ Complete VAT calculation flow functional

---

## Phase 5.5: Documentation & Validation

### TASK-512: [P] Create API Documentation
- **Stage**: Documentation
- **Time**: 1 hour
- **Files**: `backend/django_Admin3/docs/api/vat-calculation.md`
- **Dependencies**: TASK-511

**Description**: Document VAT calculation API endpoints and response formats.

**Content**:
- API endpoints that trigger VAT calculation
- Request/response examples
- JSONB structure documentation
- Error handling documentation
- Execution metadata explanation

**Acceptance Criteria**:
- ✅ Complete API documentation
- ✅ Code examples included
- ✅ Response format documented

---

### TASK-513: [P] Run Full Test Suite and Generate Coverage Report
- **Stage**: Validation
- **Time**: 1 hour
- **Commands**:
  - `python manage.py test cart.tests.test_vat_* --coverage`
  - `python manage.py test rules_engine.tests.test_vat_*`
- **Dependencies**: TASK-511

**Description**: Run complete test suite and verify coverage meets 80% threshold.

**Validation Steps**:
1. Run all VAT-related tests
2. Generate coverage report
3. Verify coverage > 80%
4. Document any gaps

**Acceptance Criteria**:
- ✅ All tests passing
- ✅ Coverage > 80%
- ✅ Coverage report generated

---

### TASK-514: [P] Performance Testing
- **Stage**: Validation
- **Time**: 1 hour
- **Files**: `backend/django_Admin3/cart/tests/test_vat_performance.py`
- **Dependencies**: TASK-511

**Description**: Verify VAT calculation meets performance requirements (<50ms per cart).

**Performance Tests**:
```python
class VATPerformanceTests(TestCase):
    def test_vat_calculation_single_item_under_50ms(self):
        # Measure latency for 1 item cart

    def test_vat_calculation_10_items_under_50ms(self):
        # Measure latency for 10 item cart

    def test_vat_calculation_50_items_under_50ms(self):
        # Measure latency for 50 item cart (edge case)
```

**Acceptance Criteria**:
- ✅ Performance tests created
- ✅ All performance tests < 50ms
- ✅ Performance benchmarks documented

---

## Dependencies Graph

```
TASK-501 (RED: Orchestrator Tests)
    ↓
TASK-502 (GREEN: Implement Orchestrator)
    ↓
TASK-503 (REFACTOR: Refactor Orchestrator)
    ↓
TASK-504 (RED: View Integration Tests)
    ↓
TASK-505 (GREEN: Integrate Views)
    ↓
TASK-506 (REFACTOR: Refactor Views)
    ↓
TASK-507 (RED: Serializer Tests)
    ↓
TASK-508 (GREEN: Update Serializers)
    ↓
TASK-509 (REFACTOR: Refactor Serializers)
    ↓
TASK-510 (RED: E2E Tests) [PARALLEL START]
    ↓
TASK-511 (GREEN: Fix Integration)
    ↓
├─→ TASK-512 (Docs) [PARALLEL]
├─→ TASK-513 (Coverage) [PARALLEL]
└─→ TASK-514 (Performance) [PARALLEL]
```

---

## Parallel Execution Opportunities

**Can Run in Parallel** (Tasks marked with [P]):
- TASK-510: E2E tests (independent test file)
- TASK-512: Documentation (independent file)
- TASK-513: Coverage report (validation only)
- TASK-514: Performance tests (independent test file)

---

## Estimated Time Summary

| Phase | Hours | Tasks |
|-------|-------|-------|
| 5.1: VAT Orchestrator | 6 | TASK-501, 502, 503 |
| 5.2: Entry Point Integration | 5 | TASK-504, 505, 506 |
| 5.3: Cart Serializer Updates | 4 | TASK-507, 508, 509 |
| 5.4: Integration Testing | 7 | TASK-510, 511 |
| 5.5: Documentation & Validation | 3 | TASK-512, 513, 514 |
| **Total** | **25 hours** | **14 tasks** |

**Adjusted for Parallel Execution**: ~22 hours (2.5-3 days)

---

## Success Criteria

✅ **Phase 5 Complete When**:
- All 14 tasks completed
- All tests passing (100% success rate)
- Test coverage > 80%
- VAT calculation < 50ms per cart
- add_to_cart triggers VAT calculation
- checkout_start recalculates VAT
- checkout_payment validates VAT
- cart.vat_result JSONB populated correctly
- VATAudit records created
- All E2E tests passing
- Documentation complete

---

## Next Steps

After Phase 5 completion:
1. **Phase 6**: Legacy Code Removal (remove hardcoded VAT logic)
2. **Phase 7**: Django Admin Interface (VAT management UI)
3. **Phase 8**: Frontend VAT Display Updates
4. **Phase 9**: Testing & Documentation

---

*Generated for Admin3 VAT Calculation Implementation*
*Based on: plans/spec-2025-10-06-121922-plan.md - Phase 5*
*TDD Approach: RED → GREEN → REFACTOR*
