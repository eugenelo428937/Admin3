[2025-06-17 14:30:42,730] INFO utils.email_testing MJML template not found for order_confirmation: [Errno 2] No such file or directory: 'styles.css', falling back to HTML
[2025-06-17 14:32:56,701] INFO utils.email_testing MJML template not found for order_confirmation: [Errno 2] No such file or directory: 'styles.css', falling back to HTML
[2025-06-17 14:42:19,565] INFO utils.email_testing MJML template not found for order_confirmation: [Errno 2] No such file or directory: 'styles.css', falling back to HTML
[2025-06-17 17:20:12,823] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: [Errno 2] No such file or directory: 'styles.mjml'
[2025-06-17 17:21:06,811] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: [Errno 2] No such file or directory: 'email_header.mjml'
[2025-06-17 17:23:53,299] INFO utils.email_service MJML email sent successfully to ['eugenelo@bpp.com'] using template order_confirmation
[2025-06-17 17:25:04,075] INFO utils.email_service MJML email sent successfully to ['eugene.lo1030@gmail.com'] using template order_confirmation
[2025-06-18 11:18:31,505] WARNING utils.email_service Failed to enhance Outlook compatibility: Premailer.__init__() got an unexpected keyword argument 'preserve_font_size', returning original HTML
[2025-06-18 11:18:31,599] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-18 11:18:31,613] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-18 11:18:31,658] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-18 11:18:31,663] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-18 11:18:31,701] WARNING utils.email_service Failed to enhance Outlook compatibility: Premailer.__init__() got an unexpected keyword argument 'preserve_font_size', returning original HTML
[2025-06-18 11:18:31,705] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-18 11:19:07,070] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1.128rem [1:18: margin-bottom]
[2025-06-18 11:19:07,087] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 11:20:42,343] INFO utils.email_service MJML email sent successfully to ['eugene.lo1030@gmail.com'] using template order_confirmation
[2025-06-18 11:21:03,952] INFO utils.email_service MJML email sent successfully to ['eugenelo@bpp.com'] using template order_confirmation
[2025-06-18 11:28:10,252] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: [Errno 2] No such file or directory: 'header.mjml'
[2025-06-18 11:29:09,177] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: [Errno 2] No such file or directory: 'email_header.mjml'
[2025-06-18 11:45:14,658] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: mjml_to_html() got an unexpected keyword argument 'options'
[2025-06-18 11:52:38,360] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: mjml_to_html() got an unexpected keyword argument 'options'
[2025-06-18 11:53:04,826] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: not yet implemented
[2025-06-18 11:56:03,222] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: not yet implemented
[2025-06-18 12:02:15,183] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: not yet implemented
[2025-06-18 12:06:59,907] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: unexpected token in root template at position 18:26
[2025-06-18 12:07:32,898] ERROR utils.email_testing MJML compilation error: unexpected token in root template at position 18:26
[2025-06-18 12:11:25,603] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: unexpected token in root template at position 18:26
[2025-06-18 12:17:09,542] WARNING utils.email_service MJML compilation failed for order_confirmation: unexpected token in root template at position 18:26
[2025-06-18 12:17:09,542] INFO utils.email_service Falling back to HTML template for order_confirmation
[2025-06-18 12:17:09,548] INFO utils.email_service HTML fallback successful for template: order_confirmation
[2025-06-18 12:17:09,551] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-18 12:17:09,552] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-18 12:17:09,553] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-18 12:17:09,554] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-18 12:17:09,554] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-18 12:17:09,723] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-18 12:17:09,736] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-18 12:17:09,738] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-18 12:17:09,748] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-18 12:17:09,749] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-18 12:17:09,785] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-18 12:17:09,786] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-18 12:17:09,787] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-18 12:17:09,788] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-18 12:17:09,792] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-18 12:17:09,796] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-18 12:17:09,820] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [1:13: background]
[2025-06-18 12:17:09,830] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:17:10,934] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template order_confirmation
[2025-06-18 12:20:15,444] WARNING utils.email_service MJML compilation failed for order_confirmation: unexpected token in root template at position 18:26
[2025-06-18 12:20:15,445] INFO utils.email_service Falling back to HTML template for order_confirmation
[2025-06-18 12:20:15,447] INFO utils.email_service HTML fallback successful for template: order_confirmation
[2025-06-18 12:20:15,451] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-18 12:20:15,453] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-18 12:20:15,454] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-18 12:20:15,456] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-18 12:20:15,457] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-18 12:20:15,609] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-18 12:20:15,618] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-18 12:20:15,622] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-18 12:20:15,628] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-18 12:20:15,630] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-18 12:20:15,668] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-18 12:20:15,669] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-18 12:20:15,672] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-18 12:20:15,673] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-18 12:20:15,678] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-18 12:20:15,682] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-18 12:20:15,703] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [1:13: background]
[2025-06-18 12:20:15,713] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:20:16,956] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template order_confirmation
[2025-06-18 12:25:41,944] ERROR utils.email_testing MJML compilation error: unable to load included template in root template at position 473:483
[2025-06-18 12:25:41,944] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.html
[2025-06-18 12:25:41,944] ERROR utils.email_testing MJML compilation error: unable to load included template in root template at position 473:483
[2025-06-18 12:25:41,944] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.html
[2025-06-18 12:25:41,944] INFO utils.email_testing Saved preview: ./email_previews/sample_email_html.html
[2025-06-18 12:25:41,944] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.txt
[2025-06-18 12:25:41,952] INFO utils.email_testing Saved preview: ./email_previews/sample_email_text.txt
[2025-06-18 12:25:41,952] ERROR utils.email_testing MJML compilation error: unable to load included template in root template at position 473:483
[2025-06-18 12:25:41,952] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.html
[2025-06-18 12:25:41,952] INFO utils.email_testing Saved preview: ./email_previews/sample_email_inlined.html
[2025-06-18 12:25:41,961] INFO utils.email_testing Saved preview: ./email_previews/sample_email_mjml.mjml
[2025-06-18 12:25:41,962] ERROR utils.email_testing MJML compilation error: unable to load included template in root template at position 473:483
[2025-06-18 12:25:41,962] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.html
[2025-06-18 12:25:41,962] INFO utils.email_testing Saved preview: ./email_previews/sample_email_outlook_enhanced.html
[2025-06-18 12:27:06,548] INFO utils.email_testing Saved preview: ./email_previews/sample_email_html.html
[2025-06-18 12:27:06,549] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.txt
[2025-06-18 12:27:06,550] INFO utils.email_testing Saved preview: ./email_previews/sample_email_text.txt
[2025-06-18 12:27:06,554] INFO utils.email_testing Saved preview: ./email_previews/sample_email_inlined.html
[2025-06-18 12:27:06,558] INFO utils.email_testing Saved preview: ./email_previews/sample_email_mjml.mjml
[2025-06-18 12:27:06,660] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:27:06,702] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 181, 10)
[2025-06-18 12:27:06,702] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:27:06,706] ERROR CSSUTILS No content to parse.
[2025-06-18 12:27:06,707] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:27:06,782] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:27:06,783] INFO utils.email_testing Saved preview: ./email_previews/sample_email_outlook_enhanced.html
[2025-06-18 12:29:00,631] INFO utils.email_service MJML compilation successful for template: sample_email
[2025-06-18 12:29:00,730] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:29:00,772] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 181, 10)
[2025-06-18 12:29:00,773] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:29:00,775] ERROR CSSUTILS No content to parse.
[2025-06-18 12:29:00,776] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:29:00,863] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:29:02,082] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template sample_email
[2025-06-18 12:29:29,498] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 12:37:40,601] ERROR utils.email_testing MJML compilation error: unexpected end of stream in template from "./banner.mjml"
[2025-06-18 12:37:40,602] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-18 12:37:40,604] ERROR utils.email_testing MJML compilation error: unexpected end of stream in template from "./banner.mjml"
[2025-06-18 12:37:40,605] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-18 12:37:40,606] INFO utils.email_testing Saved preview: ./email_previews/master_template_html.html
[2025-06-18 12:37:40,607] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.txt
[2025-06-18 12:37:40,609] INFO utils.email_testing Saved preview: ./email_previews/master_template_text.txt
[2025-06-18 12:37:40,610] ERROR utils.email_testing MJML compilation error: unexpected end of stream in template from "./banner.mjml"
[2025-06-18 12:37:40,611] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-18 12:37:40,612] INFO utils.email_testing Saved preview: ./email_previews/master_template_inlined.html
[2025-06-18 12:37:40,613] INFO utils.email_testing Saved preview: ./email_previews/master_template_mjml.mjml
[2025-06-18 12:37:40,614] ERROR utils.email_testing MJML compilation error: unexpected end of stream in template from "./banner.mjml"
[2025-06-18 12:37:40,615] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-18 12:37:40,618] INFO utils.email_testing Saved preview: ./email_previews/master_template_outlook_enhanced.html
[2025-06-18 12:38:48,611] INFO utils.email_testing Saved preview: ./email_previews/master_template_html.html
[2025-06-18 12:38:48,612] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.txt
[2025-06-18 12:38:48,613] INFO utils.email_testing Saved preview: ./email_previews/master_template_text.txt
[2025-06-18 12:38:48,615] INFO utils.email_testing Saved preview: ./email_previews/master_template_inlined.html
[2025-06-18 12:38:48,617] INFO utils.email_testing Saved preview: ./email_previews/master_template_mjml.mjml
[2025-06-18 12:38:48,731] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:38:48,774] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 181, 10)
[2025-06-18 12:38:48,775] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:38:48,776] ERROR CSSUTILS No content to parse.
[2025-06-18 12:38:48,777] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:38:48,879] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:38:48,880] INFO utils.email_testing Saved preview: ./email_previews/master_template_outlook_enhanced.html
[2025-06-18 12:44:06,216] ERROR utils.email_testing MJML compilation error: unexpected end of stream in template from "./banner.mjml"
[2025-06-18 12:44:06,217] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-18 12:45:00,886] ERROR utils.email_testing MJML compilation error: unexpected end of stream in template from "./banner.mjml"
[2025-06-18 12:45:00,887] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-18 12:47:49,389] ERROR utils.email_testing Unknown template: master_template
[2025-06-18 12:49:23,723] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 12:49:26,636] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 12:49:31,888] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 12:49:32,231] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:49:32,433] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 181, 10)
[2025-06-18 12:49:32,551] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:49:32,688] ERROR CSSUTILS No content to parse.
[2025-06-18 12:49:32,778] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:49:33,019] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:49:34,152] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 12:50:13,171] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 12:50:14,492] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 12:51:51,589] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 12:51:51,691] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:51:51,731] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 181, 10)
[2025-06-18 12:51:51,732] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:51:51,733] ERROR CSSUTILS No content to parse.
[2025-06-18 12:51:51,734] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:51:51,775] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:51:52,890] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugene.lo1030@gmail.com'] using template master_template
[2025-06-18 12:56:00,434] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 12:56:00,593] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:56:00,649] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 164, 10)
[2025-06-18 12:56:00,650] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:56:00,653] ERROR CSSUTILS No content to parse.
[2025-06-18 12:56:00,653] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:56:00,726] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:56:02,004] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugene.lo1030@gmail.com'] using template master_template
[2025-06-18 12:59:19,341] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 12:59:19,457] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:59:19,508] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 165, 10)
[2025-06-18 12:59:19,509] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:59:19,511] ERROR CSSUTILS No content to parse.
[2025-06-18 12:59:19,512] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:59:19,578] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:59:20,698] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugene.lo1030@gmail.com'] using template master_template
[2025-06-18 12:59:25,787] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 12:59:25,906] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 12:59:25,965] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 165, 10)
[2025-06-18 12:59:25,967] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 12:59:25,968] ERROR CSSUTILS No content to parse.
[2025-06-18 12:59:25,969] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 12:59:26,045] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 12:59:27,065] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 13:08:43,783] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 13:08:43,950] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: 1rem [3:5: font-size]
[2025-06-18 13:08:44,016] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 173, 10)
[2025-06-18 13:08:44,017] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 13:08:44,019] ERROR CSSUTILS No content to parse.
[2025-06-18 13:08:44,019] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 13:08:44,145] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 13:08:45,263] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 13:14:39,763] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 13:14:39,877] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 168, 10)
[2025-06-18 13:14:39,878] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 13:14:39,880] ERROR CSSUTILS No content to parse.
[2025-06-18 13:14:39,881] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 13:14:39,922] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 13:14:40,973] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 13:55:53,279] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 13:55:53,413] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 168, 10)
[2025-06-18 13:55:53,413] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 13:55:53,413] ERROR CSSUTILS No content to parse.
[2025-06-18 13:55:53,413] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 13:55:53,466] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 13:55:54,769] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:07:36,358] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:07:36,574] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 168, 10)
[2025-06-18 14:07:36,575] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:07:36,577] ERROR CSSUTILS No content to parse.
[2025-06-18 14:07:36,577] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:07:36,723] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:07:37,924] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:10:10,322] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:10:10,455] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 172, 10)
[2025-06-18 14:10:10,455] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:10:10,457] ERROR CSSUTILS No content to parse.
[2025-06-18 14:10:10,457] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:10:10,497] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:10:11,694] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:41:48,640] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:41:48,817] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 172, 10)
[2025-06-18 14:41:48,817] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:41:48,817] ERROR CSSUTILS No content to parse.
[2025-06-18 14:41:48,817] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:41:48,901] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:41:50,119] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:43:24,389] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:43:24,585] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 172, 10)
[2025-06-18 14:43:24,585] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:43:24,585] ERROR CSSUTILS No content to parse.
[2025-06-18 14:43:24,585] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:43:24,671] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:43:25,782] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:49:39,582] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:49:39,720] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 153, 10)
[2025-06-18 14:49:39,721] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:49:39,723] ERROR CSSUTILS No content to parse.
[2025-06-18 14:49:39,724] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:49:39,783] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:49:40,881] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:50:44,628] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:50:44,755] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 153, 10)
[2025-06-18 14:50:44,756] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:50:44,758] ERROR CSSUTILS No content to parse.
[2025-06-18 14:50:44,758] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:50:44,807] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:50:45,980] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:54:16,797] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:54:17,026] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 154, 10)
[2025-06-18 14:54:17,026] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:54:17,026] ERROR CSSUTILS No content to parse.
[2025-06-18 14:54:17,026] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:54:17,126] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:54:18,288] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:57:40,260] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:57:40,462] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 14:57:40,462] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:57:40,463] ERROR CSSUTILS No content to parse.
[2025-06-18 14:57:40,463] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:57:40,525] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:57:41,640] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 14:58:33,354] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 14:58:33,477] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 14:58:33,478] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 14:58:33,480] ERROR CSSUTILS No content to parse.
[2025-06-18 14:58:33,480] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 14:58:33,521] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 14:58:34,533] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 15:09:56,944] WARNING utils.email_service MJML compilation failed for master_template: unable to parse next template in template from "./banner.mjml"
[2025-06-18 15:09:56,945] INFO utils.email_service Falling back to HTML template for master_template
[2025-06-18 15:09:56,946] ERROR utils.email_service Both MJML and HTML templates failed for master_template: MJML=unable to parse next template in template from "./banner.mjml", HTML=emails/master_template.html
[2025-06-18 15:09:56,946] ERROR utils.email_service Failed to send MJML email to ['eugenelo@bpp.com']: Email template compilation failed: unable to parse next template in template from "./banner.mjml"
[2025-06-18 15:10:20,129] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 15:10:20,391] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:10:20,392] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:10:20,398] ERROR CSSUTILS No content to parse.
[2025-06-18 15:10:20,402] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:10:20,517] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:10:21,658] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 15:30:22,334] ERROR utils.email_service MJML include file not found: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\./content.mjml
[2025-06-18 15:30:22,335] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 15:30:22,444] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:30:22,444] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:30:22,444] ERROR CSSUTILS No content to parse.
[2025-06-18 15:30:22,444] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:30:22,478] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:30:23,710] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 15:35:13,111] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 15:35:13,324] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:35:13,326] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:35:13,328] ERROR CSSUTILS No content to parse.
[2025-06-18 15:35:13,328] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:35:13,413] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:35:14,879] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 15:39:21,187] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 15:39:22,240] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 15:42:55,821] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 15:42:56,711] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 15:43:08,604] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 15:43:09,863] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 15:43:17,761] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 15:43:17,950] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:43:18,034] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:43:18,124] ERROR CSSUTILS No content to parse.
[2025-06-18 15:43:18,224] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:43:18,427] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:43:19,664] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 15:44:27,525] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 15:44:28,453] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 15:44:59,205] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 15:44:59,339] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:44:59,339] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:44:59,353] ERROR CSSUTILS No content to parse.
[2025-06-18 15:44:59,353] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:44:59,396] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:45:00,514] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 15:48:28,605] INFO utils.email_testing Saved preview: ./email_previews/master_template_html.html
[2025-06-18 15:48:28,605] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.txt
[2025-06-18 15:48:28,609] INFO utils.email_testing Saved preview: ./email_previews/master_template_text.txt
[2025-06-18 15:48:28,616] INFO utils.email_testing Saved preview: ./email_previews/master_template_inlined.html
[2025-06-18 15:48:28,619] INFO utils.email_testing Saved preview: ./email_previews/master_template_mjml.mjml
[2025-06-18 15:48:28,896] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:48:28,899] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:48:28,901] ERROR CSSUTILS No content to parse.
[2025-06-18 15:48:28,902] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:48:29,005] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:48:29,008] INFO utils.email_testing Saved preview: ./email_previews/master_template_outlook_enhanced.html
[2025-06-18 15:48:54,459] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 15:48:54,853] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:48:54,854] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:48:54,864] ERROR CSSUTILS No content to parse.
[2025-06-18 15:48:54,865] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:48:55,040] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:48:56,510] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 15:49:18,993] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 15:49:20,328] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 15:49:50,454] INFO utils.email_testing Saved preview: ./email_previews/master_template_html.html
[2025-06-18 15:49:50,455] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.txt
[2025-06-18 15:49:50,455] INFO utils.email_testing Saved preview: ./email_previews/master_template_text.txt
[2025-06-18 15:49:50,466] INFO utils.email_testing Saved preview: ./email_previews/master_template_inlined.html
[2025-06-18 15:49:50,469] INFO utils.email_testing Saved preview: ./email_previews/master_template_mjml.mjml
[2025-06-18 15:49:50,703] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:49:50,704] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:49:50,704] ERROR CSSUTILS No content to parse.
[2025-06-18 15:49:50,706] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:49:50,783] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:49:50,785] INFO utils.email_testing Saved preview: ./email_previews/master_template_outlook_enhanced.html
[2025-06-18 15:50:11,475] INFO utils.email_service MJML compilation successful for template: master_template
[2025-06-18 15:50:11,643] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 15:50:11,645] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 15:50:11,648] ERROR CSSUTILS No content to parse.
[2025-06-18 15:50:11,648] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 15:50:11,715] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 15:50:12,776] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com'] using template master_template
[2025-06-18 17:25:03,105] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 17:25:04,103] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 17:25:23,045] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 17:25:23,937] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 17:25:39,703] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 17:25:40,586] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 17:25:52,403] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 17:25:53,665] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 17:26:39,372] ERROR utils.email_testing MJML compilation error: unexpected token in root template at position 0:11
[2025-06-18 17:26:39,377] ERROR utils.email_testing MJML compilation error: unexpected token in root template at position 0:11
[2025-06-18 17:26:39,379] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-18 17:26:39,382] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-18 17:26:39,382] ERROR utils.email_testing MJML compilation error: unexpected token in root template at position 0:11
[2025-06-18 17:26:39,384] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-18 17:26:39,385] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-18 17:26:39,385] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-18 17:26:39,388] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-18 17:26:39,391] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-18 17:26:39,545] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-18 17:26:39,552] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-18 17:26:39,556] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-18 17:26:39,562] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-18 17:26:39,562] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-18 17:26:39,594] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-18 17:26:39,604] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-18 17:26:39,607] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-18 17:26:39,609] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-18 17:26:39,614] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-18 17:26:39,618] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-18 17:26:39,635] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-18 17:26:39,635] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-18 17:26:39,637] ERROR utils.email_testing MJML compilation error: unexpected token in root template at position 0:11
[2025-06-18 17:26:39,637] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-18 17:27:10,959] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-18 17:27:11,158] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 17:27:11,158] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 17:27:11,158] ERROR CSSUTILS No content to parse.
[2025-06-18 17:27:11,171] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 17:27:11,218] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 17:27:12,504] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com']
[2025-06-18 17:27:20,279] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-18 17:27:21,338] INFO utils.email_service Dynamic MJML email sent successfully to ['eugenelo@bpp.com']
[2025-06-18 17:27:28,192] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-18 17:27:29,316] INFO utils.email_service Dynamic MJML email sent successfully to ['eugenelo@bpp.com']
[2025-06-18 17:27:37,617] INFO utils.email_testing MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-18 17:27:37,629] INFO utils.email_testing MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-18 17:27:37,630] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-18 17:27:37,632] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-18 17:27:37,633] INFO utils.email_testing MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-18 17:27:37,635] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-18 17:27:37,636] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-18 17:27:37,636] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-18 17:27:37,638] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-18 17:27:37,641] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-18 17:27:37,850] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-18 17:27:37,855] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-18 17:27:37,871] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-18 17:27:37,886] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-18 17:27:37,895] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-18 17:27:37,953] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-18 17:27:37,953] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-18 17:27:37,963] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-18 17:27:37,965] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-18 17:27:37,980] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-18 17:27:37,984] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-18 17:27:38,017] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-18 17:27:38,018] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-18 17:27:38,019] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-18 17:27:38,019] INFO utils.email_testing MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-18 17:27:38,020] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-18 17:28:01,799] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-18 17:28:01,805] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-18 17:28:01,810] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-18 17:28:01,812] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-18 17:28:01,814] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-18 17:28:01,973] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 17:28:01,973] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 17:28:01,973] ERROR CSSUTILS No content to parse.
[2025-06-18 17:28:01,973] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 17:28:02,095] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 17:28:02,110] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-18 17:28:19,389] INFO utils.email_testing Saved preview: ./email_previews/password_reset_html.html
[2025-06-18 17:28:19,389] INFO utils.email_testing Saved preview: ./email_previews/password_reset_text.txt
[2025-06-18 17:28:19,389] INFO utils.email_testing Saved preview: ./email_previews/password_reset_inlined.html
[2025-06-18 17:28:19,389] INFO utils.email_testing Saved preview: ./email_previews/password_reset_mjml.mjml
[2025-06-18 17:28:19,522] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 17:28:19,522] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 17:28:19,522] ERROR CSSUTILS No content to parse.
[2025-06-18 17:28:19,522] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 17:28:19,572] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 17:28:19,572] INFO utils.email_testing Saved preview: ./email_previews/password_reset_outlook_enhanced.html
[2025-06-18 17:29:44,827] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-18 17:29:46,206] INFO utils.email_service Dynamic MJML email sent successfully to ['eugenelo@bpp.com']
[2025-06-18 17:30:39,560] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 17:30:40,423] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 17:45:36,221] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-18 17:45:37,117] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 17:47:40,146] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-18 17:47:41,293] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-18 17:48:28,767] ERROR utils.email_service Failed to queue email: No module named 'utils.services.email_service'
[2025-06-18 17:48:28,767] INFO utils.email_service Falling back to immediate send
[2025-06-18 17:48:28,815] INFO utils.email_service MJML compilation successful for template: sample_email
[2025-06-18 17:48:29,029] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-18 17:48:29,029] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-18 17:48:29,029] ERROR CSSUTILS No content to parse.
[2025-06-18 17:48:29,029] ERROR CSSUTILS MediaQuery: No content.
[2025-06-18 17:48:29,113] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-18 17:48:30,214] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['test@example.com'] using template sample_email
[2025-06-18 17:48:51,646] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-18 17:48:51,670] INFO utils.services.queue_service Queued email 5185bb4c-4e1e-4130-ab3c-36046ce578b1 for 1 recipients
[2025-06-18 17:48:51,674] INFO utils.email_service Email queued successfully: 5185bb4c-4e1e-4130-ab3c-36046ce578b1
[2025-06-18 17:49:00,089] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-18 17:49:00,095] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-18 17:49:00,101] INFO utils.services.queue_service Queued email 8aae26df-0897-491e-85c2-06e3e3a20d76 for 1 recipients
[2025-06-18 17:49:00,103] INFO utils.email_service Email queued successfully: 8aae26df-0897-491e-85c2-06e3e3a20d76
[2025-06-18 17:49:00,108] INFO utils.services.queue_service Email sent successfully to test@example.com
[2025-06-18 17:49:00,112] INFO utils.services.queue_service Successfully processed queue item 5185bb4c-4e1e-4130-ab3c-36046ce578b1
[2025-06-18 17:49:00,118] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 10:16:47,917] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-19 10:16:52,028] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 10:18:34,063] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-19 10:18:36,039] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 10:19:46,850] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-19 10:19:48,427] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 10:21:30,051] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-19 10:21:30,059] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-19 10:21:30,065] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-19 10:21:30,065] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 10:21:30,065] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-19 10:21:30,384] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-19 10:21:30,390] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 10:21:30,395] ERROR CSSUTILS No content to parse.
[2025-06-19 10:21:30,400] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 10:21:30,667] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 10:21:30,668] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-19 10:21:39,923] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 10:21:39,923] INFO utils.services.queue_service Queued email 6c06f927-8853-45ac-bd25-e20880807f20 for 1 recipients
[2025-06-19 10:21:39,923] INFO utils.email_service Email queued successfully: 6c06f927-8853-45ac-bd25-e20880807f20
[2025-06-19 10:21:56,455] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 10:21:56,478] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 10:21:56,606] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 149, 10)
[2025-06-19 10:21:56,606] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 10:21:56,615] ERROR CSSUTILS No content to parse.
[2025-06-19 10:21:56,616] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 10:21:56,673] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 10:21:57,842] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo1030@gmail.com']
[2025-06-19 10:21:57,849] INFO utils.services.queue_service Email sent successfully to eugenelo1030@gmail.com
[2025-06-19 10:21:57,849] INFO utils.services.queue_service Successfully processed queue item 6c06f927-8853-45ac-bd25-e20880807f20
[2025-06-19 10:21:57,859] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 10:21:57,866] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 10:21:57,866] INFO utils.services.queue_service Queued email 0987ed5b-c699-4c0a-ac4b-5b061f092be1 for 1 recipients
[2025-06-19 10:21:57,866] INFO utils.email_service Email queued successfully: 0987ed5b-c699-4c0a-ac4b-5b061f092be1
[2025-06-19 10:21:57,874] INFO utils.services.queue_service Email sent successfully to test@example.com
[2025-06-19 10:21:57,877] INFO utils.services.queue_service Successfully processed queue item 8aae26df-0897-491e-85c2-06e3e3a20d76
[2025-06-19 10:21:57,877] INFO utils.services.queue_service Processed 2 queue items: 2 successful, 0 failed
[2025-06-19 10:59:56,509] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:00:53,989] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:00:53,993] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 11:00:53,993] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 11:00:53,998] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 11:00:54,000] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 11:00:54,154] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 11:00:54,154] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-19 11:00:54,444] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_3649799867504780476
[2025-06-19 11:00:54,483] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:00:54,483] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 11:00:54,484] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 11:00:54,485] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 11:02:55,159] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:02:55,161] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:02:55,162] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:02:55,162] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 11:02:55,162] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 11:02:55,166] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 11:02:55,168] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 11:02:55,278] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-3900751180991920584
[2025-06-19 11:02:55,409] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:02:55,409] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:02:55,413] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:02:55,413] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 11:02:55,517] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:02:55,517] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:02:55,517] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:02:55,518] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 11:05:21,418] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:05:21,418] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:05:21,419] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:05:21,422] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 11:05:21,423] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 129, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 130, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:05:21,423] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 11:05:21,423] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:05:21,424] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:05:21,425] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:05:21,425] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:05:21,426] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:05:21,427] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:05:21,427] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 11:05:21,427] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 170.0, 'total_vat': 34.0, 'total_gross': 204.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 129, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 130, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:05:21,427] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 11:05:21,437] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 11:05:21,437] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 11:05:21,445] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:05:21,446] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:05:21,447] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:05:21,447] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:05:21,447] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:05:21,449] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:05:21,449] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 129, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 130, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:05:21,451] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 11:05:21,451] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 11:05:21,451] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:05:21,451] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:05:21,452] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:05:21,452] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:05:21,452] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:05:21,452] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:05:21,453] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:05:21,453] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:05:21,453] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:05:21,453] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 129, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:05:21,453] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:05:21,453] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:05:21,454] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:05:21,454] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:05:21,454] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:05:21,454] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 130, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:05:21,454] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:05:21,455] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:05:21,455] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 11:05:21,459] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:05:21,461] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:05:21,463] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:05:21,643] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:05:21,643] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 129, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 130, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:05:21,644] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:05:21,644] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:05:21,644] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 170.0, 'total_vat': 34.0, 'total_gross': 204.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 129, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 130, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:05:21,653] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:05:21,654] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:05:21,654] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 129, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 130, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:05:21,654] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:05:21,655] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:05:21,655] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:05:21,655] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 129, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:05:21,655] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:05:21,656] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 130, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:05:21,656] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 11:05:21,656] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:05:21,656] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:05:21,657] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:05:54,246] INFO utils.email_service MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-19 11:05:54,266] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-19 11:05:54,268] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-19 11:05:54,268] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-19 11:05:54,268] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-19 11:05:54,268] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-19 11:05:54,457] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-19 11:05:54,471] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-19 11:05:54,475] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-19 11:05:54,485] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-19 11:05:54,485] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-19 11:05:54,533] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-19 11:05:54,534] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-19 11:05:54,536] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-19 11:05:54,536] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-19 11:05:54,541] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-19 11:05:54,545] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-19 11:05:54,549] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [1:1: display]
[2025-06-19 11:05:54,549] WARNING CSSUTILS Property: Unknown Property name. [1:14: justify-content]
[2025-06-19 11:05:55,671] INFO utils.email_service HTML email sent successfully to ['eugenelo1030@gmail.com'] using template order_confirmation
[2025-06-19 11:05:55,681] INFO cart.views Test order confirmation email sent successfully to eugenelo1030@gmail.com
[2025-06-19 11:06:37,990] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 11:06:37,993] ERROR utils.services.queue_service Failed to queue email: Object of type datetime is not JSON serializable
[2025-06-19 11:06:37,993] ERROR utils.email_service Failed to queue email: Failed to queue email: Object of type datetime is not JSON serializable
[2025-06-19 11:06:37,993] INFO utils.email_service Falling back to immediate send
[2025-06-19 11:06:37,993] ERROR utils.email_service Failed to send MJML email to ['eugenelo4@bpp.com']: emails/mjml/order_confirmation.mjml
[2025-06-19 11:06:37,993] WARNING cart.views Order confirmation email failed to queue for order ORD-000018 to eugenelo4@bpp.com
[2025-06-19 11:09:06,348] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-19 11:09:07,471] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:11:44,359] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 11:11:44,372] INFO utils.services.queue_service Queued email 884e0fcb-5264-4901-ad0b-f569babf110e for 1 recipients
[2025-06-19 11:11:44,374] INFO utils.email_service Email queued successfully: 884e0fcb-5264-4901-ad0b-f569babf110e
[2025-06-19 11:17:36,473] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 11:17:37,650] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:17:51,930] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:17:51,933] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:17:51,934] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-19 11:17:51,936] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-19 11:17:51,937] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:17:51,940] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-19 11:17:51,940] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-19 11:17:51,942] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-19 11:17:51,943] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-19 11:17:51,944] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-19 11:17:52,074] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-19 11:17:52,079] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-19 11:17:52,083] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-19 11:17:52,089] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-19 11:17:52,089] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-19 11:17:52,122] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-19 11:17:52,123] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-19 11:17:52,125] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-19 11:17:52,125] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-19 11:17:52,130] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-19 11:17:52,137] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-19 11:17:52,159] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-19 11:17:52,161] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-19 11:17:52,162] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:17:52,164] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-19 11:24:37,755] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:24:37,755] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-19 11:25:15,485] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:25:15,485] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-19 11:25:53,828] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:25:53,829] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-19 11:26:13,252] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:26:13,252] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.html
[2025-06-19 11:26:51,293] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:26:51,294] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-19 11:27:00,076] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 11:28:50,496] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 11:28:53,200] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:29:08,105] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 11:29:09,553] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:29:19,741] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:29:19,742] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-19 11:29:28,505] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:29:28,505] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.html
[2025-06-19 11:30:13,193] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:30:13,194] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-19 11:30:22,467] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:30:22,467] ERROR utils.email_testing Failed to preview template sample_email: emails/sample_email.html
[2025-06-19 11:30:32,234] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:31:51,059] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 11:31:51,124] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:31:51,128] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-19 11:31:51,129] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-19 11:31:51,137] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:31:51,137] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-19 11:31:51,137] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-19 11:31:51,137] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-19 11:31:51,137] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-19 11:31:51,137] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-19 11:31:51,344] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-19 11:31:51,356] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-19 11:31:51,356] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-19 11:31:51,376] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-19 11:31:51,377] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-19 11:31:51,425] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-19 11:31:51,425] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-19 11:31:51,426] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-19 11:31:51,427] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-19 11:31:51,436] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-19 11:31:51,437] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-19 11:31:51,463] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-19 11:31:51,464] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 11:31:51,468] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-19 11:31:51,471] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:31:51,474] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-19 11:32:45,957] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 11:32:45,957] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 11:32:45,963] INFO utils.services.queue_service Queued email 038b8173-1ca3-4a56-9b5a-cb010110e6a5 for 1 recipients
[2025-06-19 11:32:45,964] INFO utils.email_service Email queued successfully: 038b8173-1ca3-4a56-9b5a-cb010110e6a5
[2025-06-19 11:35:59,296] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:37:04,006] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:37:04,027] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:37:04,030] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:37:04,038] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 11:37:04,039] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 11:37:04,043] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 11:37:04,044] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 11:37:04,149] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:37:04,150] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:37:04,151] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:37:04,151] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 11:37:04,153] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 11:37:04,169] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 11:37:04,173] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 11:37:04,290] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4994153524002859212
[2025-06-19 11:37:04,295] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:37:04,295] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:37:04,311] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:37:04,315] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 11:37:04,435] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4994153524002859212
[2025-06-19 11:37:12,706] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:37:12,706] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:37:12,707] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:37:12,710] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,713] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,715] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:37:12,716] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:37:12,718] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:37:12,721] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,723] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,724] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:37:12,725] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 131, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:37:12,726] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:37:12,730] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:37:12,732] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:37:12,735] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:37:12,738] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:37:12,740] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 131, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:37:12,742] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 131, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:37:12,742] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 131, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:37:12,787] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:37:12,788] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:37:12,788] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:37:12,788] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:37:12,791] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:37:12,792] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:37:12,792] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:37:12,793] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,795] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:37:12,794] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,796] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,797] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:37:12,799] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:37:12,800] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:37:12,800] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:37:12,801] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:37:12,801] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:37:12,802] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:37:12,802] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:37:12,804] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:37:12,805] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:37:12,807] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:37:12,808] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:37:12,810] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:37:12,810] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:37:12,813] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:37:12,813] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:37:12,815] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:37:12,816] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:37:12,820] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:37:12,820] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:37:12,820] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:37:12,821] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:37:12,822] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:37:12,822] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:37:12,823] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:37:12,830] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:37:12,831] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:37:12,835] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:37:12,858] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 131, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:37:12,910] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:37:13,007] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:37:13,023] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:37:13,036] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:37:21,363] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 11:37:21,363] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 11:37:21,363] INFO utils.services.queue_service Queued email c7fc1cab-5cfa-49e4-a56b-1504a84310da for 1 recipients
[2025-06-19 11:37:21,363] INFO utils.email_service Email queued successfully: c7fc1cab-5cfa-49e4-a56b-1504a84310da
[2025-06-19 11:37:21,372] INFO cart.views Order confirmation email queued successfully for order ORD-000019 to eugenelo4@bpp.com
[2025-06-19 11:40:09,660] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\django_Admin3\settings\development.py changed, reloading.
[2025-06-19 11:40:12,226] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:40:27,295] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\django_Admin3\settings\development.py changed, reloading.
[2025-06-19 11:40:28,296] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:41:19,179] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 11:41:20,423] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:42:06,993] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 11:42:07,848] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:42:26,004] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 11:42:27,227] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:42:35,592] INFO utils.email_service Development mode: Redirecting email from ['student@example.com'] to ['developer@acted.com', 'test@acted.com']
[2025-06-19 11:42:35,678] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 11:42:35,678] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 11:42:35,681] INFO utils.services.queue_service Queued email 8c6112db-aee5-4015-a8dd-3ef44616ed15 for 2 recipients
[2025-06-19 11:42:35,683] INFO utils.email_service Email queued successfully: 8c6112db-aee5-4015-a8dd-3ef44616ed15
[2025-06-19 11:42:46,122] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./footer.mjml"
[2025-06-19 11:43:29,269] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:43:29,271] ERROR utils.email_testing Failed to preview template master_template: emails/master_template.html
[2025-06-19 11:43:37,037] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 11:43:37,053] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:43:37,057] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-19 11:43:37,059] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-19 11:43:37,060] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:43:37,061] WARNING CSSUTILS Property: Unknown Property name. [4:13: -webkit-text-size-adjust]
[2025-06-19 11:43:37,062] WARNING CSSUTILS Property: Unknown Property name. [5:13: -ms-text-size-adjust]
[2025-06-19 11:43:37,063] WARNING CSSUTILS Property: Unknown Property name. [8:13: mso-table-lspace]
[2025-06-19 11:43:37,064] WARNING CSSUTILS Property: Unknown Property name. [9:13: mso-table-rspace]
[2025-06-19 11:43:37,065] WARNING CSSUTILS Property: Unknown Property name. [12:13: -ms-interpolation-mode]
[2025-06-19 11:43:37,162] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [41:13: background]
[2025-06-19 11:43:37,168] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [82:13: background]
[2025-06-19 11:43:37,171] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%) [93:13: background]
[2025-06-19 11:43:37,175] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: flex [132:13: display]
[2025-06-19 11:43:37,176] WARNING CSSUTILS Property: Unknown Property name. [133:13: justify-content]
[2025-06-19 11:43:37,200] WARNING CSSUTILS Property: Unknown Property name. [1:1: -webkit-text-size-adjust]
[2025-06-19 11:43:37,201] WARNING CSSUTILS Property: Unknown Property name. [1:31: -ms-text-size-adjust]
[2025-06-19 11:43:37,202] WARNING CSSUTILS Property: Unknown Property name. [1:1: mso-table-lspace]
[2025-06-19 11:43:37,203] WARNING CSSUTILS Property: Unknown Property name. [1:20: mso-table-rspace]
[2025-06-19 11:43:37,207] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:1: background]
[2025-06-19 11:43:37,210] ERROR CSSUTILS Property: Invalid value for "CSS Level 2.1" property: linear-gradient(135deg, #667eea 0%, #764ba2 100%) [1:40: background]
[2025-06-19 11:43:37,223] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-19 11:43:37,223] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 11:43:37,224] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-19 11:43:37,225] ERROR utils.email_testing MJML compilation error: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:43:37,226] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-19 11:44:06,165] INFO utils.email_service Development mode: Redirecting email from ['real.student@university.edu'] to ['developer@acted.com', 'test@acted.com']
[2025-06-19 11:44:06,240] INFO utils.email_service MJML compilation successful for template: password_reset
[2025-06-19 11:44:07,248] INFO utils.email_service MJML email sent successfully to ['developer@acted.com', 'test@acted.com'] using template password_reset
[2025-06-19 11:44:14,931] INFO utils.email_service Development mode: Redirecting email from ['new.user@company.com'] to ['developer@acted.com', 'test@acted.com']
[2025-06-19 11:44:14,996] INFO utils.services.queue_service Found template configuration for account_activation
[2025-06-19 11:44:14,997] DEBUG utils.services.queue_service Successfully serialized context for account_activation
[2025-06-19 11:44:14,999] INFO utils.services.queue_service Queued email 49562089-31f5-433d-b314-eb73428570f3 for 2 recipients
[2025-06-19 11:44:15,005] INFO utils.email_service Email queued successfully: 49562089-31f5-433d-b314-eb73428570f3
[2025-06-19 11:51:50,921] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\django_Admin3\settings\development.py changed, reloading.
[2025-06-19 11:51:52,073] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:52:17,401] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\django_Admin3\settings\development.py changed, reloading.
[2025-06-19 11:52:18,324] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 11:52:45,276] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:52:45,277] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:52:45,277] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:52:45,279] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 11:52:45,279] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 11:52:45,279] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:52:45,280] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:52:45,280] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:52:45,280] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 11:52:45,281] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 11:52:45,281] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 11:52:45,281] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 11:52:45,281] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 11:52:45,284] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 11:52:45,336] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 11:52:45,336] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 11:52:45,336] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 11:52:45,336] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 11:52:45,336] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 11:52:45,355] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 11:52:45,359] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 11:52:45,364] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 11:52:45,370] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 11:52:45,457] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 11:54:29,516] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:54:29,528] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:54:29,528] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,528] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,530] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:54:29,530] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:54:29,532] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:54:29,538] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:54:29,542] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 132, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:54:29,543] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 132, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:54:29,583] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:54:29,589] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:54:29,590] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:54:29,590] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,591] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:54:29,593] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:54:29,593] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,595] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:54:29,597] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:54:29,597] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:54:29,600] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:54:29,610] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,611] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 11:54:29,612] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:54:29,612] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:54:29,612] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:54:29,613] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,613] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:54:29,613] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:54:29,613] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:54:29,613] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 11:54:29,613] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:54:29,616] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 132, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:54:29,614] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:54:29,616] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 11:54:29,617] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:54:29,617] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 132, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 11:54:29,617] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:54:29,618] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:54:29,618] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:54:29,631] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:54:29,634] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:54:29,648] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:54:29,657] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 11:54:29,661] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:54:29,664] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 11:54:29,668] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,671] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 11:54:29,672] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:54:29,674] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 11:54:29,675] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:54:29,677] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 11:54:29,679] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:54:29,681] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 11:54:29,681] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:54:29,689] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 132, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 11:54:29,691] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:54:29,691] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 11:54:29,691] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:54:29,691] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 11:54:29,691] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:54:29,697] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 11:54:29,697] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:54:29,697] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 11:54:37,288] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:54:37,288] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 11:54:37,288] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 11:54:37,298] INFO utils.services.queue_service Queued email 9285e93e-d7ad-43f9-a903-a7c734b3ffc8 for 2 recipients
[2025-06-19 11:54:37,299] INFO utils.email_service Email queued successfully: 9285e93e-d7ad-43f9-a903-a7c734b3ffc8
[2025-06-19 11:54:37,299] INFO cart.views Order confirmation email queued successfully for order ORD-000020 to eugenelo4@bpp.com
[2025-06-19 11:57:15,438] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 11:57:15,446] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,448] ERROR utils.email_service Failed to send dynamic MJML email to ['eugenelo@bpp.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,448] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 11:57:15,451] ERROR utils.services.queue_service Queue item 884e0fcb-5264-4901-ad0b-f569babf110e failed after max attempts
[2025-06-19 11:57:15,459] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 11:57:15,460] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,461] ERROR utils.email_service Failed to send dynamic MJML email to ['test@example.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,461] ERROR utils.services.queue_service Failed to send email to test@example.com
[2025-06-19 11:57:15,463] ERROR utils.services.queue_service Queue item 038b8173-1ca3-4a56-9b5a-cb010110e6a5 failed after max attempts
[2025-06-19 11:57:15,471] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 11:57:15,478] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,478] ERROR utils.email_service Failed to send dynamic MJML email to ['eugenelo4@bpp.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,481] ERROR utils.services.queue_service Failed to send email to eugenelo4@bpp.com
[2025-06-19 11:57:15,482] ERROR utils.services.queue_service Queue item c7fc1cab-5cfa-49e4-a56b-1504a84310da failed after max attempts
[2025-06-19 11:57:15,485] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 11:57:15,485] INFO utils.email_service Development mode: Redirecting email from ['developer@acted.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,485] ERROR utils.email_service Failed to send dynamic MJML email to ['developer@acted.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,485] ERROR utils.services.queue_service Failed to send email to developer@acted.com
[2025-06-19 11:57:15,502] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 11:57:15,503] INFO utils.email_service Development mode: Redirecting email from ['test@acted.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,504] ERROR utils.email_service Failed to send dynamic MJML email to ['test@acted.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,504] ERROR utils.services.queue_service Failed to send email to test@acted.com
[2025-06-19 11:57:15,507] ERROR utils.services.queue_service Queue item 8c6112db-aee5-4015-a8dd-3ef44616ed15 failed after max attempts
[2025-06-19 11:57:15,515] INFO utils.services.queue_service Found 0 attachments for template account_activation
[2025-06-19 11:57:15,519] INFO utils.email_service Development mode: Redirecting email from ['developer@acted.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,521] ERROR utils.email_service Failed to send dynamic MJML email to ['developer@acted.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,525] ERROR utils.services.queue_service Failed to send email to developer@acted.com
[2025-06-19 11:57:15,534] INFO utils.services.queue_service Found 0 attachments for template account_activation
[2025-06-19 11:57:15,535] INFO utils.email_service Development mode: Redirecting email from ['test@acted.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,536] ERROR utils.email_service Failed to send dynamic MJML email to ['test@acted.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,537] ERROR utils.services.queue_service Failed to send email to test@acted.com
[2025-06-19 11:57:15,539] ERROR utils.services.queue_service Queue item 49562089-31f5-433d-b314-eb73428570f3 failed after max attempts
[2025-06-19 11:57:15,550] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 11:57:15,551] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,552] ERROR utils.email_service Failed to send dynamic MJML email to ['eugenelo@bpp.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,553] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 11:57:15,580] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 11:57:15,581] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,582] ERROR utils.email_service Failed to send dynamic MJML email to ['eugene.lo1030@gmail.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 11:57:15,583] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 11:57:15,589] ERROR utils.services.queue_service Queue item 9285e93e-d7ad-43f9-a903-a7c734b3ffc8 failed after max attempts
[2025-06-19 11:57:15,597] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:57:15,598] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:15,601] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:57:15,601] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:57:15,607] INFO utils.services.queue_service Queued email 2544a8e7-6065-4048-946e-0b93812675b5 for 2 recipients
[2025-06-19 11:57:15,607] INFO utils.email_service Email queued successfully: 2544a8e7-6065-4048-946e-0b93812675b5
[2025-06-19 11:57:15,611] INFO utils.services.queue_service Email sent successfully to test@example.com
[2025-06-19 11:57:15,612] INFO utils.services.queue_service Successfully processed queue item 0987ed5b-c699-4c0a-ac4b-5b061f092be1
[2025-06-19 11:57:15,612] INFO utils.services.queue_service Processed 7 queue items: 1 successful, 6 failed
[2025-06-19 11:57:45,632] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:57:45,632] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:45,638] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:57:45,639] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:57:45,643] INFO utils.services.queue_service Queued email bb9d3130-6d0c-45bd-8359-723f5a8d5434 for 2 recipients
[2025-06-19 11:57:45,645] INFO utils.email_service Email queued successfully: bb9d3130-6d0c-45bd-8359-723f5a8d5434
[2025-06-19 11:57:45,648] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:57:45,659] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:57:45,659] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:57:45,662] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:57:45,662] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:57:45,669] INFO utils.services.queue_service Queued email c64e6613-d9cb-4e1b-b4ff-4486e9c54afe for 2 recipients
[2025-06-19 11:57:45,670] INFO utils.email_service Email queued successfully: c64e6613-d9cb-4e1b-b4ff-4486e9c54afe
[2025-06-19 11:57:45,673] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:57:45,677] INFO utils.services.queue_service Successfully processed queue item 2544a8e7-6065-4048-946e-0b93812675b5
[2025-06-19 11:57:45,682] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 11:58:15,701] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:15,701] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:15,703] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:15,704] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:15,705] INFO utils.services.queue_service Queued email 2501ad25-065e-4d26-b754-ba70d582baf4 for 2 recipients
[2025-06-19 11:58:15,706] INFO utils.email_service Email queued successfully: 2501ad25-065e-4d26-b754-ba70d582baf4
[2025-06-19 11:58:15,709] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:58:15,713] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:15,714] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:15,719] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:15,719] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:15,721] INFO utils.services.queue_service Queued email 15894de5-fbb9-407b-84ad-9c3db3a9911d for 2 recipients
[2025-06-19 11:58:15,722] INFO utils.email_service Email queued successfully: 15894de5-fbb9-407b-84ad-9c3db3a9911d
[2025-06-19 11:58:15,724] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:58:15,727] INFO utils.services.queue_service Successfully processed queue item bb9d3130-6d0c-45bd-8359-723f5a8d5434
[2025-06-19 11:58:15,737] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:15,738] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:15,741] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:15,742] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:15,744] INFO utils.services.queue_service Queued email 3a1ec7f0-506d-4d7e-a4a5-55cddf09f946 for 2 recipients
[2025-06-19 11:58:15,745] INFO utils.email_service Email queued successfully: 3a1ec7f0-506d-4d7e-a4a5-55cddf09f946
[2025-06-19 11:58:15,747] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:58:15,755] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:15,755] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:15,755] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:15,755] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:15,763] INFO utils.services.queue_service Queued email 20669de9-7633-471e-b8d6-2f42013256bf for 2 recipients
[2025-06-19 11:58:15,763] INFO utils.email_service Email queued successfully: 20669de9-7633-471e-b8d6-2f42013256bf
[2025-06-19 11:58:15,763] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:58:15,769] INFO utils.services.queue_service Successfully processed queue item c64e6613-d9cb-4e1b-b4ff-4486e9c54afe
[2025-06-19 11:58:15,771] INFO utils.services.queue_service Processed 2 queue items: 2 successful, 0 failed
[2025-06-19 11:58:45,793] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,793] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,797] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,798] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,800] INFO utils.services.queue_service Queued email 4699c92f-e12b-4b85-9cbf-5a034af37f94 for 2 recipients
[2025-06-19 11:58:45,800] INFO utils.email_service Email queued successfully: 4699c92f-e12b-4b85-9cbf-5a034af37f94
[2025-06-19 11:58:45,803] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:58:45,803] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,803] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,803] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,803] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,803] INFO utils.services.queue_service Queued email 822fb8f0-3b9c-475b-ad19-5e19100eab18 for 2 recipients
[2025-06-19 11:58:45,818] INFO utils.email_service Email queued successfully: 822fb8f0-3b9c-475b-ad19-5e19100eab18
[2025-06-19 11:58:45,818] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:58:45,818] INFO utils.services.queue_service Successfully processed queue item 2501ad25-065e-4d26-b754-ba70d582baf4
[2025-06-19 11:58:45,833] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,834] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,834] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,834] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,834] INFO utils.services.queue_service Queued email 47011713-289c-4160-a7eb-dc6bfa31bc3b for 2 recipients
[2025-06-19 11:58:45,834] INFO utils.email_service Email queued successfully: 47011713-289c-4160-a7eb-dc6bfa31bc3b
[2025-06-19 11:58:45,834] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:58:45,851] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,851] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,851] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,851] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,859] INFO utils.services.queue_service Queued email 61deb517-6705-44cd-8f73-43f16a0bce3d for 2 recipients
[2025-06-19 11:58:45,859] INFO utils.email_service Email queued successfully: 61deb517-6705-44cd-8f73-43f16a0bce3d
[2025-06-19 11:58:45,859] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:58:45,859] INFO utils.services.queue_service Successfully processed queue item 15894de5-fbb9-407b-84ad-9c3db3a9911d
[2025-06-19 11:58:45,868] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,868] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,868] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,868] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,868] INFO utils.services.queue_service Queued email ccea7ecf-aaf6-4412-a5ec-7960f9d28e64 for 2 recipients
[2025-06-19 11:58:45,883] INFO utils.email_service Email queued successfully: ccea7ecf-aaf6-4412-a5ec-7960f9d28e64
[2025-06-19 11:58:45,886] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:58:45,893] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,894] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,898] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,900] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,903] INFO utils.services.queue_service Queued email c3379729-62d5-4135-ae10-31f13e55fa64 for 2 recipients
[2025-06-19 11:58:45,904] INFO utils.email_service Email queued successfully: c3379729-62d5-4135-ae10-31f13e55fa64
[2025-06-19 11:58:45,907] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:58:45,909] INFO utils.services.queue_service Successfully processed queue item 3a1ec7f0-506d-4d7e-a4a5-55cddf09f946
[2025-06-19 11:58:45,920] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,920] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,925] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,926] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,927] INFO utils.services.queue_service Queued email 278d1374-a38b-4a49-8b58-ca156aad1cf3 for 2 recipients
[2025-06-19 11:58:45,928] INFO utils.email_service Email queued successfully: 278d1374-a38b-4a49-8b58-ca156aad1cf3
[2025-06-19 11:58:45,931] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:58:45,935] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:58:45,935] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:58:45,942] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:58:45,943] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:58:45,943] INFO utils.services.queue_service Queued email a85bb1b5-4c4f-42c0-af13-d6d3260ea6e8 for 2 recipients
[2025-06-19 11:58:45,943] INFO utils.email_service Email queued successfully: a85bb1b5-4c4f-42c0-af13-d6d3260ea6e8
[2025-06-19 11:58:45,943] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:58:45,943] INFO utils.services.queue_service Successfully processed queue item 20669de9-7633-471e-b8d6-2f42013256bf
[2025-06-19 11:58:45,950] INFO utils.services.queue_service Processed 4 queue items: 4 successful, 0 failed
[2025-06-19 11:59:15,983] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:15,983] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:15,992] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:15,994] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:15,997] INFO utils.services.queue_service Queued email 90ae1bd6-c11a-491c-afba-3cdff3df1141 for 2 recipients
[2025-06-19 11:59:15,998] INFO utils.email_service Email queued successfully: 90ae1bd6-c11a-491c-afba-3cdff3df1141
[2025-06-19 11:59:16,003] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,013] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,018] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,018] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,018] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,018] INFO utils.services.queue_service Queued email 77263772-ce58-49e1-b452-54bb38cf6be7 for 2 recipients
[2025-06-19 11:59:16,029] INFO utils.email_service Email queued successfully: 77263772-ce58-49e1-b452-54bb38cf6be7
[2025-06-19 11:59:16,030] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,035] INFO utils.services.queue_service Successfully processed queue item 4699c92f-e12b-4b85-9cbf-5a034af37f94
[2025-06-19 11:59:16,053] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,053] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,061] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,062] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,063] INFO utils.services.queue_service Queued email 80812781-3d0b-48c0-b604-46a5bc5ba55b for 2 recipients
[2025-06-19 11:59:16,068] INFO utils.email_service Email queued successfully: 80812781-3d0b-48c0-b604-46a5bc5ba55b
[2025-06-19 11:59:16,072] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,085] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,086] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,094] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,094] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,103] INFO utils.services.queue_service Queued email bd92588f-08f4-45c8-b286-5aa65ec48aa9 for 2 recipients
[2025-06-19 11:59:16,105] INFO utils.email_service Email queued successfully: bd92588f-08f4-45c8-b286-5aa65ec48aa9
[2025-06-19 11:59:16,112] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,116] INFO utils.services.queue_service Successfully processed queue item 822fb8f0-3b9c-475b-ad19-5e19100eab18
[2025-06-19 11:59:16,135] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,135] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,142] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,143] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,147] INFO utils.services.queue_service Queued email fa935ab3-2532-492c-b178-78e7c6cc871a for 2 recipients
[2025-06-19 11:59:16,148] INFO utils.email_service Email queued successfully: fa935ab3-2532-492c-b178-78e7c6cc871a
[2025-06-19 11:59:16,153] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,163] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,167] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,175] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,175] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,179] INFO utils.services.queue_service Queued email ab671a2f-03b6-4711-acf6-80e19b46abb0 for 2 recipients
[2025-06-19 11:59:16,182] INFO utils.email_service Email queued successfully: ab671a2f-03b6-4711-acf6-80e19b46abb0
[2025-06-19 11:59:16,185] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,189] INFO utils.services.queue_service Successfully processed queue item 47011713-289c-4160-a7eb-dc6bfa31bc3b
[2025-06-19 11:59:16,201] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,201] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,217] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,218] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,222] INFO utils.services.queue_service Queued email 9c735655-57c7-415a-a737-4b0d6a98b5c2 for 2 recipients
[2025-06-19 11:59:16,224] INFO utils.email_service Email queued successfully: 9c735655-57c7-415a-a737-4b0d6a98b5c2
[2025-06-19 11:59:16,229] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,236] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,236] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,236] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,251] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,254] INFO utils.services.queue_service Queued email 9962f131-e0e0-4c88-a30f-cbc0063a5a93 for 2 recipients
[2025-06-19 11:59:16,257] INFO utils.email_service Email queued successfully: 9962f131-e0e0-4c88-a30f-cbc0063a5a93
[2025-06-19 11:59:16,261] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,266] INFO utils.services.queue_service Successfully processed queue item 61deb517-6705-44cd-8f73-43f16a0bce3d
[2025-06-19 11:59:16,285] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,286] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,293] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,294] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,298] INFO utils.services.queue_service Queued email f9b92efd-1734-488e-9632-447727dabedf for 2 recipients
[2025-06-19 11:59:16,301] INFO utils.email_service Email queued successfully: f9b92efd-1734-488e-9632-447727dabedf
[2025-06-19 11:59:16,303] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,319] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,319] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,319] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,319] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,333] INFO utils.services.queue_service Queued email 91366afb-c835-4e8e-9169-96ecf40772bf for 2 recipients
[2025-06-19 11:59:16,336] INFO utils.email_service Email queued successfully: 91366afb-c835-4e8e-9169-96ecf40772bf
[2025-06-19 11:59:16,342] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,347] INFO utils.services.queue_service Successfully processed queue item ccea7ecf-aaf6-4412-a5ec-7960f9d28e64
[2025-06-19 11:59:16,368] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,368] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,375] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,376] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,380] INFO utils.services.queue_service Queued email 49d97a10-380e-4ba9-a972-dff67a4f97c7 for 2 recipients
[2025-06-19 11:59:16,383] INFO utils.email_service Email queued successfully: 49d97a10-380e-4ba9-a972-dff67a4f97c7
[2025-06-19 11:59:16,388] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,404] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,405] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,411] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,412] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,418] INFO utils.services.queue_service Queued email 00b6858c-1fa6-4704-a87e-668fab499d0a for 2 recipients
[2025-06-19 11:59:16,419] INFO utils.email_service Email queued successfully: 00b6858c-1fa6-4704-a87e-668fab499d0a
[2025-06-19 11:59:16,426] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,430] INFO utils.services.queue_service Successfully processed queue item c3379729-62d5-4135-ae10-31f13e55fa64
[2025-06-19 11:59:16,452] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,452] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,452] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,452] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,452] INFO utils.services.queue_service Queued email a5fe799d-5baf-4525-928c-b2b2b7cc2566 for 2 recipients
[2025-06-19 11:59:16,469] INFO utils.email_service Email queued successfully: a5fe799d-5baf-4525-928c-b2b2b7cc2566
[2025-06-19 11:59:16,473] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,486] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,488] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,495] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,495] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,503] INFO utils.services.queue_service Queued email 16d2be14-cb73-415f-b459-7190043146ce for 2 recipients
[2025-06-19 11:59:16,505] INFO utils.email_service Email queued successfully: 16d2be14-cb73-415f-b459-7190043146ce
[2025-06-19 11:59:16,505] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,515] INFO utils.services.queue_service Successfully processed queue item 278d1374-a38b-4a49-8b58-ca156aad1cf3
[2025-06-19 11:59:16,539] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,540] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,541] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,541] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,553] INFO utils.services.queue_service Queued email 974e293c-7a6e-4735-ac8c-5c0222626f51 for 2 recipients
[2025-06-19 11:59:16,553] INFO utils.email_service Email queued successfully: 974e293c-7a6e-4735-ac8c-5c0222626f51
[2025-06-19 11:59:16,553] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:16,577] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:16,577] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:16,584] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:16,585] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:16,592] INFO utils.services.queue_service Queued email 1a0bcae1-f708-4885-a60a-4ad5a3df829a for 2 recipients
[2025-06-19 11:59:16,593] INFO utils.email_service Email queued successfully: 1a0bcae1-f708-4885-a60a-4ad5a3df829a
[2025-06-19 11:59:16,598] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:16,602] INFO utils.services.queue_service Successfully processed queue item a85bb1b5-4c4f-42c0-af13-d6d3260ea6e8
[2025-06-19 11:59:16,609] INFO utils.services.queue_service Processed 8 queue items: 8 successful, 0 failed
[2025-06-19 11:59:46,634] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,635] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,640] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,640] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,647] INFO utils.services.queue_service Queued email accaeb39-5c09-4567-a104-510f602c1413 for 2 recipients
[2025-06-19 11:59:46,649] INFO utils.email_service Email queued successfully: accaeb39-5c09-4567-a104-510f602c1413
[2025-06-19 11:59:46,653] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:46,663] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,664] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,669] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,670] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,673] INFO utils.services.queue_service Queued email 1ef03552-01b6-43bb-81c6-736cc8fcd031 for 2 recipients
[2025-06-19 11:59:46,674] INFO utils.email_service Email queued successfully: 1ef03552-01b6-43bb-81c6-736cc8fcd031
[2025-06-19 11:59:46,677] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:46,680] INFO utils.services.queue_service Successfully processed queue item 90ae1bd6-c11a-491c-afba-3cdff3df1141
[2025-06-19 11:59:46,702] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,702] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,710] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,711] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,715] INFO utils.services.queue_service Queued email cce7915c-eb6b-4240-bf3d-62253ed1cd25 for 2 recipients
[2025-06-19 11:59:46,717] INFO utils.email_service Email queued successfully: cce7915c-eb6b-4240-bf3d-62253ed1cd25
[2025-06-19 11:59:46,721] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:46,732] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,733] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,743] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,743] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,748] INFO utils.services.queue_service Queued email 1c84891c-2d74-48f5-b410-c5bc4df29d27 for 2 recipients
[2025-06-19 11:59:46,749] INFO utils.email_service Email queued successfully: 1c84891c-2d74-48f5-b410-c5bc4df29d27
[2025-06-19 11:59:46,752] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:46,758] INFO utils.services.queue_service Successfully processed queue item 77263772-ce58-49e1-b452-54bb38cf6be7
[2025-06-19 11:59:46,769] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,769] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,782] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,783] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,784] INFO utils.services.queue_service Queued email 578a996b-522d-4520-955c-8cd1a4ebb4a2 for 2 recipients
[2025-06-19 11:59:46,784] INFO utils.email_service Email queued successfully: 578a996b-522d-4520-955c-8cd1a4ebb4a2
[2025-06-19 11:59:46,792] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:46,806] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,807] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,813] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,813] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,820] INFO utils.services.queue_service Queued email 74c5c827-f023-41c5-a742-08490af92b89 for 2 recipients
[2025-06-19 11:59:46,820] INFO utils.email_service Email queued successfully: 74c5c827-f023-41c5-a742-08490af92b89
[2025-06-19 11:59:46,828] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:46,831] INFO utils.services.queue_service Successfully processed queue item 80812781-3d0b-48c0-b604-46a5bc5ba55b
[2025-06-19 11:59:46,845] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,845] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,854] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,854] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,862] INFO utils.services.queue_service Queued email cec43351-7477-4f9e-a519-61a953ccf25e for 2 recipients
[2025-06-19 11:59:46,864] INFO utils.email_service Email queued successfully: cec43351-7477-4f9e-a519-61a953ccf25e
[2025-06-19 11:59:46,868] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:46,882] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,882] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,885] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,885] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,896] INFO utils.services.queue_service Queued email c0298f2b-e56b-475f-89a5-34740db79b97 for 2 recipients
[2025-06-19 11:59:46,898] INFO utils.email_service Email queued successfully: c0298f2b-e56b-475f-89a5-34740db79b97
[2025-06-19 11:59:46,902] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:46,909] INFO utils.services.queue_service Successfully processed queue item bd92588f-08f4-45c8-b286-5aa65ec48aa9
[2025-06-19 11:59:46,927] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,927] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,933] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,934] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,937] INFO utils.services.queue_service Queued email 135607a2-2aca-4073-8a7c-b7dca94b8ab2 for 2 recipients
[2025-06-19 11:59:46,941] INFO utils.email_service Email queued successfully: 135607a2-2aca-4073-8a7c-b7dca94b8ab2
[2025-06-19 11:59:46,945] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:46,959] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,960] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:46,966] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:46,966] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:46,969] INFO utils.services.queue_service Queued email 098c1942-a1d7-4e3b-82c1-c27e4484835d for 2 recipients
[2025-06-19 11:59:46,973] INFO utils.email_service Email queued successfully: 098c1942-a1d7-4e3b-82c1-c27e4484835d
[2025-06-19 11:59:46,977] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:46,981] INFO utils.services.queue_service Successfully processed queue item fa935ab3-2532-492c-b178-78e7c6cc871a
[2025-06-19 11:59:46,996] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:46,996] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,004] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,004] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,011] INFO utils.services.queue_service Queued email e53bfff4-7838-473a-959b-2239afb8689c for 2 recipients
[2025-06-19 11:59:47,011] INFO utils.email_service Email queued successfully: e53bfff4-7838-473a-959b-2239afb8689c
[2025-06-19 11:59:47,016] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,031] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,031] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,039] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,040] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,044] INFO utils.services.queue_service Queued email 225c1edd-3e57-4ccd-aeb9-f2e075b66576 for 2 recipients
[2025-06-19 11:59:47,046] INFO utils.email_service Email queued successfully: 225c1edd-3e57-4ccd-aeb9-f2e075b66576
[2025-06-19 11:59:47,047] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,052] INFO utils.services.queue_service Successfully processed queue item ab671a2f-03b6-4711-acf6-80e19b46abb0
[2025-06-19 11:59:47,072] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,072] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,072] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,072] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,084] INFO utils.services.queue_service Queued email 23cf4162-b3f3-429c-833f-aa7b938f5bdf for 2 recipients
[2025-06-19 11:59:47,086] INFO utils.email_service Email queued successfully: 23cf4162-b3f3-429c-833f-aa7b938f5bdf
[2025-06-19 11:59:47,094] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,107] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,108] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,113] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,113] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,118] INFO utils.services.queue_service Queued email 3f44585d-c329-4fa4-9f3b-bf5d5ac9349f for 2 recipients
[2025-06-19 11:59:47,119] INFO utils.email_service Email queued successfully: 3f44585d-c329-4fa4-9f3b-bf5d5ac9349f
[2025-06-19 11:59:47,126] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,131] INFO utils.services.queue_service Successfully processed queue item 9c735655-57c7-415a-a737-4b0d6a98b5c2
[2025-06-19 11:59:47,147] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,147] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,158] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,160] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,164] INFO utils.services.queue_service Queued email dc29b654-2cb8-417f-86d9-4827b49fd1e1 for 2 recipients
[2025-06-19 11:59:47,165] INFO utils.email_service Email queued successfully: dc29b654-2cb8-417f-86d9-4827b49fd1e1
[2025-06-19 11:59:47,169] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,174] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,174] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,191] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,193] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,196] INFO utils.services.queue_service Queued email fdf7dd75-b8c7-4562-b576-c8347cf2c060 for 2 recipients
[2025-06-19 11:59:47,197] INFO utils.email_service Email queued successfully: fdf7dd75-b8c7-4562-b576-c8347cf2c060
[2025-06-19 11:59:47,202] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,203] INFO utils.services.queue_service Successfully processed queue item 9962f131-e0e0-4c88-a30f-cbc0063a5a93
[2025-06-19 11:59:47,226] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,227] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,232] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,233] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,236] INFO utils.services.queue_service Queued email f09ea676-fa1d-46f5-909f-05b8c5ed8314 for 2 recipients
[2025-06-19 11:59:47,239] INFO utils.email_service Email queued successfully: f09ea676-fa1d-46f5-909f-05b8c5ed8314
[2025-06-19 11:59:47,239] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,252] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,252] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,264] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,264] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,268] INFO utils.services.queue_service Queued email 99d3db76-148e-4be5-91b9-d80f5f51a0de for 2 recipients
[2025-06-19 11:59:47,268] INFO utils.email_service Email queued successfully: 99d3db76-148e-4be5-91b9-d80f5f51a0de
[2025-06-19 11:59:47,278] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,281] INFO utils.services.queue_service Successfully processed queue item f9b92efd-1734-488e-9632-447727dabedf
[2025-06-19 11:59:47,301] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,301] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,309] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,310] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,313] INFO utils.services.queue_service Queued email bdfac2c9-13d0-492d-8fab-2da5ec2fe565 for 2 recipients
[2025-06-19 11:59:47,314] INFO utils.email_service Email queued successfully: bdfac2c9-13d0-492d-8fab-2da5ec2fe565
[2025-06-19 11:59:47,319] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,333] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,335] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,341] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,343] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,346] INFO utils.services.queue_service Queued email a811b8e1-1319-40bb-b742-bb6717f9ddf7 for 2 recipients
[2025-06-19 11:59:47,347] INFO utils.email_service Email queued successfully: a811b8e1-1319-40bb-b742-bb6717f9ddf7
[2025-06-19 11:59:47,352] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,358] INFO utils.services.queue_service Successfully processed queue item 91366afb-c835-4e8e-9169-96ecf40772bf
[2025-06-19 11:59:47,369] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,369] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,383] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,384] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,386] INFO utils.services.queue_service Queued email 6688c6eb-0957-4a1d-ab3b-1e66fb06a573 for 2 recipients
[2025-06-19 11:59:47,386] INFO utils.email_service Email queued successfully: 6688c6eb-0957-4a1d-ab3b-1e66fb06a573
[2025-06-19 11:59:47,396] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,402] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,402] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,416] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,416] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,422] INFO utils.services.queue_service Queued email d56a6c26-326a-4331-a879-658951ab2d6b for 2 recipients
[2025-06-19 11:59:47,422] INFO utils.email_service Email queued successfully: d56a6c26-326a-4331-a879-658951ab2d6b
[2025-06-19 11:59:47,428] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,432] INFO utils.services.queue_service Successfully processed queue item 49d97a10-380e-4ba9-a972-dff67a4f97c7
[2025-06-19 11:59:47,455] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,456] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,462] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,462] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,466] INFO utils.services.queue_service Queued email 689c9a19-9908-43bb-97b0-b6ba48560d82 for 2 recipients
[2025-06-19 11:59:47,468] INFO utils.email_service Email queued successfully: 689c9a19-9908-43bb-97b0-b6ba48560d82
[2025-06-19 11:59:47,470] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,485] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,485] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,493] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,494] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,498] INFO utils.services.queue_service Queued email dc77636f-bc71-42c5-9ebb-3d2af68f7d2f for 2 recipients
[2025-06-19 11:59:47,500] INFO utils.email_service Email queued successfully: dc77636f-bc71-42c5-9ebb-3d2af68f7d2f
[2025-06-19 11:59:47,502] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,506] INFO utils.services.queue_service Successfully processed queue item 00b6858c-1fa6-4704-a87e-668fab499d0a
[2025-06-19 11:59:47,520] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,520] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,535] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,536] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,542] INFO utils.services.queue_service Queued email 406c7b29-5b7d-4ab3-bbb3-9171997e8d77 for 2 recipients
[2025-06-19 11:59:47,543] INFO utils.email_service Email queued successfully: 406c7b29-5b7d-4ab3-bbb3-9171997e8d77
[2025-06-19 11:59:47,547] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,561] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,561] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,569] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,569] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,569] INFO utils.services.queue_service Queued email 436e39f7-26d8-4aa3-a294-4465d496ff48 for 2 recipients
[2025-06-19 11:59:47,577] INFO utils.email_service Email queued successfully: 436e39f7-26d8-4aa3-a294-4465d496ff48
[2025-06-19 11:59:47,581] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,586] INFO utils.services.queue_service Successfully processed queue item a5fe799d-5baf-4525-928c-b2b2b7cc2566
[2025-06-19 11:59:47,611] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,612] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,618] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,618] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,622] INFO utils.services.queue_service Queued email ff387f89-e519-4b3c-87b1-aae93d66755c for 2 recipients
[2025-06-19 11:59:47,624] INFO utils.email_service Email queued successfully: ff387f89-e519-4b3c-87b1-aae93d66755c
[2025-06-19 11:59:47,628] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,643] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,644] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,652] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,653] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,655] INFO utils.services.queue_service Queued email 79971df7-989e-45cc-8873-3edc11020da8 for 2 recipients
[2025-06-19 11:59:47,659] INFO utils.email_service Email queued successfully: 79971df7-989e-45cc-8873-3edc11020da8
[2025-06-19 11:59:47,662] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,667] INFO utils.services.queue_service Successfully processed queue item 16d2be14-cb73-415f-b459-7190043146ce
[2025-06-19 11:59:47,690] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,691] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,696] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,698] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,704] INFO utils.services.queue_service Queued email 3eb5d15a-65c3-4e97-a7fd-a78d7337545b for 2 recipients
[2025-06-19 11:59:47,705] INFO utils.email_service Email queued successfully: 3eb5d15a-65c3-4e97-a7fd-a78d7337545b
[2025-06-19 11:59:47,709] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,722] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,723] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,729] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,730] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,735] INFO utils.services.queue_service Queued email 46b5aff0-a414-4df1-958c-e22d2ca5b816 for 2 recipients
[2025-06-19 11:59:47,738] INFO utils.email_service Email queued successfully: 46b5aff0-a414-4df1-958c-e22d2ca5b816
[2025-06-19 11:59:47,742] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,746] INFO utils.services.queue_service Successfully processed queue item 974e293c-7a6e-4735-ac8c-5c0222626f51
[2025-06-19 11:59:47,771] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,771] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,780] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,780] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,785] INFO utils.services.queue_service Queued email a90154ac-a37f-4232-a559-b1cb036429d3 for 2 recipients
[2025-06-19 11:59:47,786] INFO utils.email_service Email queued successfully: a90154ac-a37f-4232-a559-b1cb036429d3
[2025-06-19 11:59:47,790] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 11:59:47,829] INFO utils.services.queue_service Found 0 attachments for template sample_email
[2025-06-19 11:59:47,829] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 11:59:47,838] INFO utils.services.queue_service Found template configuration for sample_email
[2025-06-19 11:59:47,838] DEBUG utils.services.queue_service Successfully serialized context for sample_email
[2025-06-19 11:59:47,845] INFO utils.services.queue_service Queued email 5deee9df-9746-4197-adb9-457174c50052 for 2 recipients
[2025-06-19 11:59:47,849] INFO utils.email_service Email queued successfully: 5deee9df-9746-4197-adb9-457174c50052
[2025-06-19 11:59:47,857] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 11:59:47,865] INFO utils.services.queue_service Successfully processed queue item 1a0bcae1-f708-4885-a60a-4ad5a3df829a
[2025-06-19 11:59:47,869] INFO utils.services.queue_service Processed 16 queue items: 16 successful, 0 failed
[2025-06-19 12:02:34,758] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:02:46,585] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:02:46,604] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:02:46,604] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:02:46,604] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:02:46,604] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:02:46,609] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:02:46,611] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:02:46,760] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:02:46,769] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:02:46,769] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:02:46,769] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:02:46,782] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:02:46,786] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:02:46,794] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:02:46,809] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:02:46,926] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:02:46,927] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:02:46,927] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:02:46,928] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 12:02:46,983] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:02:53,540] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:02:53,543] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,544] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:02:53,545] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:02:53,545] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,545] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:02:53,547] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:02:53,548] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 133, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:02:53,548] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:02:53,554] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 133, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:02:53,582] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:02:53,591] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:02:53,593] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:02:53,597] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:02:53,597] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:02:53,598] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,599] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,601] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,607] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:02:53,610] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:02:53,613] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:02:53,614] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:02:53,616] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:02:53,619] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:02:53,620] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:02:53,622] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 133, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:02:53,623] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:02:53,624] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:02:53,624] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:02:53,627] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:02:53,629] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,631] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:02:53,632] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:02:53,634] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:02:53,637] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:02:53,637] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:02:53,639] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:02:53,640] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:02:53,641] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:02:53,641] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:02:53,642] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 133, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:02:53,642] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:02:53,642] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:02:53,642] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:02:53,663] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,668] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:02:53,669] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:02:53,670] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:02:53,673] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:02:53,676] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:02:53,678] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:02:53,680] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:02:53,681] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:02:53,683] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:02:53,687] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:02:53,689] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:02:53,691] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:02:53,697] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:02:53,697] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 133, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:02:53,699] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:02:53,701] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:02:53,713] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:02:53,715] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:02:53,715] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:03:01,886] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:03:01,886] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:03:01,901] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:03:01,905] INFO utils.services.queue_service Queued email 5b2e9718-a956-4b6e-85a4-0051b4d3035d for 2 recipients
[2025-06-19 12:03:01,906] INFO utils.email_service Email queued successfully: 5b2e9718-a956-4b6e-85a4-0051b4d3035d
[2025-06-19 12:03:01,907] INFO cart.views Order confirmation email queued successfully for order ORD-000021 to eugenelo4@bpp.com
[2025-06-19 12:03:04,787] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:03:04,815] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:03:04,820] ERROR utils.email_service Failed to send dynamic MJML email to ['eugenelo@bpp.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 12:03:04,820] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 12:03:04,823] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:03:04,823] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:03:04,835] ERROR utils.email_service Failed to send dynamic MJML email to ['eugene.lo1030@gmail.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 12:03:04,836] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 12:03:04,840] ERROR utils.services.queue_service Queue item 5b2e9718-a956-4b6e-85a4-0051b4d3035d failed after max attempts
[2025-06-19 12:03:04,843] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 12:03:34,848] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:04:04,853] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:04:34,862] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:05:04,866] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:05:34,875] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:06:04,881] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:06:34,891] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:07:04,896] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:07:34,902] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:08:04,912] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:08:34,915] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:09:04,927] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:09:34,931] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:10:04,938] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:10:34,944] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:11:04,947] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:11:34,953] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:11:38,955] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:11:39,047] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:11:39,047] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:11:39,048] INFO utils.services.queue_service Queued email e789485a-893b-4295-94e0-09f65f6f2bcc for 2 recipients
[2025-06-19 12:11:39,052] INFO utils.email_service Email queued successfully: e789485a-893b-4295-94e0-09f65f6f2bcc
[2025-06-19 12:11:59,594] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:11:59,617] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:11:59,619] ERROR utils.email_service Failed to send dynamic MJML email to ['eugenelo@bpp.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 12:11:59,619] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 12:11:59,619] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:11:59,619] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:11:59,619] ERROR utils.email_service Failed to send dynamic MJML email to ['eugene.lo1030@gmail.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 12:11:59,619] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 12:11:59,619] ERROR utils.services.queue_service Queue item e789485a-893b-4295-94e0-09f65f6f2bcc failed after max attempts
[2025-06-19 12:11:59,619] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 12:12:04,956] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:12:34,965] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:13:04,977] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:13:13,063] INFO utils.email_service Development mode: Redirecting email from ['test.fixed@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:13:13,204] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:13:13,204] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:13:13,210] INFO utils.services.queue_service Queued email 03053381-bd3f-40fc-8d06-32496bbfc13b for 2 recipients
[2025-06-19 12:13:13,214] INFO utils.email_service Email queued successfully: 03053381-bd3f-40fc-8d06-32496bbfc13b
[2025-06-19 12:13:30,780] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:13:30,799] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:13:30,805] ERROR utils.email_service Failed to send dynamic MJML email to ['eugenelo@bpp.com']: unable to parse next template in template from "./footer.mjml"
[2025-06-19 12:13:30,807] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 12:13:30,816] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:13:30,817] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:13:30,819] ERROR utils.email_service Failed to send dynamic MJML email to ['eugene.lo1030@gmail.com']: unable to parse next template in template from "./footer.mjml"
[2025-06-19 12:13:30,819] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 12:13:30,822] ERROR utils.services.queue_service Queue item 03053381-bd3f-40fc-8d06-32496bbfc13b failed after max attempts
[2025-06-19 12:13:30,822] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 12:13:34,980] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:14:04,989] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:14:34,993] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:15:04,998] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:15:35,005] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:16:05,007] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:16:23,448] INFO utils.email_service Development mode: Redirecting email from ['fixed.test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:16:23,543] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:16:23,544] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:16:23,548] INFO utils.services.queue_service Queued email 4002a27d-749d-4478-9e5b-dd80c792a3ad for 2 recipients
[2025-06-19 12:16:23,550] INFO utils.email_service Email queued successfully: 4002a27d-749d-4478-9e5b-dd80c792a3ad
[2025-06-19 12:16:35,032] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:16:35,032] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:16:35,032] ERROR utils.email_service Failed to send dynamic MJML email to ['eugenelo@bpp.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 12:16:35,032] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 12:16:35,042] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:16:35,042] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:16:35,042] ERROR utils.email_service Failed to send dynamic MJML email to ['eugene.lo1030@gmail.com']: unable to parse next template in template from "./banner.mjml"
[2025-06-19 12:16:35,042] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 12:16:35,042] ERROR utils.services.queue_service Queue item 4002a27d-749d-4478-9e5b-dd80c792a3ad failed after max attempts
[2025-06-19 12:16:35,042] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 12:16:48,244] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:17:05,060] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:17:14,132] INFO utils.email_service Development mode: Redirecting email from ['final.test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:17:14,226] INFO utils.email_service MJML compilation successful for template: password_reset
[2025-06-19 12:17:15,319] INFO utils.email_service MJML email sent successfully to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] using template password_reset
[2025-06-19 12:17:35,062] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:18:05,067] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:18:35,077] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:18:42,463] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 12:18:42,463] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 12:18:42,463] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 12:18:42,463] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 12:18:42,464] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 12:18:42,464] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 12:18:42,476] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 12:18:46,248] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:18:46,248] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:18:46,249] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:18:46,250] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:18:46,258] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:18:46,264] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:18:46,267] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:18:46,472] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:18:46,520] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:18:46,521] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 12:18:46,522] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 12:18:46,522] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:18:46,523] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:18:46,527] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:18:46,531] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-19 12:18:46,915] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_-5624726855754391975
[2025-06-19 12:18:47,301] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:18:47,302] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:18:47,303] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:18:47,303] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 12:18:47,894] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:18:47,895] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 12:18:47,896] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 12:18:47,899] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 12:18:48,048] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:18:48,049] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:18:48,049] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:18:48,050] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 12:19:05,079] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:19:09,883] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:19:09,884] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 12:19:09,887] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:19:09,888] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:19:09,894] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 12:19:09,940] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 12:19:09,947] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:19:09,950] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 12:19:09,951] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:19:09,953] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:19:09,953] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:19:09,953] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:19:09,953] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 12:19:09,955] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 12:19:09,957] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:19:09,958] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:19:09,960] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:19:09,963] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:19:09,964] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:19:09,966] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:19:09,966] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 12:19:09,980] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:19:09,980] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:19:09,981] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 12:19:09,983] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:19:09,984] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:19:09,987] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:19:09,990] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:19:09,992] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:19:09,994] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:19:10,031] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:19:10,031] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 135, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:19:10,033] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:19:10,034] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:19:10,034] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 135, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:19:10,054] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:19:10,055] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:19:10,055] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 135, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:19:10,057] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:19:10,057] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:19:10,058] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:19:10,058] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 135, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:19:10,059] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:19:10,059] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:19:10,060] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:19:10,060] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:19:10,148] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:19:10,148] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 135, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:19:10,149] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:19:10,150] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:19:10,150] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 135, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:19:10,165] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:19:10,166] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:19:10,166] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 135, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:19:10,169] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:19:10,169] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:19:10,170] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:19:10,170] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 135, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:19:10,172] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:19:10,172] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:19:10,173] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:19:10,173] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:19:35,085] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:19:54,224] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:20:24,229] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:20:54,234] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:21:10,452] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:21:10,454] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:21:10,454] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:21:10,456] INFO utils.services.queue_service Queued email efdafd85-e992-4066-a9c5-6f135a612fdd for 2 recipients
[2025-06-19 12:21:10,456] INFO utils.email_service Email queued successfully: efdafd85-e992-4066-a9c5-6f135a612fdd
[2025-06-19 12:21:10,458] INFO cart.views Order confirmation email queued successfully for order ORD-000022 to eugenelo4@bpp.com
[2025-06-19 12:21:24,273] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:21:24,306] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:21:24,309] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 12:21:24,579] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 217, 10)
[2025-06-19 12:21:24,581] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 12:21:24,582] ERROR CSSUTILS No content to parse.
[2025-06-19 12:21:24,582] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 12:21:24,659] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 12:21:25,733] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:21:25,743] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 12:21:25,753] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:21:25,754] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:21:25,755] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 12:21:25,772] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 12:21:26,813] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:21:26,822] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 12:21:26,825] INFO utils.services.queue_service Successfully processed queue item efdafd85-e992-4066-a9c5-6f135a612fdd
[2025-06-19 12:21:26,825] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 12:21:56,833] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:22:26,840] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:22:56,847] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:23:26,851] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:23:56,976] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:24:26,994] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:24:57,002] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:25:27,005] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:25:57,010] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:26:27,021] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:26:57,024] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:27:27,034] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:27:57,040] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:28:27,046] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:28:57,049] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:29:27,055] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:29:57,060] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:30:27,064] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:30:57,069] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:31:27,072] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:31:57,076] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:32:27,078] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:32:57,083] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:33:27,093] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:33:57,095] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:34:27,102] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:34:57,107] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:35:27,111] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:35:57,116] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:36:27,119] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:36:57,130] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:37:27,135] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:37:57,140] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:38:27,144] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:38:57,154] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:39:27,157] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:39:57,163] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:40:27,175] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:40:57,179] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:41:27,191] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:41:57,193] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:42:27,202] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:42:57,210] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:43:27,221] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:43:57,226] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:44:27,232] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:44:57,239] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:45:27,250] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:45:57,260] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:46:27,265] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:46:57,270] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:47:27,283] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:47:30,499] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:47:30,505] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:47:30,505] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:47:30,506] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:47:30,506] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:47:30,506] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:47:30,506] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:47:30,524] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:47:30,524] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:47:30,525] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:47:30,526] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:47:30,526] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:47:30,534] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:47:30,541] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:47:30,580] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:47:30,588] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:47:30,589] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:47:30,591] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:47:30,607] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:47:30,629] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:47:30,640] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:47:30,699] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:47:30,743] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:47:30,833] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:47:35,620] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:47:35,622] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,625] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:47:35,626] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:47:35,628] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,630] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:47:35,633] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:47:35,636] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 136, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:47:35,644] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:47:35,653] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 136, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:47:35,659] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:47:35,661] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,674] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:47:35,674] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:47:35,674] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:47:35,681] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:47:35,681] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:47:35,682] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 136, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:47:35,683] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:47:35,683] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:47:35,683] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,685] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,685] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,686] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:47:35,688] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:47:35,691] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:47:35,691] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:47:35,692] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:47:35,692] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:47:35,694] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:47:35,695] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 136, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:47:35,696] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:47:35,697] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:47:35,697] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:47:35,698] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:47:35,700] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:47:35,701] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:47:35,703] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:47:35,703] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:47:35,705] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,707] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:47:35,709] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:47:35,711] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:47:35,711] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:47:35,713] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:47:35,713] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:47:35,713] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:47:35,713] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:47:35,714] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:47:35,717] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:47:35,722] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 12:47:35,726] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:47:35,727] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:47:35,729] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:47:35,732] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:47:35,734] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:47:35,737] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:47:35,740] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:47:35,741] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 136, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 12:47:35,743] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:47:35,744] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 12:47:35,749] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:47:35,752] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:47:35,756] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:47:41,856] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:47:41,856] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:47:41,856] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:47:41,869] INFO utils.services.queue_service Queued email 77d2a239-9258-4efd-9d0a-d2c10b82c9c3 for 2 recipients
[2025-06-19 12:47:41,869] INFO utils.email_service Email queued successfully: 77d2a239-9258-4efd-9d0a-d2c10b82c9c3
[2025-06-19 12:47:41,871] INFO cart.views Order confirmation email queued successfully for order ORD-000023 to eugenelo4@bpp.com
[2025-06-19 12:47:57,310] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:47:57,312] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:47:57,314] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 12:47:57,334] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 12:47:58,601] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:47:58,610] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 12:47:58,618] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:47:58,618] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:47:58,620] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 12:47:58,634] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 12:47:59,719] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:47:59,737] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 12:47:59,737] INFO utils.services.queue_service Successfully processed queue item 77d2a239-9258-4efd-9d0a-d2c10b82c9c3
[2025-06-19 12:47:59,737] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 12:48:29,749] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:48:59,754] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:49:29,758] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:49:59,763] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:50:29,769] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:50:59,773] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:51:29,776] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:51:59,784] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:52:29,786] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:52:59,793] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:53:29,796] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:53:59,802] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:54:16,195] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:54:16,199] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:54:16,200] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:54:16,201] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:54:16,202] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:54:16,205] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:54:16,205] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:54:16,226] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:54:16,227] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:54:16,227] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:54:16,232] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 12:54:16,233] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 12:54:16,237] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 12:54:16,242] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 12:54:16,384] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:54:16,425] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 12:54:16,520] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 12:54:16,520] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 12:54:16,522] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 12:54:16,523] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 12:54:28,839] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:54:28,839] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,839] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:54:28,842] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:54:28,843] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 137, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:54:28,856] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:54:28,862] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:54:28,864] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,866] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:54:28,867] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:54:28,868] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:54:28,868] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:54:28,869] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 12:54:28,870] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,870] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 12:54:28,872] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:54:28,873] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:54:28,873] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:54:28,873] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:54:28,875] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 137, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:54:28,877] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:54:28,877] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:54:28,880] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,881] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:54:28,882] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:54:28,885] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 137, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:54:28,888] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:54:28,890] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:54:28,892] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,893] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:54:28,895] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:54:28,896] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:54:28,897] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:54:28,897] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 12:54:28,898] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:54:28,898] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 12:54:28,899] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,899] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:54:28,900] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:54:28,901] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:54:28,901] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:54:28,902] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:54:28,902] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:54:28,903] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 12:54:28,905] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 12:54:28,907] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:54:28,907] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:54:28,908] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:54:28,958] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 12:54:28,958] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,959] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 12:54:28,959] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 12:54:28,959] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 137, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 12:54:28,964] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 12:54:28,965] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 12:54:28,965] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 12:54:28,965] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 12:54:28,965] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 12:54:28,966] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 12:54:28,966] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 137, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 12:54:28,966] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 12:54:28,966] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 12:54:28,966] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 12:54:28,966] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 12:54:29,806] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:54:35,475] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:54:35,475] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:54:35,475] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:54:35,475] INFO utils.services.queue_service Queued email 8ad24262-a356-4008-ba8c-87d9dc718bd3 for 2 recipients
[2025-06-19 12:54:35,475] INFO utils.email_service Email queued successfully: 8ad24262-a356-4008-ba8c-87d9dc718bd3
[2025-06-19 12:54:35,475] INFO cart.views Order confirmation email queued successfully for order ORD-000024 to eugenelo4@bpp.com
[2025-06-19 12:54:59,817] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:54:59,817] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:54:59,826] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 12:54:59,842] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 12:55:00,923] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:55:00,938] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 12:55:00,943] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:55:00,944] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:55:00,945] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 12:55:00,950] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 12:55:01,924] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:55:01,939] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 12:55:01,942] INFO utils.services.queue_service Successfully processed queue item 8ad24262-a356-4008-ba8c-87d9dc718bd3
[2025-06-19 12:55:01,945] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 12:55:31,952] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:56:01,959] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:56:31,968] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:57:01,974] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:57:31,980] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:58:01,983] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:58:31,991] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:58:32,591] INFO utils.email_service Development mode: Redirecting email from ['template.test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 12:58:32,760] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 12:58:32,760] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 12:58:32,765] INFO utils.services.queue_service Queued email cc818996-85e0-468b-b639-01bfa235fd05 for 2 recipients
[2025-06-19 12:58:32,773] INFO utils.email_service Email queued successfully: cc818996-85e0-468b-b639-01bfa235fd05
[2025-06-19 12:58:40,687] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:58:40,705] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 12:58:40,705] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 12:58:40,705] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 12:58:40,718] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 12:58:40,723] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 12:58:40,724] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 12:58:40,724] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 12:58:40,725] ERROR utils.services.queue_service Queue item cc818996-85e0-468b-b639-01bfa235fd05 failed after max attempts
[2025-06-19 12:58:40,725] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 12:59:01,999] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 12:59:32,008] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:00:02,011] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:00:32,019] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:00:43,601] INFO utils.email_service Development mode: Redirecting email from ['content.fix.test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:00:43,684] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 13:00:43,684] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 13:00:43,687] INFO utils.services.queue_service Queued email 50cc24d2-e9d7-4c41-a000-0f7c33ab7bdf for 2 recipients
[2025-06-19 13:00:43,687] INFO utils.email_service Email queued successfully: 50cc24d2-e9d7-4c41-a000-0f7c33ab7bdf
[2025-06-19 13:00:50,920] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:00:50,928] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:00:50,929] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:00:50,929] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 13:00:50,935] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:00:50,936] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:00:50,937] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:00:50,937] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 13:00:50,939] ERROR utils.services.queue_service Queue item 50cc24d2-e9d7-4c41-a000-0f7c33ab7bdf failed after max attempts
[2025-06-19 13:00:50,940] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 13:01:02,033] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:01:32,039] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:02:02,043] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:02:32,049] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:03:02,059] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:03:32,068] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:04:02,076] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:04:32,083] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:05:02,087] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:05:32,097] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:06:02,099] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:06:32,104] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:06:51,328] INFO utils.email_service Development mode: Redirecting email from ['syntax.fixed@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:06:51,412] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 13:06:51,412] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 13:06:51,419] INFO utils.services.queue_service Queued email 5710609a-6291-4c52-8c5d-c2934502ab48 for 2 recipients
[2025-06-19 13:06:51,428] INFO utils.email_service Email queued successfully: 5710609a-6291-4c52-8c5d-c2934502ab48
[2025-06-19 13:06:57,314] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:06:57,322] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:06:57,322] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:06:57,322] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 13:06:57,332] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:06:57,333] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:06:57,334] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 77: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 13:06:57,334] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 13:06:57,335] ERROR utils.services.queue_service Queue item 5710609a-6291-4c52-8c5d-c2934502ab48 failed after max attempts
[2025-06-19 13:06:57,338] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 13:07:02,106] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:07:32,112] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:08:02,123] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:08:22,135] INFO utils.email_service Development mode: Redirecting email from ['template.fixed@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:08:22,212] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 13:08:22,212] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 13:08:22,233] INFO utils.services.queue_service Queued email a89df30a-12c6-47e2-bfb4-23b005225395 for 2 recipients
[2025-06-19 13:08:22,241] INFO utils.email_service Email queued successfully: a89df30a-12c6-47e2-bfb4-23b005225395
[2025-06-19 13:08:32,144] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:08:32,146] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:08:32,147] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:08:32,168] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:08:33,118] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:08:33,279] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:08:33,294] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 13:08:33,301] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:08:33,301] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:08:33,305] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:08:33,324] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:08:34,416] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:08:34,416] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 13:08:34,428] INFO utils.services.queue_service Successfully processed queue item a89df30a-12c6-47e2-bfb4-23b005225395
[2025-06-19 13:08:34,431] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 13:08:42,275] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:08:42,277] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:08:42,277] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:08:42,277] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 13:08:42,277] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 13:08:42,279] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:08:42,279] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:08:42,280] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:08:42,280] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 13:08:42,280] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 13:08:42,281] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 13:08:42,283] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 13:08:42,283] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 13:08:42,285] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 13:08:42,320] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:08:42,321] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:08:42,325] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:08:42,330] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 13:08:42,338] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 13:08:42,351] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 13:08:42,356] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 13:08:42,477] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 13:08:42,480] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 13:08:42,555] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1236746855891676665
[2025-06-19 13:08:57,372] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:09:04,438] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:09:19,855] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:09:19,857] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,858] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:09:19,859] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:09:19,860] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 138, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:09:19,876] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:09:19,878] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:09:19,879] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,881] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:09:19,883] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,886] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:09:19,889] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:09:19,891] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:09:19,894] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:09:19,894] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 138, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:09:19,895] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:09:19,901] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:09:19,903] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:09:19,907] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,909] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:09:19,912] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:09:19,916] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:09:19,920] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:09:19,922] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:09:19,924] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:09:19,924] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:09:19,925] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 138, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:09:19,927] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:09:19,928] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:09:19,934] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,935] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,937] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:09:19,940] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:09:19,943] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:09:19,945] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:09:19,945] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:09:19,948] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:09:19,949] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 138, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:09:19,950] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:09:19,952] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:09:19,953] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,955] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:09:19,957] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:09:19,959] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:09:19,962] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:09:19,962] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:09:19,965] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:09:19,965] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:09:19,965] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:09:19,966] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:09:19,966] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:09:19,971] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:09:19,971] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:09:19,972] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:09:19,973] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:09:19,973] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:09:19,973] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:09:19,974] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:09:19,975] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:09:19,978] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 138, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:09:19,982] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:09:19,986] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:09:19,989] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:09:19,991] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:09:25,777] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:09:25,779] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 13:09:25,780] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 13:09:25,780] INFO utils.services.queue_service Queued email 896ca7ed-eb97-4458-b2d7-b36bef33f4ef for 2 recipients
[2025-06-19 13:09:25,780] INFO utils.email_service Email queued successfully: 896ca7ed-eb97-4458-b2d7-b36bef33f4ef
[2025-06-19 13:09:25,780] INFO cart.views Order confirmation email queued successfully for order ORD-000025 to eugenelo4@bpp.com
[2025-06-19 13:09:34,452] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:09:34,453] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:09:34,453] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:09:34,470] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:09:35,643] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:09:35,646] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 13:09:35,648] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:09:35,648] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:09:35,658] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:09:35,670] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:09:36,646] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:09:36,657] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 13:09:36,659] INFO utils.services.queue_service Successfully processed queue item 896ca7ed-eb97-4458-b2d7-b36bef33f4ef
[2025-06-19 13:09:36,663] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 13:10:06,669] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:10:31,106] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:10:31,106] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:10:31,106] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:10:31,106] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 13:10:31,171] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:10:31,172] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:10:31,173] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:10:31,175] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 13:10:31,399] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:10:31,400] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:10:31,400] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:10:31,402] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 13:10:36,671] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:10:49,578] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:10:49,586] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,589] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:10:49,591] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:10:49,592] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 62.0, 'total_vat': 12.4, 'total_gross': 74.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 139, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 140, 'product_name': 'Series X Assignments', 'net_amount': 41.0, 'vat_amount': 8.2, 'gross_amount': 49.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:10:49,619] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:10:49,622] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:10:49,624] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,630] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:10:49,635] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:10:49,635] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:10:49,636] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:10:49,638] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:10:49,638] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,639] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:10:49,639] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:10:49,639] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,640] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:10:49,640] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,640] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:10:49,641] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:10:49,642] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:10:49,642] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:10:49,642] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 13:10:49,643] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:10:49,643] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 62.0, 'total_vat': 12.4, 'total_gross': 74.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 139, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 140, 'product_name': 'Series X Assignments', 'net_amount': 41.0, 'vat_amount': 8.2, 'gross_amount': 49.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:10:49,643] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:10:49,644] INFO rules_engine.custom_functions DEBUG: product_id: 85, subject_code: CB1
[2025-06-19 13:10:49,644] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 62.0, 'total_vat': 12.4, 'total_gross': 74.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 139, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 140, 'product_name': 'Series X Assignments', 'net_amount': 41.0, 'vat_amount': 8.2, 'gross_amount': 49.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:10:49,645] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 62.0, 'total_vat': 12.4, 'total_gross': 74.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 139, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 140, 'product_name': 'Series X Assignments', 'net_amount': 41.0, 'vat_amount': 8.2, 'gross_amount': 49.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:10:49,645] INFO rules_engine.custom_functions DEBUG: Found assignment product 85 with subject CB1
[2025-06-19 13:10:49,652] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 13:10:49,654] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:10:49,655] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:10:49,661] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:10:49,664] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:10:49,666] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:10:49,668] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,669] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:10:49,669] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:10:49,670] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:10:49,670] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:10:49,671] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,672] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:10:49,673] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 13:10:49,675] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:10:49,675] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:10:49,676] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:10:49,676] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:10:49,677] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:10:49,677] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:10:49,677] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:10:49,678] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:10:49,678] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:10:49,679] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:10:49,679] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 13:10:49,680] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 139, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:10:49,682] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:10:49,683] INFO rules_engine.custom_functions DEBUG: product_id: 85, subject_code: CB1
[2025-06-19 13:10:49,685] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:10:49,685] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 13:10:49,686] INFO rules_engine.custom_functions DEBUG: Found assignment product 85 with subject CB1
[2025-06-19 13:10:49,686] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 140, 'product_id': 85, 'subject_code': 'CB1', 'product_name': 'Series X Assignments', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '41.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 13:10:49,687] INFO rules_engine.custom_functions DEBUG: product_id: 85, subject_code: CB1
[2025-06-19 13:10:49,687] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 13:10:49,688] INFO rules_engine.custom_functions DEBUG: product_id: 85, subject_code: CB1
[2025-06-19 13:10:49,688] INFO rules_engine.custom_functions DEBUG: Found assignment product 85 with subject CB1
[2025-06-19 13:10:49,688] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:10:49,689] INFO rules_engine.custom_functions DEBUG: Found assignment product 85 with subject CB1
[2025-06-19 13:10:49,689] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 13:10:49,689] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:10:49,689] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 13:10:49,691] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:10:49,691] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:10:49,691] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:10:49,692] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:10:55,165] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:10:55,165] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 13:10:55,165] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 13:10:55,182] INFO utils.services.queue_service Queued email 5a02c219-9f38-4350-b640-36eb7090b04b for 2 recipients
[2025-06-19 13:10:55,183] INFO utils.email_service Email queued successfully: 5a02c219-9f38-4350-b640-36eb7090b04b
[2025-06-19 13:10:55,183] INFO cart.views Order confirmation email queued successfully for order ORD-000026 to eugenelo4@bpp.com
[2025-06-19 13:11:06,691] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:11:06,692] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:11:06,693] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:11:06,704] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:11:07,830] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:11:07,851] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 13:11:07,864] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:11:07,864] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:11:07,867] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:11:07,871] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:11:08,868] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:11:08,876] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 13:11:08,878] INFO utils.services.queue_service Successfully processed queue item 5a02c219-9f38-4350-b640-36eb7090b04b
[2025-06-19 13:11:08,880] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 13:11:38,887] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:12:08,896] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:12:38,899] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:13:08,908] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:13:23,328] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 13:13:24,888] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 13:13:33,428] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 13:13:34,369] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 13:13:38,914] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:14:08,926] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:14:38,932] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:15:01,397] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 13:15:02,240] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 13:15:08,847] INFO utils.email_service Development mode: Redirecting email from ['debug.test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:15:08,916] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 13:15:08,916] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 13:15:08,916] INFO utils.services.queue_service Queued email e1992363-5e3f-487d-bc03-6f5c7bcbbd56 for 2 recipients
[2025-06-19 13:15:08,931] INFO utils.email_service Email queued successfully: e1992363-5e3f-487d-bc03-6f5c7bcbbd56
[2025-06-19 13:15:08,935] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:15:08,948] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:15:08,948] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:15:08,959] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:15:10,055] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:15:10,062] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 13:15:10,069] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:15:10,070] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:15:10,072] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:15:10,082] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:15:11,080] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:15:11,085] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 13:15:11,087] INFO utils.services.queue_service Successfully processed queue item e1992363-5e3f-487d-bc03-6f5c7bcbbd56
[2025-06-19 13:15:11,090] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 13:15:16,318] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:15:23,474] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:15:38,899] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:15:38,981] DEBUG utils.email_service DEBUG: Using MJML template file: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation.mjml
[2025-06-19 13:15:38,981] DEBUG utils.email_service DEBUG: Template exists: True
[2025-06-19 13:15:38,985] INFO utils.email_service MJML compilation successful for template: order_confirmation
[2025-06-19 13:15:39,096] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 217, 10)
[2025-06-19 13:15:39,097] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 13:15:39,099] ERROR CSSUTILS No content to parse.
[2025-06-19 13:15:39,099] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 13:15:39,131] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 13:15:39,132] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 13:15:39,133] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 13:15:39,134] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 13:15:39,134] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 13:15:39,135] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 13:15:39,144] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:15:40,410] INFO utils.email_service MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] using template order_confirmation
[2025-06-19 13:15:41,098] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:15:51,005] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 13:15:51,005] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 13:15:51,006] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 13:15:51,016] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 6820 characters
[2025-06-19 13:15:51,017] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 13:15:51,017] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 13:15:51,018] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 13:15:51,020] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 17041 characters
[2025-06-19 13:16:11,101] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:16:41,109] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:17:11,119] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:17:41,122] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:18:11,127] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:18:41,134] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:19:11,141] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:19:41,150] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:20:11,158] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:20:41,164] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:21:11,171] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:21:41,173] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:22:11,179] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:22:41,186] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:23:11,196] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:23:41,198] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:24:11,206] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:24:41,211] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:25:11,222] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:25:41,226] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:26:11,231] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:26:41,236] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:27:11,242] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:27:41,247] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:28:11,254] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:28:41,261] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:57:55,601] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:58:25,608] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:58:55,610] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:59:20,806] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 13:59:20,806] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 13:59:20,815] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 13:59:20,817] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 13:59:20,822] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 13:59:20,827] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 13:59:20,831] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 13:59:24,549] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:59:24,550] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 13:59:24,550] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 13:59:24,551] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 13:59:24,551] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 13:59:24,553] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:59:24,553] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:59:24,553] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:59:24,554] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 13:59:24,554] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 13:59:24,554] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 13:59:24,555] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-19 13:59:24,558] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 13:59:24,561] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 13:59:24,709] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-6861005004062764620
[2025-06-19 13:59:24,742] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:59:24,743] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:59:24,743] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:59:24,744] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 13:59:24,794] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_-140256609068546645
[2025-06-19 13:59:24,935] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:59:24,936] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 13:59:24,936] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 13:59:24,937] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 13:59:24,940] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 13:59:24,940] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 13:59:24,941] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 13:59:24,942] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 13:59:25,619] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 142, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 2, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:59:36,630] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:59:36,639] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 142, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:59:36,644] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 13:59:36,645] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:59:36,645] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:59:36,659] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:59:36,663] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:59:36,664] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 13:59:36,666] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 142, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 2, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:59:36,667] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:59:36,668] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:59:36,668] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:59:36,669] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:59:36,669] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:59:36,670] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:59:36,670] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 13:59:36,671] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:59:36,671] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:59:36,672] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:59:36,673] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 142, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 2, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:59:36,674] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:59:36,675] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:59:36,677] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:59:36,678] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:59:36,679] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 13:59:36,679] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:59:36,679] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 13:59:36,682] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:59:36,682] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 142, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 2, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:59:36,683] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:59:36,685] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 13:59:36,686] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 13:59:36,688] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 13:59:36,692] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 142, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 13:59:36,699] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:59:36,702] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:59:36,703] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 13:59:36,708] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:59:36,710] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 13:59:36,710] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:59:36,712] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 13:59:36,714] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:59:36,714] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 142, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 2, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 13:59:36,714] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:59:36,715] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 13:59:36,716] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:59:36,716] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 13:59:36,716] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:59:36,716] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 13:59:36,718] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 142, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 2, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 13:59:36,720] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 13:59:36,720] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 13:59:36,721] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 13:59:36,722] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 13:59:44,789] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:59:44,793] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 13:59:44,794] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 13:59:44,796] INFO utils.services.queue_service Queued email 36c45375-7a0c-4e81-870b-42adaa777efb for 2 recipients
[2025-06-19 13:59:44,797] INFO utils.email_service Email queued successfully: 36c45375-7a0c-4e81-870b-42adaa777efb
[2025-06-19 13:59:44,798] INFO cart.views Order confirmation email queued successfully for order ORD-000027 to eugenelo4@bpp.com
[2025-06-19 13:59:55,628] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:59:55,629] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:59:55,630] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:59:55,647] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:59:56,755] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:59:56,767] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 13:59:56,774] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 13:59:56,775] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:59:56,776] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 13:59:56,792] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 13:59:57,834] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 13:59:57,837] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 13:59:57,839] INFO utils.services.queue_service Successfully processed queue item 36c45375-7a0c-4e81-870b-42adaa777efb
[2025-06-19 13:59:57,842] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 14:00:27,847] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:00:57,849] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:01:27,860] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:01:57,866] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:02:01,420] INFO utils.email_service Development mode: Redirecting email from ['newtest@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:02:01,502] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 14:02:01,502] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 14:02:01,505] INFO utils.services.queue_service Queued email 73ac558b-7d9a-480f-90ca-a2cc9b51dca0 for 2 recipients
[2025-06-19 14:02:01,513] INFO utils.email_service Email queued successfully: 73ac558b-7d9a-480f-90ca-a2cc9b51dca0
[2025-06-19 14:02:27,879] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:02:27,879] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:02:27,879] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:02:27,899] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:02:29,039] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:02:29,042] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 14:02:29,048] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:02:29,050] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:02:29,053] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:02:29,070] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:02:30,184] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:02:30,184] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 14:02:30,196] INFO utils.services.queue_service Successfully processed queue item 73ac558b-7d9a-480f-90ca-a2cc9b51dca0
[2025-06-19 14:02:30,198] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 14:03:00,209] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:03:30,221] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:04:00,234] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:04:30,241] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:05:00,254] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:05:30,267] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:06:00,275] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:06:30,284] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:07:00,302] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:07:30,313] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:08:00,322] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:08:30,328] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:09:00,334] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:09:30,338] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:10:00,340] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:10:30,351] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:11:00,353] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:11:30,362] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:12:00,367] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:12:30,372] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:13:00,384] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:13:30,386] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:14:00,392] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:14:30,400] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:15:00,406] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:15:30,414] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:16:00,420] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:16:30,429] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:17:00,436] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:17:30,446] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:18:00,450] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:18:30,457] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:19:00,466] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:19:30,470] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:20:00,475] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:20:30,485] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:21:00,490] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:21:30,494] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:22:00,507] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:22:30,512] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:23:00,516] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:23:30,523] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:24:00,526] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:24:30,532] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:25:00,539] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:25:30,542] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:26:00,543] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:26:30,551] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:27:00,560] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:27:30,564] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:27:48,498] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-19 14:27:49,490] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 14:28:00,568] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:28:30,115] INFO utils.email_service Development mode: Redirecting email from ['test.master.template@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:28:30,212] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 14:28:30,212] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 14:28:30,223] INFO utils.services.queue_service Queued email 52fcf5e0-bd29-4854-b09e-fb4c9f6727cf for 2 recipients
[2025-06-19 14:28:30,232] INFO utils.email_service Email queued successfully: 52fcf5e0-bd29-4854-b09e-fb4c9f6727cf
[2025-06-19 14:28:30,585] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com: column "html_content" of relation "utils_email_log" does not exist
LINE 1: ...emplate_id", "to_email", "from_email", "subject", "html_cont...
                                                             ^

[2025-06-19 14:28:30,585] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com: column "html_content" of relation "utils_email_log" does not exist
LINE 1: ...emplate_id", "to_email", "from_email", "subject", "html_cont...
                                                             ^

[2025-06-19 14:28:30,585] ERROR utils.services.queue_service Queue item 52fcf5e0-bd29-4854-b09e-fb4c9f6727cf failed after max attempts
[2025-06-19 14:28:30,590] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 14:28:37,529] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:29:00,599] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:29:23,459] INFO utils.email_service Development mode: Redirecting email from ['test.direct@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:29:23,578] INFO utils.email_service MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-19 14:29:23,578] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:29:23,578] ERROR utils.email_service Failed to send HTML email to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']: emails/order_confirmation.html
[2025-06-19 14:29:28,859] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:29:28,859] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:29:28,859] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:29:28,875] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 6820 characters
[2025-06-19 14:29:28,875] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:29:28,875] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:29:28,875] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:29:28,896] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 17041 characters
[2025-06-19 14:29:30,604] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:30:00,607] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:30:30,610] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:31:00,617] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:31:30,620] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:32:00,629] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:32:30,636] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:33:00,645] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:33:30,654] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:34:00,662] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:34:30,680] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:34:50,628] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-19 14:34:56,615] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 14:35:00,691] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:35:11,155] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:35:11,167] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:35:11,167] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:35:11,168] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:35:11,169] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:35:11,169] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:35:11,172] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 14:35:11,173] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 14:35:11,175] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 14:35:11,175] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 14:35:11,178] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 14:35:11,179] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 14:35:11,180] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 14:35:11,181] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 14:35:11,325] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-7848671907736897036
[2025-06-19 14:35:11,330] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-7848671907736897036
[2025-06-19 14:35:11,581] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:35:11,581] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:35:11,581] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:35:11,583] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 14:35:22,092] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:35:22,093] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:35:22,093] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,094] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,094] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:35:22,094] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:35:22,095] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:35:22,095] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:35:22,095] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 70.0, 'total_vat': 14.0, 'total_gross': 84.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 143, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:35:22,095] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 70.0, 'total_vat': 14.0, 'total_gross': 84.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 143, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:35:22,108] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:35:22,109] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:35:22,109] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:35:22,109] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,109] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:35:22,110] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:35:22,110] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,110] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:35:22,110] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:35:22,110] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:35:22,110] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:35:22,110] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:35:22,111] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:35:22,111] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-19 14:35:22,111] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:35:22,111] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:35:22,112] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-19 14:35:22,112] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:35:22,112] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:35:22,112] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:35:22,112] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:35:22,113] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:35:22,184] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:35:22,184] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:35:22,184] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,185] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,186] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:35:22,186] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:35:22,187] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:35:22,188] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:35:22,188] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 70.0, 'total_vat': 14.0, 'total_gross': 84.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 143, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:35:22,188] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 70.0, 'total_vat': 14.0, 'total_gross': 84.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 143, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:35:22,195] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:35:22,195] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:35:22,195] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:35:22,195] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 143, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:35:22,196] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:35:30,695] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:35:31,221] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:35:31,245] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 14:35:31,245] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 14:35:31,250] INFO utils.services.queue_service Queued email 1fd4050e-89a5-478a-a826-2099c374d607 for 2 recipients
[2025-06-19 14:35:31,250] INFO utils.email_service Email queued successfully: 1fd4050e-89a5-478a-a826-2099c374d607
[2025-06-19 14:35:31,250] INFO cart.views Order confirmation email queued successfully for order ORD-000028 to eugenelo4@bpp.com
[2025-06-19 14:35:50,672] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-19 14:35:52,026] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 14:35:59,904] INFO utils.email_service Development mode: Redirecting email from ['test.cleaned.up@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:35:59,990] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 14:35:59,990] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 14:35:59,990] INFO utils.services.queue_service Queued email 5ee3e291-3dc2-4c8f-9bff-f58ab5085ebf for 2 recipients
[2025-06-19 14:36:00,006] INFO utils.email_service Email queued successfully: 5ee3e291-3dc2-4c8f-9bff-f58ab5085ebf
[2025-06-19 14:36:00,719] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com: column "html_content" of relation "utils_email_log" does not exist
LINE 1: ...emplate_id", "to_email", "from_email", "subject", "html_cont...
                                                             ^

[2025-06-19 14:36:00,722] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com: column "html_content" of relation "utils_email_log" does not exist
LINE 1: ...emplate_id", "to_email", "from_email", "subject", "html_cont...
                                                             ^

[2025-06-19 14:36:00,722] ERROR utils.services.queue_service Queue item 1fd4050e-89a5-478a-a826-2099c374d607 failed after max attempts
[2025-06-19 14:36:00,733] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com: column "html_content" of relation "utils_email_log" does not exist
LINE 1: ...emplate_id", "to_email", "from_email", "subject", "html_cont...
                                                             ^

[2025-06-19 14:36:00,733] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com: column "html_content" of relation "utils_email_log" does not exist
LINE 1: ...emplate_id", "to_email", "from_email", "subject", "html_cont...
                                                             ^

[2025-06-19 14:36:00,737] ERROR utils.services.queue_service Queue item 5ee3e291-3dc2-4c8f-9bff-f58ab5085ebf failed after max attempts
[2025-06-19 14:36:00,744] INFO utils.services.queue_service Processed 2 queue items: 0 successful, 2 failed
[2025-06-19 14:36:30,753] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:36:43,318] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:36:43,319] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:36:43,319] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:36:43,441] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4741 characters
[2025-06-19 14:36:43,441] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:36:43,441] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:36:43,441] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:36:43,441] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 14974 characters
[2025-06-19 14:37:00,759] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:37:30,765] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:38:00,766] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:38:30,772] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:39:00,782] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:39:30,784] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:40:00,795] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:40:17,687] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:40:17,690] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:40:17,691] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:40:17,692] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 14:40:17,692] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 14:40:17,698] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 14:40:17,705] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 14:40:17,722] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:40:17,722] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:40:17,722] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:40:17,725] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 14:40:17,733] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 14:40:17,759] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 14:40:17,783] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 14:40:17,927] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4823268287186988978
[2025-06-19 14:40:17,927] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:40:17,927] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:40:17,927] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:40:17,927] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 14:40:17,975] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4823268287186988978
[2025-06-19 14:40:28,997] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:40:29,011] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:40:29,011] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,014] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,019] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:40:29,021] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:40:29,026] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:40:29,028] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:40:29,028] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,033] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:40:29,033] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 144, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:40:29,034] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:40:29,034] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:40:29,034] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 144, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:40:29,037] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,037] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:40:29,042] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:40:29,044] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 144, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:40:29,046] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:40:29,053] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 144, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:40:29,058] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:40:29,061] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:40:29,065] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:40:29,067] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:40:29,069] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,069] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:40:29,070] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,072] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:40:29,072] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:40:29,072] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:40:29,073] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:40:29,074] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:40:29,074] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:40:29,074] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,075] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:40:29,075] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:40:29,075] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:40:29,077] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:40:29,078] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:40:29,081] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:40:29,082] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:40:29,086] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:40:29,086] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:40:29,087] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:40:29,088] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:40:29,088] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:40:29,089] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:40:29,089] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:40:29,089] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:40:29,090] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:40:29,090] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:40:29,090] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:40:29,091] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 144, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:40:29,091] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:40:29,092] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:40:29,092] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:40:29,092] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:40:29,093] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:40:29,093] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:40:29,096] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:40:29,099] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:40:29,107] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:40:29,109] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:40:29,110] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:40:30,802] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:40:35,596] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:40:35,615] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 14:40:35,615] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 14:40:35,618] INFO utils.services.queue_service Queued email a01bbd1c-b767-4db4-9579-6fd120eb1907 for 2 recipients
[2025-06-19 14:40:35,620] INFO utils.email_service Email queued successfully: a01bbd1c-b767-4db4-9579-6fd120eb1907
[2025-06-19 14:40:35,620] INFO cart.views Order confirmation email queued successfully for order ORD-000029 to eugenelo4@bpp.com
[2025-06-19 14:40:59,497] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:40:59,497] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 14:40:59,497] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 14:40:59,497] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 14:40:59,503] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 14:40:59,503] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 14:40:59,503] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 14:40:59,504] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 14:40:59,505] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:40:59,505] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:40:59,505] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:40:59,518] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 14:40:59,518] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:40:59,518] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:40:59,518] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:40:59,526] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 14954 characters
[2025-06-19 14:40:59,527] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:40:59,527] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:40:59,674] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 217, 10)
[2025-06-19 14:40:59,674] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 14:40:59,676] ERROR CSSUTILS No content to parse.
[2025-06-19 14:40:59,676] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 14:40:59,700] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 14:40:59,700] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 14:40:59,710] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 14:40:59,711] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 14:40:59,712] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 14:40:59,713] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 14:40:59,723] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:41:00,878] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:41:00,894] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 14:41:00,897] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:41:00,897] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 14:41:00,897] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 14:41:00,897] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 14:41:00,906] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 14:41:00,906] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 14:41:00,907] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 14:41:00,907] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 14:41:00,908] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:41:00,908] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:41:00,909] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:41:00,909] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 14:41:00,909] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:41:00,910] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:41:00,910] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:41:00,911] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 14953 characters
[2025-06-19 14:41:00,911] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:41:00,911] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:41:00,919] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:41:01,960] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:41:01,975] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 14:41:01,979] INFO utils.services.queue_service Successfully processed queue item a01bbd1c-b767-4db4-9579-6fd120eb1907
[2025-06-19 14:41:01,983] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 14:52:44,313] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:52:44,314] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:52:44,314] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:52:44,315] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 14:52:44,316] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 14:52:44,319] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 14:52:44,321] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 14:52:44,493] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4823268287186988978
[2025-06-19 14:52:44,797] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:52:44,798] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:52:44,798] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:52:44,800] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 14:52:45,164] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:52:45,175] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:52:45,175] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:52:45,175] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 14:52:48,529] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:52:48,529] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['2'], 'page_size': ['20']}>
[2025-06-19 14:52:48,545] INFO exam_sessions_subjects_products.views Pagination: page=2, page_size=20
[2025-06-19 14:52:48,546] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 14:52:48,546] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 14:52:48,548] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 14:52:48,552] INFO exam_sessions_subjects_products.views Pagination: total=393, start=20, end=40, page_size=20
[2025-06-19 14:52:48,664] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-1764817397745677797
[2025-06-19 14:52:55,300] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:52:55,303] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,305] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:52:55,305] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:52:55,305] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 10.0, 'total_vat': 2.0, 'total_gross': 12.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 145, 'product_name': 'Mini ASET (September 2024 Paper)', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:52:55,313] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:52:55,322] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,324] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:52:55,327] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:52:55,328] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:52:55,329] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:52:55,329] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:52:55,329] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:52:55,329] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,330] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,330] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 10.0, 'total_vat': 2.0, 'total_gross': 12.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 145, 'product_name': 'Mini ASET (September 2024 Paper)', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:52:55,330] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,331] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:52:55,332] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:52:55,334] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:52:55,335] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:52:55,336] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:52:55,338] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:52:55,339] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 10.0, 'total_vat': 2.0, 'total_gross': 12.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 145, 'product_name': 'Mini ASET (September 2024 Paper)', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:52:55,340] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 10.0, 'total_vat': 2.0, 'total_gross': 12.0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 145, 'product_name': 'Mini ASET (September 2024 Paper)', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:52:55,341] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:52:55,344] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:52:55,346] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:52:55,348] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:52:55,353] INFO rules_engine.custom_functions DEBUG: product_id: 90, subject_code: CB2
[2025-06-19 14:52:55,355] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,356] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:52:55,359] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:52:55,359] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:52:55,360] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:52:55,360] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:52:55,360] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:52:55,360] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:52:55,361] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:52:55,361] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:52:55,361] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,361] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:52:55,363] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:52:55,364] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:52:55,364] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:52:55,366] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:52:55,367] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:52:55,369] INFO rules_engine.custom_functions DEBUG: product_id: 90, subject_code: CB2
[2025-06-19 14:52:55,369] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:52:55,370] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:52:55,371] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:52:55,372] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:52:55,372] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:52:55,374] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:52:55,374] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 145, 'product_id': 90, 'subject_code': 'CB2', 'product_name': 'Mini ASET (September 2024 Paper)', 'product_code': 'MAS', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:52:55,376] INFO rules_engine.custom_functions DEBUG: product_id: 90, subject_code: CB2
[2025-06-19 14:52:55,377] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:52:55,377] INFO rules_engine.custom_functions DEBUG: product_id: 90, subject_code: CB2
[2025-06-19 14:52:55,377] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:52:55,382] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:52:55,382] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:52:55,383] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:52:55,386] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:52:55,387] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:53:02,299] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:53:02,299] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 14:53:02,299] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 14:53:02,299] INFO utils.services.queue_service Queued email 77a20f38-2067-4086-8a08-97a71a78e892 for 2 recipients
[2025-06-19 14:53:02,299] INFO utils.email_service Email queued successfully: 77a20f38-2067-4086-8a08-97a71a78e892
[2025-06-19 14:53:02,299] INFO cart.views Order confirmation email queued successfully for order ORD-000030 to eugenelo4@bpp.com
[2025-06-19 14:53:11,555] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:53:11,556] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 14:53:11,556] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 14:53:11,557] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 14:53:11,557] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 14:53:11,557] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 14:53:11,558] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 14:53:11,558] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 14:53:11,559] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:53:11,559] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:53:11,560] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:53:11,569] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 14:53:11,569] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:53:11,569] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:53:11,569] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:53:11,569] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15133 characters
[2025-06-19 14:53:11,569] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:53:11,581] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:53:11,748] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 221, 10)
[2025-06-19 14:53:11,748] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 14:53:11,748] ERROR CSSUTILS No content to parse.
[2025-06-19 14:53:11,748] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 14:53:11,798] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 14:53:11,799] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 14:53:11,800] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 14:53:11,800] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 14:53:11,800] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 14:53:11,800] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 14:53:11,813] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:53:12,932] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:53:12,947] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 14:53:12,950] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:53:12,950] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 14:53:12,950] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 14:53:12,950] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 14:53:12,961] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 14:53:12,961] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 14:53:12,961] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 14:53:12,962] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 14:53:12,962] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:53:12,962] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:53:12,963] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:53:12,963] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 14:53:12,963] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:53:12,965] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:53:12,965] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:53:12,965] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15132 characters
[2025-06-19 14:53:12,965] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:53:12,965] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:53:12,977] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:53:14,194] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:53:14,198] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 14:53:14,208] INFO utils.services.queue_service Successfully processed queue item 77a20f38-2067-4086-8a08-97a71a78e892
[2025-06-19 14:53:14,211] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 14:53:44,222] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:54:14,228] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:54:44,238] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:55:14,243] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:55:44,246] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:56:14,255] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:56:44,260] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:57:14,265] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:57:44,270] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:58:14,272] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:58:44,276] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 14:58:59,636] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:58:59,636] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:58:59,637] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:58:59,637] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 14:58:59,637] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 14:58:59,639] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 14:58:59,641] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 14:58:59,712] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4823268287186988978
[2025-06-19 14:58:59,799] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:58:59,799] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:58:59,799] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:58:59,800] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 14:59:00,001] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 14:59:00,002] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 14:59:00,003] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 14:59:00,003] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 14:59:07,446] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:59:07,468] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,469] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:59:07,469] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:59:07,470] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 146, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:59:07,476] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:59:07,487] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:59:07,488] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:59:07,489] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 146, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:59:07,489] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:59:07,490] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:59:07,491] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:59:07,504] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:59:07,505] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:59:07,506] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,509] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:59:07,509] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:59:07,509] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:59:07,509] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:59:07,514] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:59:07,514] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:59:07,516] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:59:07,516] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:59:07,530] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:59:07,530] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,530] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:59:07,537] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:59:07,539] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 146, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:59:07,563] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:59:07,564] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:59:07,564] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,564] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:59:07,564] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:59:07,566] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:59:07,566] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:59:07,566] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:59:07,567] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:59:07,567] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:59:07,567] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:59:07,576] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 14:59:07,576] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,577] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 14:59:07,578] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 14:59:07,578] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 146, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 14:59:07,587] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 14:59:07,587] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 14:59:07,588] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 14:59:07,588] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 14:59:07,589] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 14:59:07,589] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 14:59:07,589] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 146, 'product_id': 71, 'subject_code': 'CB2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 14:59:07,589] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB2
[2025-06-19 14:59:07,589] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 14:59:07,590] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 14:59:07,590] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 14:59:13,838] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:59:13,842] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 14:59:13,842] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 14:59:13,842] INFO utils.services.queue_service Queued email 0df4de9f-27bd-4db2-9052-d5705c423b8c for 2 recipients
[2025-06-19 14:59:13,842] INFO utils.email_service Email queued successfully: 0df4de9f-27bd-4db2-9052-d5705c423b8c
[2025-06-19 14:59:13,842] INFO cart.views Order confirmation email queued successfully for order ORD-000031 to eugenelo4@bpp.com
[2025-06-19 14:59:14,291] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:59:14,292] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 14:59:14,292] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 14:59:14,292] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 14:59:14,293] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 14:59:14,293] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 14:59:14,293] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 14:59:14,294] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 14:59:14,294] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:59:14,294] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:59:14,295] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:59:14,295] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 14:59:14,295] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:59:14,296] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:59:14,296] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:59:14,297] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15133 characters
[2025-06-19 14:59:14,297] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:59:14,298] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:59:14,309] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:59:15,386] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:59:15,389] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 14:59:15,396] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 14:59:15,396] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 14:59:15,396] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 14:59:15,397] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 14:59:15,397] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 14:59:15,397] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 14:59:15,397] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 14:59:15,398] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 14:59:15,398] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:59:15,398] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 14:59:15,399] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 14:59:15,399] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 14:59:15,400] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 14:59:15,400] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 14:59:15,400] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 14:59:15,401] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15132 characters
[2025-06-19 14:59:15,401] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:59:15,402] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 14:59:15,422] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 14:59:16,420] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 14:59:16,427] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 14:59:16,430] INFO utils.services.queue_service Successfully processed queue item 0df4de9f-27bd-4db2-9052-d5705c423b8c
[2025-06-19 14:59:16,432] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 14:59:46,438] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:00:16,444] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:00:46,445] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:01:16,453] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:01:46,457] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:02:16,463] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:02:46,465] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:03:16,473] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:03:46,475] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:04:16,484] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:04:46,488] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:05:16,495] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:05:46,496] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:06:04,904] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 15:06:04,905] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 15:06:04,905] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 15:06:04,919] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 15:06:04,922] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 15:06:04,924] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 15:06:05,133] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 15:06:07,661] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:06:07,661] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:06:07,661] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:06:07,672] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 15:06:07,673] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 15:06:07,676] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 15:06:07,679] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 15:06:07,756] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:06:07,757] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 15:06:07,757] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 15:06:07,759] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 15:06:07,759] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 15:06:07,764] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 15:06:07,776] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-19 15:06:07,878] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4823268287186988978
[2025-06-19 15:06:08,149] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_-7292133920973586192
[2025-06-19 15:06:08,206] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:06:08,206] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:06:08,208] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:06:08,209] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:06:08,418] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:06:08,419] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 15:06:08,419] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 15:06:08,422] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:06:08,575] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:06:08,576] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:06:08,577] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:06:08,580] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:06:11,277] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:06:11,277] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['2'], 'page_size': ['20']}>
[2025-06-19 15:06:11,277] INFO exam_sessions_subjects_products.views Pagination: page=2, page_size=20
[2025-06-19 15:06:11,277] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 15:06:11,289] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 15:06:11,290] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 15:06:11,290] INFO exam_sessions_subjects_products.views Pagination: total=393, start=20, end=40, page_size=20
[2025-06-19 15:06:11,374] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-1764817397745677797
[2025-06-19 15:06:16,505] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:06:22,812] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:06:22,812] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 15:06:22,812] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:06:22,812] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:06:22,822] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 15:06:22,832] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 15:06:22,840] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:06:22,843] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 148, 'product_id': 71, 'subject_code': 'CM1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:06:22,843] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:06:22,846] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:06:22,846] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:06:22,849] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:06:22,850] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 15:06:22,850] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:06:22,851] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 15:06:22,851] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:06:22,852] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 148, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:06:22,853] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:06:22,853] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:06:22,854] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:06:22,856] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 15:06:22,858] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:06:22,858] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:06:22,861] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:06:22,864] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 148, 'product_id': 71, 'subject_code': 'CM1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:06:22,865] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:06:22,865] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 15:06:22,866] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:06:22,866] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:06:22,866] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:06:22,867] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:06:22,868] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:06:22,869] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 148, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:06:22,871] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 148, 'product_id': 71, 'subject_code': 'CM1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:06:22,871] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:06:22,874] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:06:22,876] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:06:22,877] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:06:22,879] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 15:06:22,880] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:06:22,882] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:06:22,883] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 148, 'product_id': 71, 'subject_code': 'CM1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:06:22,883] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:06:22,884] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:06:22,884] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CM1
[2025-06-19 15:06:22,885] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:06:22,885] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:06:22,885] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:06:22,886] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:06:22,886] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 148, 'product_id': 71, 'subject_code': 'CM1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:06:22,887] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:06:22,888] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:06:22,888] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:06:22,890] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:06:22,890] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:06:22,891] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:06:22,895] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:06:22,896] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 148, 'product_id': 71, 'subject_code': 'CM1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:06:22,898] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CM1
[2025-06-19 15:06:22,901] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:06:22,903] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:06:22,903] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:06:32,624] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:06:32,642] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 15:06:32,642] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 15:06:32,644] INFO utils.services.queue_service Queued email e8b226dd-9225-49ee-be78-c4b067c2f8ae for 2 recipients
[2025-06-19 15:06:32,645] INFO utils.email_service Email queued successfully: e8b226dd-9225-49ee-be78-c4b067c2f8ae
[2025-06-19 15:06:32,646] INFO cart.views Order confirmation email queued successfully for order ORD-000032 to eugenelo4@bpp.com
[2025-06-19 15:06:46,561] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:06:46,562] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:06:46,563] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:06:46,564] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:06:46,565] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:06:46,566] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:06:46,567] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:06:46,569] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:06:46,571] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:06:46,572] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:06:46,573] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:06:46,580] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 15:06:46,587] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:06:46,594] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:06:46,605] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:06:46,611] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15133 characters
[2025-06-19 15:06:46,623] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:06:46,696] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:06:46,884] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:06:48,222] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:06:48,246] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 15:06:48,265] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:06:48,266] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:06:48,267] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:06:48,268] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:06:48,268] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:06:48,269] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:06:48,269] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:06:48,272] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:06:48,272] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:06:48,274] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:06:48,276] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:06:48,278] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 4729 characters
[2025-06-19 15:06:48,279] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:06:48,279] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:06:48,281] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:06:48,282] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15132 characters
[2025-06-19 15:06:48,283] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:06:48,287] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:06:48,403] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:06:50,184] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:06:50,191] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 15:06:50,197] INFO utils.services.queue_service Successfully processed queue item e8b226dd-9225-49ee-be78-c4b067c2f8ae
[2025-06-19 15:06:50,200] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 15:07:20,209] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:07:50,218] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:08:20,223] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:08:50,231] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:09:20,238] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:09:50,245] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:10:20,250] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:10:50,255] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:11:20,258] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:11:50,269] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:12:20,275] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:12:50,284] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:13:20,288] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:13:50,299] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:14:20,300] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:14:50,309] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:15:20,313] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:15:50,321] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:16:20,328] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:16:50,336] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:17:20,342] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:17:50,349] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:18:20,355] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:18:50,358] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:19:20,361] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:19:50,370] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:20:20,374] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:20:50,377] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:21:20,388] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:21:50,393] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:22:20,396] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:22:50,398] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:23:20,404] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:23:50,409] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:24:20,414] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:24:50,420] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:25:20,425] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:25:50,428] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:26:20,436] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:26:50,441] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:27:20,445] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:27:50,452] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:28:20,457] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:28:50,461] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:29:20,465] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:29:40,149] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 15:29:41,208] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 15:29:48,892] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:29:48,893] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:29:48,893] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:29:48,917] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 6272 characters
[2025-06-19 15:29:48,917] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:29:48,917] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:29:48,917] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:29:48,925] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16801 characters
[2025-06-19 15:29:50,471] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:30:08,589] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:30:08,589] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:30:08,590] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:30:08,590] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 15:30:08,591] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 15:30:08,592] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 15:30:08,595] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 15:30:08,675] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_4716337822329300706
[2025-06-19 15:30:08,759] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:30:08,759] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:30:08,760] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:30:08,760] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:30:08,835] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:30:08,836] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:30:08,836] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:30:08,837] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:30:15,428] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:30:15,435] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:30:15,435] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:30:15,435] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,435] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,435] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,437] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:30:15,437] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:30:15,438] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:30:15,439] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:30:15,440] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:30:15,441] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:30:15,441] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 149, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:30:15,441] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 149, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:30:15,442] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 149, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:30:15,445] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:30:15,451] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,454] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:30:15,456] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:30:15,457] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 149, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:30:15,459] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:30:15,459] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:30:15,460] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:30:15,461] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:30:15,461] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:30:15,462] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,462] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:30:15,463] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,465] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:30:15,466] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,467] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:30:15,468] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:30:15,471] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:30:15,471] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:30:15,471] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:30:15,471] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:30:15,473] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:30:15,473] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:30:15,473] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:30:15,473] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:30:15,473] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:30:15,474] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:30:15,474] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:30:15,474] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 15:30:15,474] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:30:15,475] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:30:15,475] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 15:30:15,475] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:30:15,475] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:30:15,476] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 149, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:30:15,477] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:30:15,477] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:30:15,480] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 15:30:15,481] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:30:15,485] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:30:15,488] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:30:15,490] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:30:20,477] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:30:22,262] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:30:22,262] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 15:30:22,262] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 15:30:22,280] INFO utils.services.queue_service Queued email 711ff65f-4d33-4ae8-ba43-8779a112035b for 2 recipients
[2025-06-19 15:30:22,281] INFO utils.email_service Email queued successfully: 711ff65f-4d33-4ae8-ba43-8779a112035b
[2025-06-19 15:30:22,281] INFO cart.views Order confirmation email queued successfully for order ORD-000033 to eugenelo4@bpp.com
[2025-06-19 15:30:50,498] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:30:50,499] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:30:50,500] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:30:50,500] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:30:50,500] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:30:50,501] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:30:50,501] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:30:50,502] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:30:50,502] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:30:50,502] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:30:50,503] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:30:50,504] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5573 characters
[2025-06-19 15:30:50,504] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:30:50,504] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:30:50,505] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:30:50,506] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15977 characters
[2025-06-19 15:30:50,506] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:30:50,508] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:30:50,522] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 15:30:50,522] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 15:30:50,523] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 15:30:50,525] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 15:30:50,526] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 15:30:50,527] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 15:30:50,528] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:30:51,795] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:30:51,810] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 15:30:51,825] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:30:51,825] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:30:51,828] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:30:51,828] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:30:51,829] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:30:51,830] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:30:51,830] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:30:51,832] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:30:51,833] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:30:51,833] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:30:51,835] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:30:51,837] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5573 characters
[2025-06-19 15:30:51,837] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:30:51,838] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:30:51,839] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:30:51,840] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15976 characters
[2025-06-19 15:30:51,841] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:30:51,842] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:30:51,858] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:30:52,847] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:30:52,867] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 15:30:52,868] INFO utils.services.queue_service Successfully processed queue item 711ff65f-4d33-4ae8-ba43-8779a112035b
[2025-06-19 15:30:52,875] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 15:31:22,880] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:31:52,887] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:32:22,893] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:32:52,898] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:33:22,910] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:33:52,919] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:33:55,000] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:33:55,000] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:33:55,000] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:33:55,028] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 6272 characters
[2025-06-19 15:33:55,028] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:33:55,028] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:33:55,028] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:33:55,033] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16801 characters
[2025-06-19 15:34:22,922] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:34:52,931] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:35:22,932] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:35:52,942] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:36:22,944] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:36:52,952] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:37:22,957] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:37:52,959] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:38:22,966] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:38:52,974] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:39:22,979] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:39:52,984] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:40:22,995] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:40:53,003] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:41:23,007] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:41:39,538] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:41:39,538] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:41:39,538] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:41:39,543] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 15:41:39,543] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 15:41:39,544] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 15:41:39,550] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 15:41:39,712] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_4716337822329300706
[2025-06-19 15:41:40,078] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:41:40,078] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:41:40,078] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:41:40,078] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:41:40,424] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:41:40,427] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:41:40,427] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:41:40,429] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 150, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:41:48,410] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 150, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:41:48,421] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:41:48,422] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 150, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:41:48,425] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,429] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:41:48,430] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:41:48,432] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 150, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:41:48,434] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:41:48,436] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:41:48,437] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:41:48,437] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,438] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:41:48,438] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:41:48,441] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:41:48,441] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:41:48,443] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,443] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:41:48,444] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,445] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:41:48,445] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:41:48,446] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:41:48,446] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:41:48,446] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:41:48,446] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:41:48,446] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:41:48,447] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:41:48,447] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 15:41:48,447] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:41:48,447] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-19 15:41:48,448] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:41:48,448] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:41:48,448] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:41:48,448] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-19 15:41:48,448] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:41:48,449] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:41:48,449] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-19 15:41:48,449] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 15:41:48,449] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-19 15:41:48,450] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:41:48,450] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-19 15:41:48,450] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:41:48,450] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-19 15:41:48,450] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 150, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:41:48,450] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 15:41:48,451] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:41:48,451] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 15:41:48,451] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-19 15:41:48,451] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:41:48,452] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:41:48,453] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-19 15:41:48,453] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:41:48,453] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:41:48,453] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-19 15:41:48,461] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:41:48,463] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:41:53,014] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:41:55,090] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:41:55,090] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 15:41:55,090] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 15:41:55,090] INFO utils.services.queue_service Queued email 48a24af4-47ba-4765-b5ae-e3b8b1dbfa24 for 2 recipients
[2025-06-19 15:41:55,090] INFO utils.email_service Email queued successfully: 48a24af4-47ba-4765-b5ae-e3b8b1dbfa24
[2025-06-19 15:41:55,090] INFO cart.views Order confirmation email queued successfully for order ORD-000034 to eugenelo4@bpp.com
[2025-06-19 15:42:23,032] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:42:23,033] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:42:23,033] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:42:23,033] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:42:23,033] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:42:23,033] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:42:23,033] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:42:23,033] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:42:23,033] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:42:23,033] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:42:23,040] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:42:23,042] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5562 characters
[2025-06-19 15:42:23,043] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:42:23,043] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:42:23,044] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:42:23,044] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15966 characters
[2025-06-19 15:42:23,045] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:42:23,046] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:42:23,065] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:42:24,126] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:42:24,135] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 15:42:24,144] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:42:24,145] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:42:24,146] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:42:24,147] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:42:24,147] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:42:24,148] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:42:24,148] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:42:24,150] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:42:24,151] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:42:24,151] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:42:24,151] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:42:24,152] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5562 characters
[2025-06-19 15:42:24,153] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:42:24,153] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:42:24,154] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:42:24,154] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 15965 characters
[2025-06-19 15:42:24,155] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:42:24,155] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:42:24,172] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:42:25,241] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:42:25,245] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 15:42:25,245] INFO utils.services.queue_service Successfully processed queue item 48a24af4-47ba-4765-b5ae-e3b8b1dbfa24
[2025-06-19 15:42:25,250] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 15:42:55,256] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:43:25,262] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:43:55,268] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:44:25,279] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:44:55,282] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:45:25,300] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:45:48,124] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 15:45:51,783] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 15:45:55,312] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:46:25,334] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:46:46,317] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:46:46,317] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:46:46,317] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:46:46,352] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5773 characters
[2025-06-19 15:46:46,352] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:46:46,352] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:46:46,352] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:46:46,374] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16304 characters
[2025-06-19 15:46:55,346] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:47:09,085] INFO utils.email_service Development mode: Redirecting email from ['test.final@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:47:09,310] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 15:47:09,311] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 15:47:09,318] INFO utils.services.queue_service Queued email 341e2823-d811-49fe-945a-6b673a5d4694 for 2 recipients
[2025-06-19 15:47:09,331] INFO utils.email_service Email queued successfully: 341e2823-d811-49fe-945a-6b673a5d4694
[2025-06-19 15:47:20,478] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:47:20,478] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:47:20,478] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:47:20,478] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:47:20,478] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:47:20,478] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:47:20,478] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:47:20,478] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:47:20,478] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:47:20,478] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:47:20,478] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:47:20,515] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5773 characters
[2025-06-19 15:47:20,515] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:47:20,516] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:47:20,516] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:47:20,526] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16315 characters
[2025-06-19 15:47:20,527] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:47:20,530] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:47:20,801] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 230, 10)
[2025-06-19 15:47:20,801] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 15:47:20,809] ERROR CSSUTILS No content to parse.
[2025-06-19 15:47:20,810] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 15:47:20,898] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,899] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,899] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 15:47:20,902] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,904] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,907] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 15:47:20,910] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,911] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,911] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 15:47:20,914] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,915] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 15:47:20,915] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 15:47:20,933] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:47:22,069] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:47:22,097] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 15:47:22,110] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:47:22,110] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:47:22,110] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:47:22,111] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:47:22,111] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:47:22,111] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:47:22,113] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:47:22,113] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:47:22,114] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:47:22,114] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:47:22,115] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:47:22,115] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5773 characters
[2025-06-19 15:47:22,115] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:47:22,117] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:47:22,117] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:47:22,118] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16309 characters
[2025-06-19 15:47:22,118] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:47:22,120] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:47:22,142] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:47:23,225] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:47:23,246] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 15:47:23,249] INFO utils.services.queue_service Successfully processed queue item 341e2823-d811-49fe-945a-6b673a5d4694
[2025-06-19 15:47:23,252] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 15:47:25,542] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:47:55,603] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:48:25,605] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:48:55,624] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:49:25,634] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:49:55,638] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:50:25,645] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:50:55,652] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:51:25,656] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:51:55,658] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:52:25,661] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:52:55,667] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:53:25,672] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:53:55,679] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:54:25,686] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:54:55,692] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:55:25,697] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:55:55,699] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:56:25,706] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:56:47,241] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:56:47,242] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:56:47,242] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:56:47,243] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 15:56:47,245] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 15:56:47,249] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 15:56:47,254] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 15:56:47,380] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1387803080005360062
[2025-06-19 15:56:47,690] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:56:47,691] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:56:47,691] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:56:47,693] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:56:47,908] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 15:56:47,911] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 15:56:47,912] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 15:56:47,913] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 15:56:55,709] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:56:56,530] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:56:56,530] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,530] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:56:56,530] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:56:56,548] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 298.0, 'total_vat': 59.6, 'total_gross': 357.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 151, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 152, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:56:56,554] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:56:56,555] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,556] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:56:56,557] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:56:56,562] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,563] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 15:56:56,563] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:56:56,563] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:56:56,565] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:56:56,565] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,565] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 298.0, 'total_vat': 59.6, 'total_gross': 357.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 151, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 152, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:56:56,565] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:56:56,566] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:56:56,567] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 15:56:56,568] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,569] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 298.0, 'total_vat': 59.6, 'total_gross': 357.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 151, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 152, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:56:56,569] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 15:56:56,570] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:56:56,571] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 298.0, 'total_vat': 59.6, 'total_gross': 357.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 151, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 152, 'product_name': 'Combined Materials Pack', 'net_amount': 149.0, 'vat_amount': 29.8, 'gross_amount': 178.8, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 15:56:56,572] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:56:56,575] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:56:56,578] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:56:56,580] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:56:56,581] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:56:56,583] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,583] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:56:56,583] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,584] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 15:56:56,584] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:56:56,585] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 15:56:56,585] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:56:56,585] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,585] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,585] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 15:56:56,586] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:56:56,586] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:56:56,586] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:56:56,586] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 15:56:56,587] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:56:56,587] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:56:56,587] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:56:56,587] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 15:56:56,588] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:56:56,588] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:56:56,588] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:56:56,588] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 15:56:56,588] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,589] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:56:56,590] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 15:56:56,590] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 15:56:56,590] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,591] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 151, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 15:56:56,591] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,591] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 15:56:56,593] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,593] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:56:56,594] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,594] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 152, 'product_id': 74, 'subject_code': 'CB1', 'product_name': 'Combined Materials Pack', 'product_code': 'C', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '149.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 15:56:56,596] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:56:56,596] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:56:56,597] INFO rules_engine.custom_functions DEBUG: product_id: 74, subject_code: CB1
[2025-06-19 15:56:56,599] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:56:56,599] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:56:56,600] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 15:56:56,601] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:56:56,602] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 15:56:56,605] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 15:57:03,377] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:57:03,377] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 15:57:03,377] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 15:57:03,390] INFO utils.services.queue_service Queued email 0a7718ce-1123-47c2-a4ee-b30a0f00980d for 2 recipients
[2025-06-19 15:57:03,390] INFO utils.email_service Email queued successfully: 0a7718ce-1123-47c2-a4ee-b30a0f00980d
[2025-06-19 15:57:03,390] INFO cart.views Order confirmation email queued successfully for order ORD-000035 to eugenelo4@bpp.com
[2025-06-19 15:57:25,729] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:57:25,729] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:57:25,729] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:57:25,731] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:57:25,731] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:57:25,731] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:57:25,731] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:57:25,732] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:57:25,734] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:57:25,735] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:57:25,735] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:57:25,736] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 6417 characters
[2025-06-19 15:57:25,737] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:57:25,737] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:57:25,737] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:57:25,738] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16821 characters
[2025-06-19 15:57:25,738] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:57:25,739] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:57:25,757] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:57:26,934] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:57:26,938] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 15:57:26,943] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 15:57:26,943] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 15:57:26,943] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 15:57:26,943] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 15:57:26,945] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 15:57:26,945] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 15:57:26,946] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 15:57:26,947] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 15:57:26,947] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:57:26,947] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 15:57:26,947] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 15:57:26,947] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 6417 characters
[2025-06-19 15:57:26,951] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 15:57:26,951] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 15:57:26,952] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 15:57:26,952] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16820 characters
[2025-06-19 15:57:26,953] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:57:26,954] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 15:57:26,971] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 15:57:28,156] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 15:57:28,158] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 15:57:28,160] INFO utils.services.queue_service Successfully processed queue item 0a7718ce-1123-47c2-a4ee-b30a0f00980d
[2025-06-19 15:57:28,163] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 15:57:58,169] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 15:58:28,172] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-19 16:09:31,144] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:10:14,325] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 16:10:14,325] WARNING django.request Unauthorized: /api/users/12/
[2025-06-19 16:10:14,325] WARNING django.request Unauthorized: /api/cart/
[2025-06-19 16:10:14,325] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 16:10:14,325] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 16:10:14,335] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 16:10:14,337] WARNING django.request Unauthorized: /api/users/12/
[2025-06-19 16:10:14,338] WARNING django.request Unauthorized: /api/cart/
[2025-06-19 16:10:14,339] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 16:10:14,341] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 16:11:22,086] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:11:22,089] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:11:22,090] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:11:22,094] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 16:11:22,094] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 16:11:22,109] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 16:11:22,111] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 16:11:22,232] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_671385201691121127
[2025-06-19 16:11:22,319] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:11:22,319] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:11:22,319] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:11:22,321] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:11:22,411] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:11:22,411] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:11:22,411] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:11:22,411] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:11:29,702] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:11:29,702] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:11:29,702] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:11:29,702] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 16:11:29,702] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 16:11:29,702] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 154, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:11:29,702] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:11:29,703] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:11:29,703] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:11:29,704] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:11:29,704] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:11:29,704] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:11:29,705] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 16:11:29,705] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 16:11:29,705] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 154, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:11:29,710] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 16:11:29,714] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 16:11:29,722] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:11:29,723] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:11:29,724] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:11:29,724] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:11:29,724] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 16:11:29,724] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:11:29,724] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:11:29,725] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:11:29,725] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 16:11:29,725] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 154, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:11:29,725] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:11:29,725] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:11:29,725] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:11:29,725] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:11:29,727] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:11:29,727] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:11:29,728] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:11:29,728] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:11:29,728] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:11:29,728] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:11:29,729] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:11:29,729] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 154, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:11:29,729] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:11:29,729] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:11:29,730] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 16:11:29,733] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:11:29,733] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:11:29,734] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:11:29,736] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:11:29,808] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:11:29,808] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 154, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:11:29,809] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:11:29,809] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:11:29,809] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 154, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:11:29,820] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:11:29,820] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:11:29,821] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 154, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:11:29,821] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:11:29,821] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:11:29,821] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:11:29,822] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 154, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:11:29,822] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 16:11:29,822] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:11:29,823] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:11:29,823] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:14:23,193] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:14:24,386] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:14:46,473] DEBUG utils.email_service DEBUG: send_order_confirmation called with user_email=test@example.com
[2025-06-19 16:14:46,474] DEBUG utils.email_service DEBUG: order_data keys: ['first_name', 'last_name', 'student_number', 'order_number', 'total_amount', 'created_at', 'subtotal', 'vat_amount', 'discount_amount', 'items', 'item_count', 'total_items', 'base_url']
[2025-06-19 16:14:46,474] DEBUG utils.email_service DEBUG: order_data['created_at']: 2025-06-19 15:14:46.211176+00:00
[2025-06-19 16:14:46,474] DEBUG utils.email_service DEBUG: order_data['total_amount']: 299.99
[2025-06-19 16:14:46,475] DEBUG utils.email_service DEBUG: order_obj created: {'created_at': datetime.datetime(2025, 6, 19, 15, 14, 46, 211176, tzinfo=datetime.timezone.utc), 'subtotal': 249.99, 'vat_amount': 50.0, 'discount_amount': 0}
[2025-06-19 16:14:46,475] DEBUG utils.email_service DEBUG: Final context order.created_at: 2025-06-19 15:14:46.211176+00:00
[2025-06-19 16:14:46,475] DEBUG utils.email_service DEBUG: Final context total_amount: 299.99
[2025-06-19 16:14:46,475] DEBUG utils.email_service DEBUG: Final context items count: 2
[2025-06-19 16:14:46,475] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:14:46,485] INFO utils.email_service MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-19 16:14:46,486] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:14:46,487] ERROR utils.email_service Failed to send HTML email to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']: emails/order_confirmation.html
[2025-06-19 16:15:08,445] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 16:16:01,394] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:16:02,507] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:16:09,183] DEBUG utils.email_service DEBUG: send_order_confirmation called with user_email=test@example.com
[2025-06-19 16:16:09,186] DEBUG utils.email_service DEBUG: order_data keys: ['first_name', 'last_name', 'student_number', 'order_number', 'total_amount', 'created_at', 'subtotal', 'vat_amount', 'discount_amount', 'items', 'item_count', 'total_items', 'base_url']
[2025-06-19 16:16:09,187] DEBUG utils.email_service DEBUG: order_data['created_at']: 2025-06-19 15:16:08.752406+00:00
[2025-06-19 16:16:09,187] DEBUG utils.email_service DEBUG: order_data['total_amount']: 299.99
[2025-06-19 16:16:09,187] DEBUG utils.email_service DEBUG: order_obj created: {'created_at': datetime.datetime(2025, 6, 19, 15, 16, 8, 752406, tzinfo=datetime.timezone.utc), 'subtotal': 249.99, 'vat_amount': 50.0, 'discount_amount': 0}
[2025-06-19 16:16:09,187] DEBUG utils.email_service DEBUG: Final context order.created_at: 2025-06-19 15:16:08.752406+00:00
[2025-06-19 16:16:09,187] DEBUG utils.email_service DEBUG: Final context total_amount: 299.99
[2025-06-19 16:16:09,187] DEBUG utils.email_service DEBUG: Final context items count: 2
[2025-06-19 16:16:09,187] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:16:09,198] INFO utils.email_service MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-19 16:16:09,199] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:16:09,202] ERROR utils.email_service Failed to send HTML email to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']: emails/order_confirmation.html
[2025-06-19 16:16:35,460] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:16:36,642] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:16:52,364] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:16:53,555] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:17:14,502] DEBUG utils.email_service DEBUG: send_order_confirmation called with user_email=test@example.com
[2025-06-19 16:17:14,502] DEBUG utils.email_service DEBUG: order_data keys: ['first_name', 'last_name', 'student_number', 'order_number', 'total_amount', 'created_at', 'subtotal', 'vat_amount', 'discount_amount', 'items', 'item_count', 'total_items', 'base_url']
[2025-06-19 16:17:14,503] DEBUG utils.email_service DEBUG: order_data['created_at']: 2025-06-19 15:17:14.182975+00:00
[2025-06-19 16:17:14,504] DEBUG utils.email_service DEBUG: order_data['total_amount']: 299.99
[2025-06-19 16:17:14,504] DEBUG utils.email_service DEBUG: order_obj created: {'created_at': datetime.datetime(2025, 6, 19, 15, 17, 14, 182975, tzinfo=datetime.timezone.utc), 'subtotal': 249.99, 'vat_amount': 50.0, 'discount_amount': 0}
[2025-06-19 16:17:14,505] DEBUG utils.email_service DEBUG: Final context order.created_at: 2025-06-19 15:17:14.182975+00:00
[2025-06-19 16:17:14,505] DEBUG utils.email_service DEBUG: Final context total_amount: 299.99
[2025-06-19 16:17:14,505] DEBUG utils.email_service DEBUG: Final context items count: 2
[2025-06-19 16:17:14,506] ERROR utils.email_service Order confirmation email failed for ORD-2024-001 to test@example.com: name 'template_name' is not defined
[2025-06-19 16:17:14,506] INFO utils.email_service Attempting master template fallback for order confirmation
[2025-06-19 16:17:14,506] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:17:14,506] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:17:14,508] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 16:17:14,540] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5836 characters
[2025-06-19 16:17:14,541] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 16:17:14,541] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 16:17:14,542] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 16:17:14,549] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16125 characters
[2025-06-19 16:17:14,549] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:17:14,551] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:17:14,833] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:17:14,833] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:17:14,833] ERROR CSSUTILS No content to parse.
[2025-06-19 16:17:14,833] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:17:14,915] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,915] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,915] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:17:14,915] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,915] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,927] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:17:14,930] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,932] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,933] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:17:14,936] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,938] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:17:14,938] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:17:14,957] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:17:16,154] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:17:46,356] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:17:47,509] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:18:05,066] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,066] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,067] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 16:18:05,084] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5812 characters
[2025-06-19 16:18:05,085] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 16:18:05,085] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 16:18:05,086] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 16:18:05,088] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16519 characters
[2025-06-19 16:18:05,090] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,090] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,091] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 16:18:05,091] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5812 characters
[2025-06-19 16:18:05,092] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 16:18:05,092] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 16:18:05,093] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 16:18:05,094] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16519 characters
[2025-06-19 16:18:05,095] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-19 16:18:05,095] ERROR utils.email_testing Failed to preview template order_confirmation: emails/order_confirmation.txt
[2025-06-19 16:18:05,095] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5812 characters
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 16:18:05,095] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16519 characters
[2025-06-19 16:18:05,095] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-19 16:18:05,109] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 16:18:05,116] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-19 16:18:05,121] DEBUG utils.email_service DEBUG: Rendering content template: emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,121] DEBUG utils.email_service DEBUG: Content template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/order_confirmation_content.mjml
[2025-06-19 16:18:05,121] DEBUG utils.email_service DEBUG: Content template exists: True
[2025-06-19 16:18:05,122] DEBUG utils.email_service DEBUG: Content template rendered successfully, length: 5812 characters
[2025-06-19 16:18:05,122] DEBUG utils.email_service DEBUG: Rendering master template: emails/mjml/master_template.mjml
[2025-06-19 16:18:05,122] DEBUG utils.email_service DEBUG: Master template full path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails/mjml/master_template.mjml
[2025-06-19 16:18:05,123] DEBUG utils.email_service DEBUG: Master template exists: True
[2025-06-19 16:18:05,123] DEBUG utils.email_service DEBUG: Master template rendered successfully, final length: 16519 characters
[2025-06-19 16:18:05,292] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:18:05,292] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:18:05,292] ERROR CSSUTILS No content to parse.
[2025-06-19 16:18:05,295] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:18:05,352] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,352] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,353] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:18:05,354] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,354] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,355] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:18:05,355] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,356] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,356] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:18:05,358] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,358] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:18:05,358] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:18:05,371] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:18:05,372] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-19 16:19:44,329] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:19:45,392] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:20:13,144] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:20:14,185] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:20:42,977] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:20:44,259] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:21:09,844] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:21:10,775] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:21:31,049] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:21:32,003] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:21:47,299] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:21:47,306] INFO utils.email_service MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-19 16:21:47,306] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:21:47,307] ERROR utils.email_service Failed to send HTML email to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']: emails/order_confirmation.html
[2025-06-19 16:24:57,561] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:24:57,568] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 16:24:57,568] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 16:24:57,586] INFO utils.services.queue_service Queued email 21e0359d-3e6d-40a8-abc5-a9b27f8c2992 for 2 recipients
[2025-06-19 16:24:57,586] INFO utils.email_service Email queued successfully: 21e0359d-3e6d-40a8-abc5-a9b27f8c2992
[2025-06-19 16:24:57,587] INFO cart.views Order confirmation email queued successfully for order ORD-000036 to eugenelo4@bpp.com
[2025-06-19 16:25:06,253] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:25:06,253] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:25:06,253] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:25:06,253] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 16:25:06,253] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 16:25:06,253] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 16:25:06,253] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 16:25:06,319] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_52650390823996525
[2025-06-19 16:25:06,413] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:25:06,414] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:25:06,414] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:25:06,415] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:25:06,486] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:25:06,486] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:25:06,486] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:25:06,487] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:26:30,055] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:26:30,056] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:26:30,056] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:26:30,056] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:26:30,056] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:26:30,056] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:26:30,057] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:26:30,059] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:26:30,073] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:26:30,075] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:26:30,201] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:26:30,201] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:26:30,217] ERROR CSSUTILS No content to parse.
[2025-06-19 16:26:30,218] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:26:30,253] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,254] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,255] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:26:30,257] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,259] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,259] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:26:30,262] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,262] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,262] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:26:30,262] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,262] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:26:30,262] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:26:30,277] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:26:31,286] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:26:31,304] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 16:26:31,309] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:26:31,310] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:26:31,310] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:26:31,310] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:26:31,311] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:26:31,311] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:26:31,311] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:26:31,312] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:26:31,313] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:26:31,314] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:26:31,330] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:26:32,378] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:26:32,378] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 16:26:32,378] INFO utils.services.queue_service Successfully processed queue item 21e0359d-3e6d-40a8-abc5-a9b27f8c2992
[2025-06-19 16:26:32,392] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 155, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:32:45,455] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 155, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:32:45,473] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:32:45,473] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:32:45,473] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:32:45,473] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:32:45,475] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,475] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,475] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:32:45,476] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:32:45,476] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:32:45,476] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:32:45,476] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:32:45,476] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:32:45,477] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 16:32:45,477] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 16:32:45,478] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:32:45,478] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:32:45,478] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:32:45,478] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:32:45,479] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:32:45,479] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:32:45,479] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:32:45,479] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:32:45,606] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:32:45,606] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,606] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:32:45,606] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:32:45,606] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 155, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:32:45,621] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:32:45,623] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,624] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:32:45,624] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:32:45,625] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 155, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:32:45,626] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:32:45,627] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:32:45,628] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,628] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:32:45,629] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:32:45,630] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:32:45,630] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 16:32:45,631] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:32:45,631] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:32:45,631] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:32:45,631] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:32:45,632] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:32:45,632] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-19 16:32:45,632] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:32:45,632] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:32:45,634] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:32:45,635] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:32:45,635] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 155, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-19 16:32:45,636] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:32:45,638] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:32:45,639] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:32:45,639] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:32:53,386] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:32:53,386] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 16:32:53,386] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 16:32:53,403] INFO utils.services.queue_service Queued email e1be0ec8-a55f-47ff-b394-e21285a25694 for 2 recipients
[2025-06-19 16:32:53,403] INFO utils.email_service Email queued successfully: e1be0ec8-a55f-47ff-b394-e21285a25694
[2025-06-19 16:32:53,403] INFO cart.views Order confirmation email queued successfully for order ORD-000037 to eugenelo4@bpp.com
[2025-06-19 16:32:58,837] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:32:58,837] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:32:58,838] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:32:58,838] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:32:58,839] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:32:58,839] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:32:58,839] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:32:58,840] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:32:58,854] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:32:58,855] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:32:58,999] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:32:59,000] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:32:59,002] ERROR CSSUTILS No content to parse.
[2025-06-19 16:32:59,002] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:32:59,038] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,039] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,039] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:32:59,042] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,042] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,042] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:32:59,045] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,046] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,046] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:32:59,047] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,048] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:32:59,048] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:32:59,056] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:33:00,186] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:33:00,188] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 16:33:00,188] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:33:00,188] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:33:00,188] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:33:00,188] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:33:00,197] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:33:00,197] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:33:00,197] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:33:00,198] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:33:00,199] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:33:00,200] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:33:00,212] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:33:01,317] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:33:01,327] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 16:33:01,332] INFO utils.services.queue_service Successfully processed queue item e1be0ec8-a55f-47ff-b394-e21285a25694
[2025-06-19 16:33:01,334] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 16:33:05,598] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:33:05,598] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:33:05,599] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:33:05,599] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 16:33:05,600] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 16:33:05,602] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 16:33:05,604] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 16:33:05,719] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_52650390823996525
[2025-06-19 16:33:05,845] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:33:05,845] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:33:05,846] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:33:05,846] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:33:05,929] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:33:05,950] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:33:05,950] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:33:05,951] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:38:19,700] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-19 16:38:20,970] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:38:45,361] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:38:47,072] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:39:11,268] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:39:11,277] INFO utils.email_service MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-19 16:39:11,278] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:39:11,280] ERROR utils.email_service Failed to send HTML email to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']: emails/order_confirmation.html
[2025-06-19 16:39:30,735] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:39:30,741] INFO utils.email_service MJML template not found for order_confirmation: emails/mjml/order_confirmation.mjml, falling back to HTML
[2025-06-19 16:39:30,742] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:39:30,745] ERROR utils.email_service Failed to send HTML email to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']: emails/order_confirmation.html
[2025-06-19 16:41:00,896] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-19 16:41:01,989] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-19 16:41:23,127] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:41:23,127] INFO utils.email_service Using master template for core email type: order_confirmation
[2025-06-19 16:41:23,127] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-19 16:41:23,146] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:41:23,148] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:41:23,300] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:41:23,300] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:41:23,301] ERROR CSSUTILS No content to parse.
[2025-06-19 16:41:23,301] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:41:23,355] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,355] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,360] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:23,361] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,362] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,362] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:23,364] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,365] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,365] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:23,367] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,368] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:23,368] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:23,376] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:41:24,483] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:41:36,154] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-19 16:41:36,156] ERROR utils.email_testing Failed to preview template order_confirmation: emails/order_confirmation.txt
[2025-06-19 16:41:36,157] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-19 16:41:36,165] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-19 16:41:36,167] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 16:41:36,169] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-19 16:41:36,543] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:41:36,543] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:41:36,543] ERROR CSSUTILS No content to parse.
[2025-06-19 16:41:36,543] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:41:36,708] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,708] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,709] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:36,715] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,715] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,715] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:36,715] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,715] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,715] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:36,729] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,732] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:41:36,732] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:41:36,753] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:41:36,755] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-19 16:43:49,667] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_html.html
[2025-06-19 16:43:49,668] ERROR utils.email_testing Failed to preview template order_confirmation: emails/order_confirmation.txt
[2025-06-19 16:43:49,669] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_text.txt
[2025-06-19 16:43:49,671] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_inlined.html
[2025-06-19 16:43:49,672] ERROR utils.email_testing Failed to preview template order_confirmation: emails/mjml/order_confirmation.mjml
[2025-06-19 16:43:49,673] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_mjml.mjml
[2025-06-19 16:43:49,840] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:43:49,840] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:43:49,842] ERROR CSSUTILS No content to parse.
[2025-06-19 16:43:49,842] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:43:49,907] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,907] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,908] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:43:49,908] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,910] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,910] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:43:49,914] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,915] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,916] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:43:49,918] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,918] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:43:49,919] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:43:49,926] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:43:49,928] INFO utils.email_testing Saved preview: ./email_previews/order_confirmation_outlook_enhanced.html
[2025-06-19 16:45:08,012] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:45:08,027] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,027] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:45:08,028] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:45:08,028] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 156, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:45:08,030] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:45:08,030] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:45:08,030] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,030] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:45:08,039] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:45:08,039] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:45:08,040] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:45:08,040] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:45:08,040] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:45:08,040] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:45:08,040] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:45:08,163] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:45:08,163] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,163] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:45:08,163] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:45:08,163] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 156, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:45:08,185] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:45:08,186] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:45:08,186] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,187] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:45:08,187] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:45:08,187] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:45:08,188] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:45:08,188] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:45:08,189] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:45:08,190] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:45:08,190] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:45:08,197] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:45:08,197] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,197] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:45:08,197] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:45:08,197] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 156, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:45:08,232] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:45:08,235] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:45:08,239] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,245] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:45:08,268] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:45:08,268] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:45:08,269] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:45:08,317] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:45:08,321] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:45:08,322] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:45:08,322] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:45:08,713] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:45:08,713] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,715] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:45:08,715] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:45:08,716] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 156, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:45:08,727] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:45:08,727] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:45:08,728] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:08,729] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:45:08,729] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:45:08,730] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:45:08,730] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:45:08,731] INFO rules_engine.custom_functions DEBUG: product_id: 75, subject_code: CB1
[2025-06-19 16:45:08,731] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:45:08,732] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:45:08,732] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:45:17,338] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:45:17,338] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 156, 'product_id': 75, 'subject_code': 'CB1', 'product_name': 'Core Reading', 'product_code': 'CR', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '22.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:45:17,339] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:45:17,339] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:45:17,339] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 22.0, 'total_vat': 4.4, 'total_gross': 26.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 156, 'product_name': 'Core Reading', 'net_amount': 22.0, 'vat_amount': 4.4, 'gross_amount': 26.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:45:17,352] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:45:17,358] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 16:45:17,358] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 16:45:17,362] INFO utils.services.queue_service Queued email 854233d3-93e4-45de-b54e-b80e5a5167d1 for 2 recipients
[2025-06-19 16:45:17,363] INFO utils.email_service Email queued successfully: 854233d3-93e4-45de-b54e-b80e5a5167d1
[2025-06-19 16:45:17,363] INFO cart.views Order confirmation email queued successfully for order ORD-000038 to eugenelo4@bpp.com
[2025-06-19 16:45:24,558] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:45:24,560] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:45:24,560] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:45:24,561] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:45:24,561] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:45:24,561] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:45:24,561] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:45:24,563] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:45:24,592] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:45:24,600] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:45:24,908] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-19 16:45:24,910] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:45:24,912] ERROR CSSUTILS No content to parse.
[2025-06-19 16:45:24,913] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:45:24,999] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,015] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,016] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:45:25,020] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,020] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,021] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:45:25,024] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,025] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,025] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:45:25,029] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,030] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:45:25,030] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:45:25,045] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:45:26,161] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:45:26,172] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 16:45:26,183] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:45:26,183] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:45:26,184] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:45:26,184] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:45:26,184] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:45:26,184] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:45:26,186] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:45:26,186] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:45:26,187] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:45:26,188] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:45:26,216] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:45:27,252] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:45:27,261] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 16:45:27,263] INFO utils.services.queue_service Successfully processed queue item 854233d3-93e4-45de-b54e-b80e5a5167d1
[2025-06-19 16:45:27,265] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 16:59:35,069] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:59:35,069] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:59:35,070] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:59:35,070] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 16:59:35,070] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 16:59:35,072] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 16:59:35,073] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 16:59:35,143] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-9008568589717682159
[2025-06-19 16:59:35,216] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:59:35,216] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:59:35,216] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:59:35,218] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:59:35,291] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 16:59:35,291] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 16:59:35,292] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 16:59:35,292] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 16:59:41,005] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:59:41,005] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,005] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:59:41,005] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:59:41,005] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 157, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:59:41,032] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:59:41,033] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:59:41,034] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,038] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,039] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:59:41,040] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:59:41,040] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:59:41,040] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:59:41,041] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,041] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:59:41,042] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:59:41,042] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:59:41,042] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:59:41,042] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 157, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:59:41,042] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,044] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 157, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:59:41,044] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:59:41,046] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:59:41,048] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 157, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:59:41,049] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:59:41,055] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:59:41,059] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:59:41,059] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:59:41,060] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 16:59:41,062] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:59:41,062] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:59:41,064] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 16:59:41,064] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:59:41,064] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:59:41,064] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,064] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 16:59:41,065] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:59:41,065] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,065] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:59:41,065] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:41,066] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:59:41,066] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:59:41,066] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:59:41,066] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 16:59:41,067] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:59:41,067] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:59:41,068] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 16:59:41,068] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:59:41,071] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:59:41,071] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 16:59:41,072] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:59:41,073] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 16:59:41,074] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 16:59:41,075] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 16:59:41,076] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:59:41,076] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 16:59:41,077] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:59:41,077] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:59:41,077] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 16:59:41,078] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:59:41,078] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:59:41,079] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 16:59:41,079] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:59:41,081] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 16:59:49,270] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 16:59:49,272] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 157, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 16:59:49,272] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 16:59:49,272] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 16:59:49,272] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 157, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 16:59:49,285] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:59:49,288] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 16:59:49,289] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 16:59:49,291] INFO utils.services.queue_service Queued email ed181a75-773d-40d8-8a65-cd3ec7e1379e for 2 recipients
[2025-06-19 16:59:49,292] INFO utils.email_service Email queued successfully: ed181a75-773d-40d8-8a65-cd3ec7e1379e
[2025-06-19 16:59:49,293] INFO cart.views Order confirmation email queued successfully for order ORD-000039 to eugenelo4@bpp.com
[2025-06-19 16:59:56,731] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:59:56,731] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:59:56,731] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:59:56,732] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:59:56,732] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:59:56,732] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:59:56,733] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:59:56,733] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:59:56,748] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:59:56,750] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:59:56,899] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 233, 10)
[2025-06-19 16:59:56,900] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 16:59:56,902] ERROR CSSUTILS No content to parse.
[2025-06-19 16:59:56,902] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 16:59:56,938] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,938] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:106: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,938] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:59:56,938] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,938] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,938] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:59:56,938] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,938] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,938] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:59:56,951] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,951] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 16:59:56,951] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 16:59:56,958] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:59:58,020] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:59:58,020] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 16:59:58,036] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 16:59:58,036] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 16:59:58,036] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 16:59:58,036] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 16:59:58,036] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 16:59:58,036] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 16:59:58,036] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 16:59:58,036] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 16:59:58,036] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:59:58,036] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 16:59:58,055] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 16:59:59,134] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 16:59:59,142] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 16:59:59,144] INFO utils.services.queue_service Successfully processed queue item ed181a75-773d-40d8-8a65-cd3ec7e1379e
[2025-06-19 16:59:59,148] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 17:16:47,219] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 17:16:47,219] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 17:16:47,219] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 17:16:47,237] WARNING django.request Unauthorized: /api/subjects/
[2025-06-19 17:16:47,240] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 17:16:47,252] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-19 17:16:47,440] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-19 17:16:49,835] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:16:49,836] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 17:16:49,836] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 17:16:49,837] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 17:16:49,838] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 17:16:49,841] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:16:49,841] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 17:16:49,842] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 17:16:49,843] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 17:16:49,843] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 17:16:49,844] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 17:16:49,844] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-19 17:16:49,849] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 17:16:49,852] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 17:16:50,017] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-9008568589717682159
[2025-06-19 17:16:50,150] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_9098962999098367606
[2025-06-19 17:16:50,234] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:16:50,234] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 17:16:50,234] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 17:16:50,242] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 17:16:50,447] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:16:50,450] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 17:16:50,450] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 17:16:50,452] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 17:16:50,522] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:16:50,523] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 17:16:50,523] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 17:16:50,525] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 17:16:57,940] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:16:57,940] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 17:16:57,953] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:16:57,956] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:16:57,962] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:16:57,962] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 17:16:57,965] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 17:16:57,967] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:16:57,969] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:16:57,971] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:16:57,971] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-19 17:16:57,971] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:16:57,971] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:16:57,974] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 17:16:57,975] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:16:57,975] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:16:57,977] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:16:57,978] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-19 17:16:57,978] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:16:57,980] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:16:57,981] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:16:57,981] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:16:57,982] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:16:57,983] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:16:57,985] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:16:57,988] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 17:16:57,990] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:16:57,991] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:16:57,993] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-19 17:16:57,994] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:16:57,996] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:16:57,996] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:16:57,996] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:16:57,996] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:16:57,997] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:16:57,997] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:16:57,997] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:16:57,997] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:16:57,998] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:16:57,998] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:16:57,998] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:16:57,998] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:16:57,999] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:16:57,999] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:16:57,999] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:16:58,000] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:16:58,000] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:16:58,000] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:16:58,003] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:16:58,003] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:16:58,004] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:16:58,005] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:16:58,008] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:16:58,010] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:16:58,012] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:16:58,015] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:16:58,017] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:16:58,017] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:16:58,020] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:16:58,021] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:16:58,022] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:16:58,023] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:17:03,570] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:17:03,574] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 17:17:03,574] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 17:17:03,575] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 17:17:03,686] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:17:03,686] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-19 17:17:03,686] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-19 17:17:03,686] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 17:17:03,809] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:17:03,809] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,809] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:17:03,818] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:17:03,819] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:17:03,819] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:17:03,819] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:17:03,819] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,832] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:17:03,833] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:17:03,835] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:17:03,836] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:17:03,837] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:17:03,837] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:17:03,837] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:17:03,838] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:17:03,855] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:17:03,855] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:17:03,856] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,857] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,859] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:17:03,861] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:17:03,862] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:17:03,862] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:17:03,862] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:17:03,863] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:17:03,878] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:17:03,879] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:17:03,879] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:17:03,880] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,880] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:17:03,881] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:17:03,881] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,882] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:17:03,883] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:17:03,885] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:17:03,885] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:17:03,886] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:17:03,887] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:17:03,888] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:17:03,889] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:17:03,890] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:17:03,891] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:17:03,891] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:17:03,893] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:17:03,894] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:17:03,895] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:17:03,900] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:17:03,906] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:17:03,908] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,909] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:17:03,911] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:17:03,912] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:17:03,922] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:17:03,923] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,924] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:17:03,928] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:17:03,929] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:17:03,929] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:17:03,930] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:17:03,932] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,933] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:17:03,936] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:17:03,937] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:17:03,939] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:17:03,940] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:17:03,941] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:17:03,942] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:17:03,942] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:17:03,942] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:17:03,942] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:17:03,944] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:03,945] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:17:03,945] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:17:03,946] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:17:03,947] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:17:03,948] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:17:03,949] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:17:03,950] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:17:03,952] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:17:14,070] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:17:14,070] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 159, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:17:14,070] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:17:14,070] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:17:14,070] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 159, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:17:14,089] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 17:17:14,098] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 17:17:14,099] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 17:17:14,100] INFO utils.services.queue_service Queued email 2e5837ba-167e-414b-b2b1-ff59d12a6ef5 for 2 recipients
[2025-06-19 17:17:14,102] INFO utils.email_service Email queued successfully: 2e5837ba-167e-414b-b2b1-ff59d12a6ef5
[2025-06-19 17:17:14,102] INFO cart.views Order confirmation email queued successfully for order ORD-000040 to eugenelo4@bpp.com
[2025-06-19 17:17:19,765] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 17:17:19,766] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 17:17:19,767] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 17:17:19,768] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 17:17:19,768] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 17:17:19,769] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 17:17:19,769] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 17:17:19,770] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 17:17:19,809] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 17:17:19,812] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 17:17:20,259] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 233, 10)
[2025-06-19 17:17:20,261] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-19 17:17:20,265] ERROR CSSUTILS No content to parse.
[2025-06-19 17:17:20,267] ERROR CSSUTILS MediaQuery: No content.
[2025-06-19 17:17:20,471] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,486] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,488] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t
[2025-06-19 17:17:20,492] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,494] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,495] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 17:17:20,500] ERROR CSSUTILS Property: No ":" after name found: \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t [1:140: \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,501] ERROR CSSUTILS Property: No property value found: \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t [1:140: \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,506] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t
[2025-06-19 17:17:20,512] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:104: \n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,519] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:104: \n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,526] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 17:17:20,533] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,539] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-19 17:17:20,543] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-19 17:17:20,588] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 17:17:21,827] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 17:17:21,849] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-19 17:17:21,860] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 17:17:21,861] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 17:17:21,861] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 17:17:21,862] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 17:17:21,862] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 17:17:21,863] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 17:17:21,863] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 17:17:21,865] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 17:17:21,865] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 17:17:21,868] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-19 17:17:21,888] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-19 17:17:22,949] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 17:17:22,957] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-19 17:17:22,960] INFO utils.services.queue_service Successfully processed queue item 2e5837ba-167e-414b-b2b1-ff59d12a6ef5
[2025-06-19 17:17:22,963] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-19 17:22:26,089] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:22:26,090] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 17:22:26,090] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 17:22:26,091] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-19 17:22:26,092] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-19 17:22:26,095] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-19 17:22:26,097] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-19 17:22:26,189] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-9008568589717682159
[2025-06-19 17:22:26,319] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:22:26,319] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 17:22:26,320] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 17:22:26,320] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 17:22:26,446] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-19 17:22:26,447] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-19 17:22:26,448] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-19 17:22:26,449] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-19 17:22:34,758] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:22:34,761] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,763] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:22:34,768] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:22:34,769] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 160, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:22:34,776] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:22:34,779] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,785] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:22:34,787] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:22:34,791] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:22:34,792] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 160, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:22:34,793] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,794] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:22:34,795] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:22:34,795] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:22:34,796] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:22:34,797] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,797] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 160, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:22:34,798] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:22:34,800] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:22:34,802] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:22:34,803] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:22:34,805] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:22:34,806] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:22:34,808] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:22:34,809] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:22:34,809] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,811] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:22:34,813] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:22:34,813] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:22:34,813] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:22:34,814] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:22:34,815] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:22:34,815] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:22:34,816] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,816] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:22:34,817] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:22:34,819] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:22:34,819] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:22:34,819] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:22:34,819] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:22:34,820] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:22:34,822] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:22:34,822] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:22:34,823] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:22:34,827] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:22:34,829] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:22:34,830] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:22:34,937] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:22:34,938] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,939] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:22:34,940] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:22:34,940] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 160, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:22:34,954] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-19 17:22:34,955] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-19 17:22:34,956] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:34,956] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-19 17:22:34,957] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-19 17:22:34,957] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-19 17:22:34,957] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-19 17:22:34,958] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-19 17:22:34,958] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-19 17:22:34,958] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-19 17:22:34,959] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-19 17:22:41,189] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-19 17:22:41,190] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 160, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-19 17:22:41,190] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-19 17:22:41,190] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-19 17:22:41,190] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 160, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-19 17:22:41,193] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-19 17:22:41,205] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-19 17:22:41,205] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-19 17:22:41,208] INFO utils.services.queue_service Queued email c37f3914-edf4-4c81-b201-d3f4fe5f1391 for 2 recipients
[2025-06-19 17:22:41,208] INFO utils.email_service Email queued successfully: c37f3914-edf4-4c81-b201-d3f4fe5f1391
[2025-06-19 17:22:41,209] INFO cart.views Order confirmation email queued successfully for order ORD-000041 to eugenelo4@bpp.com
[2025-06-19 17:22:46,817] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 17:22:46,818] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 17:22:46,818] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 17:22:46,818] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 17:22:46,820] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 17:22:46,820] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 17:22:46,820] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 17:22:46,821] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 17:22:46,843] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 17:22:46,845] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 17:22:46,846] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-19 17:22:46,871] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-19 17:22:46,871] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-19 17:22:46,873] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-19 17:22:46,873] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-19 17:22:46,873] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-19 17:22:46,873] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-19 17:22:46,875] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-19 17:22:46,877] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-19 17:22:46,881] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 17:22:46,882] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-19 17:22:46,883] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-19 17:22:46,888] ERROR utils.services.queue_service Queue item c37f3914-edf4-4c81-b201-d3f4fe5f1391 failed after max attempts
[2025-06-19 17:22:46,890] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-19 17:23:46,160] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-20 09:36:37,354] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 09:36:37,354] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 09:36:37,354] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 09:36:37,363] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 09:36:37,364] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 09:36:37,365] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 09:36:37,446] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 09:36:39,743] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:36:39,743] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:36:39,743] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:36:39,745] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 09:36:39,745] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 09:36:39,750] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 09:36:39,753] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 09:36:39,756] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:36:39,761] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 09:36:39,761] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 09:36:39,763] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 09:36:39,764] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 09:36:39,768] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 09:36:39,769] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-20 09:36:39,946] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-9008568589717682159
[2025-06-20 09:36:40,053] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_9098962999098367606
[2025-06-20 09:36:40,113] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:36:40,115] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:36:40,116] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:36:40,116] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:36:40,186] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:36:40,187] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 09:36:40,187] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 09:36:40,188] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:36:40,212] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:36:40,213] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:36:40,213] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:36:40,214] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:37:03,281] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:03,281] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 09:37:03,281] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:03,281] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:03,296] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:03,296] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:03,296] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 09:37:03,296] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 09:37:03,300] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:03,301] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:03,307] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:03,310] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:03,310] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:03,310] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 09:37:03,310] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 09:37:03,310] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:03,330] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:03,334] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:03,334] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 09:37:03,336] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 09:37:03,337] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:03,337] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:03,340] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:03,342] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:03,342] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:03,343] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:03,343] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:03,345] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:03,345] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:03,345] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:03,345] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:03,346] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:03,346] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:03,346] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:03,346] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:03,346] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 09:37:03,347] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:03,347] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:03,349] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:03,350] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:03,352] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:03,355] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:03,356] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:37:03,359] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:03,359] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:37:03,363] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:03,363] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:03,363] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:03,363] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:03,368] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:03,372] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:03,373] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:03,375] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:03,375] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:03,378] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:03,379] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:03,380] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:03,390] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:37:03,392] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:37:03,395] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:03,407] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:03,408] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:10,185] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:37:10,185] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 09:37:10,185] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 09:37:10,189] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:37:10,423] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:37:10,425] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 09:37:10,426] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 09:37:10,427] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:37:10,486] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:10,487] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,489] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:10,490] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:10,491] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:10,507] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:10,508] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:10,509] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,511] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:10,513] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:10,513] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:10,513] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:37:10,514] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:37:10,515] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:10,516] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:10,516] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:10,555] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:10,555] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,555] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:10,555] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:10,555] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:10,570] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:10,570] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:10,570] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,571] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:10,571] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:10,571] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:10,571] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:37:10,572] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:37:10,572] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:10,572] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:10,572] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:10,628] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:10,628] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,629] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:10,629] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:10,629] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:10,642] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:10,643] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:10,643] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,643] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:10,643] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:10,645] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:10,645] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:37:10,645] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:37:10,645] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:10,645] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:10,645] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:10,690] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:10,691] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:10,691] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,691] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,691] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:10,693] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:10,693] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:10,693] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:10,693] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:10,694] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:10,707] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:10,707] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:37:10,707] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:10,707] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:37:10,708] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,708] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:10,708] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:10,709] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:37:10,709] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:10,709] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:37:10,709] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:10,709] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:37:10,709] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:37:10,710] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:37:10,710] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:37:10,710] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:37:10,711] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:10,711] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:37:10,711] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:10,711] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:37:10,711] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:10,712] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:37:24,080] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:37:24,080] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 162, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:37:24,080] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:37:24,080] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:37:24,080] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 162, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:37:24,100] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:37:24,115] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 09:37:24,115] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 09:37:24,116] INFO utils.services.queue_service Queued email f0d0037b-4ec6-49d6-96ab-0af05036946e for 2 recipients
[2025-06-20 09:37:24,116] INFO utils.email_service Email queued successfully: f0d0037b-4ec6-49d6-96ab-0af05036946e
[2025-06-20 09:37:24,116] INFO cart.views Order confirmation email queued successfully for order ORD-000042 to eugenelo4@bpp.com
[2025-06-20 09:37:38,996] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:37:38,997] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:37:38,997] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:37:38,997] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:37:38,997] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:37:38,997] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:37:38,997] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:37:38,997] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:37:39,034] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-20 09:37:39,035] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-20 09:37:39,036] ERROR utils.services.queue_service Failed to send email to eugenelo@bpp.com
[2025-06-20 09:37:39,052] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:37:39,062] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:37:39,063] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:37:39,063] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:37:39,064] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:37:39,064] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:37:39,065] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:37:39,065] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:37:39,069] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-20 09:37:39,070] ERROR utils.services.queue_service Failed to send with master template: Email template rendering failed: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-20 09:37:39,072] ERROR utils.services.queue_service Failed to send email to eugene.lo1030@gmail.com
[2025-06-20 09:37:39,072] ERROR utils.services.queue_service Queue item f0d0037b-4ec6-49d6-96ab-0af05036946e failed after max attempts
[2025-06-20 09:37:39,080] INFO utils.services.queue_service Processed 1 queue items: 0 successful, 1 failed
[2025-06-20 09:38:27,611] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-20 09:42:57,217] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 09:42:58,637] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 09:43:21,322] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 09:43:22,429] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 09:44:46,679] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 09:44:47,585] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 09:45:08,804] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 09:45:08,814] ERROR utils.email_service Failed to render email with master template: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-20 09:45:08,816] ERROR utils.email_service Failed to send MJML email to ['test@example.com']: Email template rendering failed: Invalid block tag on line 86: 'endif', expected 'empty' or 'endfor'. Did you forget to register or load this tag?
[2025-06-20 09:46:09,160] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 09:46:09,199] INFO utils.email_service Development mode: Redirecting email from ['test@example.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:46:09,203] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 09:46:09,493] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-20 09:46:09,493] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 09:46:09,500] ERROR CSSUTILS No content to parse.
[2025-06-20 09:46:09,501] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 09:46:09,620] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:46:09,620] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:46:09,622] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:46:09,624] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:46:09,624] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:46:09,624] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:46:09,632] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:46:09,635] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:46:09,639] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:46:09,653] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 09:46:10,935] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:46:26,195] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-20 09:47:57,969] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:47:57,970] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:47:57,970] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:47:57,971] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 09:47:57,972] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 09:47:57,974] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 09:47:57,975] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 09:47:58,050] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 09:47:58,132] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:47:58,134] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:47:58,134] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:47:58,135] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:47:58,215] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:47:58,215] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:47:58,215] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:47:58,216] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:48:04,068] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:48:04,068] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:48:04,070] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,070] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:48:04,070] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:48:04,076] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,076] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:48:04,077] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,077] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:48:04,077] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 163, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:48:04,079] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:48:04,082] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:48:04,089] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:48:04,090] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 163, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:48:04,091] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 163, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:48:04,092] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:48:04,098] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,099] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:48:04,102] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:48:04,103] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:48:04,105] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:48:04,106] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:48:04,106] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,107] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 163, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:48:04,108] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:48:04,108] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:48:04,108] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:48:04,110] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,114] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:48:04,116] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:48:04,117] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:48:04,118] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,118] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:48:04,119] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:48:04,120] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:48:04,120] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:48:04,121] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:48:04,121] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:48:04,121] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:48:04,121] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:48:04,121] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:48:04,122] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:48:04,122] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:48:04,122] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:48:04,122] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:04,122] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:48:04,122] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:48:04,123] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:48:04,123] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:48:04,123] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:48:04,123] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:48:04,124] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:48:04,124] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:48:04,124] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:48:04,124] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:48:04,126] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:48:04,127] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:48:04,128] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:48:04,128] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:48:04,134] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:48:04,135] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:48:04,140] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:48:04,142] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:48:04,145] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:48:16,246] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:48:16,246] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 163, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:48:16,246] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:48:16,246] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:48:16,246] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 163, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:48:16,269] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:48:16,275] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 09:48:16,275] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 09:48:16,278] INFO utils.services.queue_service Queued email 393f5ffd-f374-4173-9b7b-4a0ad50eac90 for 2 recipients
[2025-06-20 09:48:16,278] INFO utils.email_service Email queued successfully: 393f5ffd-f374-4173-9b7b-4a0ad50eac90
[2025-06-20 09:48:16,279] INFO cart.views Order confirmation email queued successfully for order ORD-000043 to eugenelo4@bpp.com
[2025-06-20 09:48:37,286] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:48:37,287] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:48:37,287] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:48:37,287] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:48:37,288] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:48:37,288] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:48:37,288] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:48:37,289] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:48:37,306] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:48:37,308] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 09:48:37,429] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-20 09:48:37,429] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 09:48:37,429] ERROR CSSUTILS No content to parse.
[2025-06-20 09:48:37,429] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 09:48:37,481] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:48:37,481] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:48:37,481] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:48:37,494] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:48:37,495] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:48:37,496] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:48:37,500] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:48:37,501] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:48:37,501] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:48:37,506] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 09:48:39,088] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:48:39,094] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 09:48:39,115] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:48:39,116] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:48:39,117] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:48:39,118] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:48:39,118] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:48:39,120] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:48:39,120] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:48:39,120] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:48:39,120] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:48:39,123] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 09:48:39,137] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 09:48:40,311] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:48:40,322] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 09:48:40,329] INFO utils.services.queue_service Successfully processed queue item 393f5ffd-f374-4173-9b7b-4a0ad50eac90
[2025-06-20 09:48:40,335] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 09:56:25,001] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:56:25,002] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:56:25,003] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:56:25,004] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 09:56:25,004] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 09:56:25,006] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 09:56:25,008] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 09:56:25,081] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 09:56:25,162] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:56:25,162] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:56:25,163] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:56:25,163] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:56:25,244] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:56:25,245] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:56:25,245] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:56:25,246] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:56:33,498] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:56:33,498] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,498] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:56:33,510] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:56:33,511] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 164, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:56:33,527] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:56:33,529] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,530] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:56:33,532] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:56:33,533] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:56:33,533] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:56:33,533] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,533] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 164, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:56:33,535] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:56:33,536] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:56:33,536] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:56:33,538] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-20 09:56:33,539] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 09:56:33,540] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:56:33,542] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:56:33,542] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:56:33,544] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:56:33,545] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:56:33,545] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,546] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:56:33,548] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:56:33,549] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,551] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:56:33,552] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:56:33,553] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 164, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:56:33,553] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:56:33,555] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:56:33,556] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-20 09:56:33,558] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 09:56:33,559] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:56:33,559] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:56:33,560] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:56:33,561] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:56:33,564] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:56:33,567] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,568] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:56:33,570] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:56:33,571] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:56:33,572] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-20 09:56:33,573] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 09:56:33,573] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:56:33,574] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:56:33,575] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:56:33,626] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:56:33,626] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,626] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:56:33,626] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:56:33,626] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 164, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:56:33,635] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:56:33,635] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:56:33,635] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:33,635] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:56:33,636] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:56:33,636] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:56:33,636] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}
[2025-06-20 09:56:33,636] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 09:56:33,636] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:56:33,637] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:56:33,637] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:56:40,745] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:56:40,745] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 164, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 2, 'variationName': 'Printed Materials'}}]
[2025-06-20 09:56:40,745] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:56:40,745] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:56:40,745] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 164, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:56:40,765] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:56:40,768] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 09:56:40,769] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 09:56:40,771] INFO utils.services.queue_service Queued email be3be435-7fe0-49a3-9760-16099594a139 for 2 recipients
[2025-06-20 09:56:40,772] INFO utils.email_service Email queued successfully: be3be435-7fe0-49a3-9760-16099594a139
[2025-06-20 09:56:40,772] INFO cart.views Order confirmation email queued successfully for order ORD-000044 to eugenelo4@bpp.com
[2025-06-20 09:56:45,262] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:56:45,263] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:56:45,263] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:56:45,264] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:56:45,264] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:56:45,264] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:56:45,265] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:56:45,265] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:56:45,284] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:56:45,286] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 09:56:45,427] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-20 09:56:45,429] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 09:56:45,429] ERROR CSSUTILS No content to parse.
[2025-06-20 09:56:45,430] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 09:56:45,466] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:56:45,466] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:56:45,473] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:56:45,473] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:56:45,473] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:56:45,473] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:56:45,477] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:56:45,478] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:56:45,479] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:56:45,493] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 09:56:46,670] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:56:46,672] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 09:56:46,677] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:56:46,678] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:56:46,678] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:56:46,678] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:56:46,679] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:56:46,679] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:56:46,679] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:56:46,680] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:56:46,681] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:56:46,681] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 09:56:46,702] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 09:56:47,744] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:56:47,757] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 09:56:47,764] INFO utils.services.queue_service Successfully processed queue item be3be435-7fe0-49a3-9760-16099594a139
[2025-06-20 09:56:47,771] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 09:59:28,828] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:59:28,828] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:59:28,828] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:59:28,828] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:59:28,911] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:59:28,911] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:59:28,911] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:59:28,911] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:59:29,003] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 09:59:29,003] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 09:59:29,004] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 09:59:29,004] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 09:59:34,295] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:59:34,295] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,309] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:59:34,310] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:59:34,310] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:59:34,310] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:59:34,310] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,310] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,310] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 165, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:59:34,311] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:59:34,311] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:59:34,313] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:59:34,313] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:59:34,314] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 165, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:59:34,316] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 165, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:59:34,325] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:59:34,327] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:59:34,328] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,330] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:59:34,330] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:59:34,331] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:59:34,332] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:59:34,333] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:59:34,333] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:59:34,334] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,334] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:59:34,334] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:59:34,335] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:59:34,335] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,335] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:59:34,335] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:59:34,337] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:59:34,337] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:59:34,337] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:59:34,337] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:59:34,337] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:59:34,337] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:59:34,338] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:59:34,338] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:59:34,338] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:59:34,338] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:59:34,339] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:59:34,339] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:59:34,341] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:59:34,342] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:59:34,342] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:59:34,342] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:59:34,345] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:59:34,398] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:59:34,398] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,400] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:59:34,401] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:59:34,402] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 165, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:59:34,413] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 09:59:34,413] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 09:59:34,414] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:34,415] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 09:59:34,415] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 09:59:34,416] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 09:59:34,416] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 09:59:34,417] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 09:59:34,417] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 09:59:34,417] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 09:59:34,417] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 09:59:42,378] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 09:59:42,378] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 165, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 09:59:42,378] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 09:59:42,378] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 09:59:42,378] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 165, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 09:59:42,401] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:59:42,404] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 09:59:42,404] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 09:59:42,407] INFO utils.services.queue_service Queued email a2f13a51-c292-450a-9e14-0d1122e6be4d for 2 recipients
[2025-06-20 09:59:42,407] INFO utils.email_service Email queued successfully: a2f13a51-c292-450a-9e14-0d1122e6be4d
[2025-06-20 09:59:42,408] INFO cart.views Order confirmation email queued successfully for order ORD-000045 to eugenelo4@bpp.com
[2025-06-20 09:59:49,710] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:59:49,710] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:59:49,710] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:59:49,721] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:59:49,721] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:59:49,721] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:59:49,721] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:59:49,721] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:59:49,729] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:59:49,742] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 09:59:49,862] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 234, 10)
[2025-06-20 09:59:49,862] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 09:59:49,876] ERROR CSSUTILS No content to parse.
[2025-06-20 09:59:49,877] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 09:59:49,916] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:59:49,918] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 09:59:49,918] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:59:49,918] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:59:49,918] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 09:59:49,918] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:59:49,918] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:59:49,918] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 09:59:49,918] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 09:59:49,931] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 09:59:51,089] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:59:51,091] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 09:59:51,098] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 09:59:51,099] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 09:59:51,099] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 09:59:51,099] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 09:59:51,100] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 09:59:51,100] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 09:59:51,100] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 09:59:51,101] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 09:59:51,102] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:59:51,103] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 09:59:51,115] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 09:59:52,167] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 09:59:52,170] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 09:59:52,186] INFO utils.services.queue_service Successfully processed queue item a2f13a51-c292-450a-9e14-0d1122e6be4d
[2025-06-20 09:59:52,190] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 10:21:24,851] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:21:24,851] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:21:24,851] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:21:24,851] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 10:21:24,851] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 10:21:24,851] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 10:21:24,851] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 10:21:24,934] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 10:21:25,036] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:21:25,037] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:21:25,037] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:21:25,038] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:21:25,142] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:21:25,142] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:21:25,143] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:21:25,144] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:21:31,968] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:21:31,968] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:31,968] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:21:31,968] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:21:31,983] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 166, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:21:31,996] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:21:31,996] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:31,997] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:21:31,999] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:21:32,001] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 166, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:21:32,001] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:21:32,004] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:21:32,005] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:32,008] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:21:32,009] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:21:32,009] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:21:32,011] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:32,012] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:21:32,012] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:21:32,012] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:21:32,013] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:21:32,013] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:21:32,013] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:21:32,013] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 10:21:32,014] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:32,014] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 166, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:21:32,014] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:21:32,014] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:21:32,015] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:21:32,015] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:21:32,015] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:21:32,015] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:21:32,017] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:21:32,019] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 10:21:32,024] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:21:32,025] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:21:32,027] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:21:32,027] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:21:32,028] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:21:32,030] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:32,031] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:21:32,033] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:21:32,033] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:21:32,035] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:21:32,040] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 10:21:32,042] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:21:32,043] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:21:32,043] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:21:32,094] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:21:32,094] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:32,094] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:21:32,095] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:21:32,096] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 166, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:21:32,100] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:21:32,100] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:21:32,100] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:32,101] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:21:32,101] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:21:32,101] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:21:32,101] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:21:32,102] INFO rules_engine.custom_functions DEBUG: product_id: 77, subject_code: CB1
[2025-06-20 10:21:32,102] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:21:32,102] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:21:32,103] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:21:38,148] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:21:38,148] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 166, 'product_id': 77, 'subject_code': 'CB1', 'product_name': 'Flash Cards', 'product_code': 'FC', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '38.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:21:38,149] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:21:38,149] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:21:38,149] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 38.0, 'total_vat': 7.6, 'total_gross': 45.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 166, 'product_name': 'Flash Cards', 'net_amount': 38.0, 'vat_amount': 7.6, 'gross_amount': 45.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:21:38,160] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:21:38,163] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 10:21:38,164] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 10:21:38,166] INFO utils.services.queue_service Queued email a78d14b9-c362-456b-b9d2-f47722056360 for 2 recipients
[2025-06-20 10:21:38,168] INFO utils.email_service Email queued successfully: a78d14b9-c362-456b-b9d2-f47722056360
[2025-06-20 10:21:38,168] INFO cart.views Order confirmation email queued successfully for order ORD-000046 to eugenelo4@bpp.com
[2025-06-20 10:21:46,657] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:21:46,658] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:21:46,658] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:21:46,659] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:21:46,659] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:21:46,659] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:21:46,659] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:21:46,660] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:21:46,673] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:21:46,675] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:21:46,823] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 235, 10)
[2025-06-20 10:21:46,824] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 10:21:46,827] ERROR CSSUTILS No content to parse.
[2025-06-20 10:21:46,827] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 10:21:46,871] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:21:46,871] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:21:46,871] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:21:46,871] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:21:46,871] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:21:46,871] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:21:46,871] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:21:46,871] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:21:46,871] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:21:46,890] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:21:47,984] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:21:48,000] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 10:21:48,012] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:21:48,013] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:21:48,013] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:21:48,013] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:21:48,014] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:21:48,014] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:21:48,014] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:21:48,015] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:21:48,015] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:21:48,016] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:21:48,036] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:21:49,240] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:21:49,247] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 10:21:49,251] INFO utils.services.queue_service Successfully processed queue item a78d14b9-c362-456b-b9d2-f47722056360
[2025-06-20 10:21:49,254] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 10:27:23,941] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:27:23,941] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:27:23,942] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:27:23,942] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 10:27:23,942] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 10:27:23,944] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 10:27:23,945] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 10:27:24,025] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 10:27:24,110] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:27:24,110] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:27:24,110] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:27:24,110] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:27:24,187] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:27:24,187] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:27:24,187] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:27:24,188] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:27:30,488] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:27:30,489] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,498] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:27:30,501] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:27:30,504] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:27:30,504] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 167, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:27:30,506] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,511] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:27:30,512] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:27:30,514] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,515] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:27:30,518] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:27:30,519] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:27:30,519] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 167, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:27:30,520] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:27:30,520] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,520] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:27:30,521] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 167, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:27:30,521] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:27:30,522] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:27:30,526] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:27:30,526] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,529] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 167, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:27:30,530] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:27:30,532] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:27:30,532] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:27:30,533] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:27:30,534] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:27:30,535] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,535] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:27:30,536] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:27:30,536] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:27:30,537] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:27:30,537] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:27:30,537] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:27:30,538] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:27:30,539] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,539] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:27:30,539] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:27:30,539] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:27:30,539] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:27:30,539] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:30,539] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:27:30,540] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:27:30,540] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:27:30,542] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:27:30,542] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:27:30,542] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:27:30,543] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:27:30,543] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:27:30,545] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:27:30,545] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:27:30,546] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:27:30,546] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:27:30,547] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:27:30,547] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:27:30,548] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:27:30,548] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:27:30,549] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:27:30,550] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:27:30,551] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:27:30,552] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:27:30,553] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:27:30,556] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:27:37,974] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:27:37,974] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 167, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:27:37,974] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:27:37,974] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:27:37,974] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 167, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:27:37,992] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:27:37,995] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 10:27:37,995] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 10:27:37,997] INFO utils.services.queue_service Queued email d036f3d7-a9c9-4570-97bc-1d665005e1dc for 2 recipients
[2025-06-20 10:27:37,998] INFO utils.email_service Email queued successfully: d036f3d7-a9c9-4570-97bc-1d665005e1dc
[2025-06-20 10:27:37,998] INFO cart.views Order confirmation email queued successfully for order ORD-000047 to eugenelo4@bpp.com
[2025-06-20 10:27:43,064] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:27:43,064] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:27:43,065] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:27:43,065] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:27:43,066] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:27:43,066] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:27:43,066] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:27:43,067] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:27:43,081] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:27:43,081] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:27:43,264] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 235, 10)
[2025-06-20 10:27:43,264] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 10:27:43,265] ERROR CSSUTILS No content to parse.
[2025-06-20 10:27:43,265] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 10:27:43,307] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:27:43,308] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:27:43,308] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:27:43,309] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:27:43,309] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:27:43,310] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:27:43,311] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:27:43,311] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:27:43,312] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:27:43,321] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:27:44,399] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:27:44,402] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 10:27:44,409] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:27:44,409] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:27:44,410] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:27:44,410] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:27:44,410] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:27:44,411] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:27:44,411] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:27:44,411] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:27:44,412] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:27:44,413] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:27:44,431] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:27:45,493] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:27:45,500] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 10:27:45,518] INFO utils.services.queue_service Successfully processed queue item d036f3d7-a9c9-4570-97bc-1d665005e1dc
[2025-06-20 10:27:45,521] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 10:34:17,303] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:34:17,304] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:34:17,304] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:34:17,305] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 10:34:17,310] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 10:34:17,314] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 10:34:17,317] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 10:34:17,473] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 10:34:17,723] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:34:17,724] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:34:17,724] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:34:17,726] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:34:18,119] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:34:18,120] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:34:18,121] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:34:18,122] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:34:23,993] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:34:23,993] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:23,993] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:34:23,993] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:34:23,993] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 168, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:34:24,015] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:34:24,017] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:34:24,017] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:34:24,018] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:24,019] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:24,019] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:34:24,019] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:34:24,020] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:34:24,020] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:34:24,021] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 168, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:34:24,022] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:34:24,022] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:34:24,023] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:34:24,023] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:24,024] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:34:24,026] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:34:24,026] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:34:24,028] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:34:24,028] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:34:24,029] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 168, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:34:24,030] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:34:24,034] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:34:24,036] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:34:24,037] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:24,039] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:34:24,040] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:34:24,040] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:34:24,043] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:34:24,043] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:34:24,043] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:24,045] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:34:24,045] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:34:24,046] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:34:24,047] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:34:24,047] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:34:24,047] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:34:24,047] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:34:24,048] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:34:24,049] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:34:24,049] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:34:24,051] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:34:24,052] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:34:24,054] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:34:24,120] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:34:24,121] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:24,121] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:34:24,121] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:34:24,122] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 168, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:34:24,131] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:34:24,132] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:34:24,132] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:24,132] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:34:24,133] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:34:24,133] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:34:24,133] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:34:24,133] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 10:34:24,134] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:34:24,134] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:34:24,134] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:34:29,746] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:34:29,746] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 168, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:34:29,746] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:34:29,746] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:34:29,746] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 168, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:34:29,746] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:34:29,763] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 10:34:29,763] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 10:34:29,765] INFO utils.services.queue_service Queued email 1a309c43-d06f-4a25-a329-5bac7e3f591a for 2 recipients
[2025-06-20 10:34:29,766] INFO utils.email_service Email queued successfully: 1a309c43-d06f-4a25-a329-5bac7e3f591a
[2025-06-20 10:34:29,767] INFO cart.views Order confirmation email queued successfully for order ORD-000048 to eugenelo4@bpp.com
[2025-06-20 10:34:35,133] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:34:35,134] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:34:35,135] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:34:35,135] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:34:35,135] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:34:35,136] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:34:35,137] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:34:35,137] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:34:35,160] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:34:35,160] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:34:35,426] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 235, 10)
[2025-06-20 10:34:35,426] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 10:34:35,426] ERROR CSSUTILS No content to parse.
[2025-06-20 10:34:35,426] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 10:34:35,515] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:34:35,516] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:34:35,517] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:34:35,518] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:34:35,520] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:34:35,520] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:34:35,523] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:34:35,525] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:34:35,526] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:34:35,536] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:34:36,598] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:34:36,601] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 10:34:36,611] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:34:36,611] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:34:36,611] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:34:36,612] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:34:36,612] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:34:36,612] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:34:36,613] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:34:36,613] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:34:36,614] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:34:36,615] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:34:36,634] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:34:37,656] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:34:37,662] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 10:34:37,672] INFO utils.services.queue_service Successfully processed queue item 1a309c43-d06f-4a25-a329-5bac7e3f591a
[2025-06-20 10:34:37,683] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 10:39:45,510] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 10:39:45,510] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 10:39:45,510] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 10:39:45,519] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 10:39:45,527] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 10:39:45,535] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 10:39:45,680] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 10:39:47,573] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:39:47,574] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:39:47,574] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:39:47,576] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 10:39:47,577] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:39:47,577] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 10:39:47,578] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 10:39:47,578] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 10:39:47,578] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 10:39:47,579] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 10:39:47,582] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 10:39:47,584] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 10:39:47,585] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 10:39:47,587] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-20 10:39:47,750] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 10:39:47,888] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_-5616254373995419659
[2025-06-20 10:39:47,995] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:39:47,996] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:39:47,996] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:39:47,997] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:39:48,136] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:39:48,136] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 10:39:48,137] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 10:39:48,138] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:39:48,268] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:39:48,270] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 10:39:48,271] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 10:39:48,272] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:39:57,608] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:39:57,610] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 10:39:57,610] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:39:57,618] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:39:57,619] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 10:39:57,633] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 10:39:57,642] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:39:57,648] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 10:39:57,649] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:39:57,649] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:39:57,650] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:39:57,652] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:39:57,652] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:39:57,652] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:39:57,652] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 10:39:57,654] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:39:57,654] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 10:39:57,654] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:39:57,655] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:39:57,657] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:39:57,658] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:39:57,661] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:39:57,661] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 10:39:57,665] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:39:57,669] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:39:57,673] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:39:57,678] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:39:57,682] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:39:57,682] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:39:57,683] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:39:57,685] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 10:39:57,686] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:39:57,687] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:39:57,688] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:39:57,689] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:39:57,690] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:39:57,691] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:39:57,693] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:39:57,694] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:39:57,694] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:39:57,696] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:39:57,697] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:39:57,698] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:39:57,698] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:39:57,698] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:39:57,700] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:39:57,700] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 10:39:57,704] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:39:57,706] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 10:39:57,710] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 10:39:57,713] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:39:57,717] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:39:57,722] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:39:57,724] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:39:57,725] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:39:57,728] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:39:57,731] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:39:57,733] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:39:57,734] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:39:57,737] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 10:39:57,740] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 10:39:57,746] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 10:39:57,751] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:39:57,753] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:42:31,707] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:42:31,707] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 10:42:31,707] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:42:31,707] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:42:31,712] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 10:42:31,715] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 10:42:31,721] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:42:31,721] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:42:31,722] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 10:42:31,722] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:42:31,722] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:42:31,723] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:42:31,723] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 10:42:31,724] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:42:31,724] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:42:43,368] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:42:43,368] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 10:42:43,368] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 10:42:43,369] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:42:43,540] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 10:42:43,544] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 10:42:43,544] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 10:42:43,544] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 10:42:43,700] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:42:43,701] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,701] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:42:43,703] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:42:43,703] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:42:43,711] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:42:43,711] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:42:43,711] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,711] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:42:43,711] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:42:43,715] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:42:43,715] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:42:43,715] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 10:42:43,715] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 10:42:43,716] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 10:42:43,716] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:42:43,716] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:42:43,800] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:42:43,809] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,819] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:42:43,826] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:42:43,828] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:42:43,836] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:42:43,837] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,840] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:42:43,841] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:42:43,842] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:42:43,842] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:42:43,842] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:42:43,850] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,851] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:42:43,851] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:42:43,853] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:42:43,854] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:42:43,856] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 10:42:43,857] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 10:42:43,859] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 10:42:43,861] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:42:43,862] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:42:43,864] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:42:43,866] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:42:43,867] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,872] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:42:43,874] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:42:43,875] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:42:43,876] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:42:43,878] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 10:42:43,882] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:42:43,882] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 10:42:43,884] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,885] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 10:42:43,885] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:42:43,885] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:42:43,887] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:42:43,888] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:42:43,888] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:42:43,909] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:42:43,910] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:42:43,911] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,913] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:42:43,914] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:42:43,915] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:42:43,917] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:42:43,918] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 10:42:43,919] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 10:42:43,919] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 10:42:43,922] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:42:43,922] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:42:43,991] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:42:43,992] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:43,993] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:42:43,993] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:42:43,994] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:42:44,007] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 10:42:44,009] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 10:42:44,009] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:42:44,010] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 10:42:44,011] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 10:42:44,013] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 10:42:44,014] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 10:42:44,016] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 10:42:44,017] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 10:42:44,017] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 10:42:44,018] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 10:42:44,018] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 10:43:00,790] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 10:43:00,790] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 170, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 10:43:00,790] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 10:43:00,790] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 10:43:00,790] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 170, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 10:43:00,807] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:43:00,810] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 10:43:00,810] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 10:43:00,814] INFO utils.services.queue_service Queued email 608e20da-1298-486d-929e-d63d9366bdb8 for 2 recipients
[2025-06-20 10:43:00,814] INFO utils.email_service Email queued successfully: 608e20da-1298-486d-929e-d63d9366bdb8
[2025-06-20 10:43:00,815] INFO cart.views Order confirmation email queued successfully for order ORD-000049 to eugenelo4@bpp.com
[2025-06-20 10:43:07,226] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:43:07,227] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:43:07,227] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:43:07,227] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:43:07,229] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:43:07,229] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:43:07,229] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:43:07,230] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:43:07,252] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:43:07,253] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:43:07,467] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 237, 10)
[2025-06-20 10:43:07,467] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 10:43:07,480] ERROR CSSUTILS No content to parse.
[2025-06-20 10:43:07,480] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 10:43:07,599] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:43:07,600] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 10:43:07,600] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:43:07,603] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:43:07,604] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 10:43:07,605] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:43:07,609] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:43:07,611] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 10:43:07,612] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 10:43:07,642] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:43:08,814] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:43:08,818] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 10:43:08,828] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 10:43:08,828] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 10:43:08,829] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 10:43:08,829] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 10:43:08,829] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 10:43:08,830] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 10:43:08,830] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 10:43:08,831] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 10:43:08,832] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:43:08,833] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 10:43:08,858] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 10:43:09,958] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 10:43:09,961] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 10:43:09,966] INFO utils.services.queue_service Successfully processed queue item 608e20da-1298-486d-929e-d63d9366bdb8
[2025-06-20 10:43:09,968] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 11:00:02,691] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:00:02,692] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:00:02,692] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:00:02,693] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 11:00:02,693] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 11:00:02,695] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 11:00:02,697] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 11:00:02,761] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 11:00:02,836] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:00:02,836] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:00:02,836] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:00:02,837] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:00:02,908] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:00:02,908] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:00:02,909] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:00:02,909] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:00:10,006] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:00:10,006] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,022] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:00:10,023] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:00:10,026] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 171, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:00:10,041] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:00:10,044] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,046] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:00:10,047] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:00:10,047] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:00:10,048] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:00:10,048] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,049] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 171, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:00:10,050] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:00:10,051] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:00:10,052] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,053] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:00:10,055] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:00:10,055] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:00:10,055] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 171, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:00:10,056] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:00:10,059] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,061] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:00:10,062] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:00:10,063] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:00:10,064] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:00:10,065] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:00:10,066] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:00:10,066] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:00:10,067] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 171, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:00:10,068] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,068] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:00:10,068] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:00:10,069] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:00:10,069] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:00:10,069] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:00:10,070] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:00:10,070] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:00:10,071] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,071] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:00:10,073] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:00:10,074] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:00:10,075] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:00:10,077] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:00:10,077] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:00:10,077] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:00:10,077] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:00:10,078] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:00:10,078] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:00:10,079] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:10,079] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:00:10,081] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:00:10,082] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:00:10,082] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:00:10,082] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:00:10,082] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:00:10,086] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:00:10,087] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:00:10,088] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:00:10,088] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:00:10,093] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:00:10,099] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:00:10,100] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:00:10,102] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:00:16,675] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:00:16,675] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 171, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:00:16,675] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:00:16,675] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:00:16,675] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 171, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:00:16,693] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:00:16,695] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 11:00:16,696] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 11:00:16,698] INFO utils.services.queue_service Queued email 05c54fe1-d811-4d23-a68f-bd4e5e3d24ba for 2 recipients
[2025-06-20 11:00:16,700] INFO utils.email_service Email queued successfully: 05c54fe1-d811-4d23-a68f-bd4e5e3d24ba
[2025-06-20 11:00:16,700] INFO cart.views Order confirmation email queued successfully for order ORD-000050 to eugenelo4@bpp.com
[2025-06-20 11:00:24,809] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:00:24,809] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:00:24,809] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:00:24,809] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:00:24,809] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:00:24,809] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:00:24,814] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:00:24,815] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:00:24,833] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:00:24,835] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:00:25,037] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 237, 10)
[2025-06-20 11:00:25,037] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 11:00:25,037] ERROR CSSUTILS No content to parse.
[2025-06-20 11:00:25,040] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 11:00:25,110] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:00:25,111] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:00:25,111] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:00:25,113] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:00:25,114] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:00:25,114] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:00:25,117] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:00:25,117] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:00:25,118] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:00:25,131] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:00:26,442] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:00:26,459] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 11:00:26,469] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:00:26,469] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:00:26,469] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:00:26,469] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:00:26,469] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:00:26,469] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:00:26,472] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:00:26,472] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:00:26,472] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:00:26,474] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:00:26,488] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:00:27,490] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:00:27,500] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 11:00:27,509] INFO utils.services.queue_service Successfully processed queue item 05c54fe1-d811-4d23-a68f-bd4e5e3d24ba
[2025-06-20 11:00:27,514] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 11:15:05,187] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:15:05,187] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:15:05,191] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:15:05,191] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 11:15:05,195] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 11:15:05,200] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 11:15:05,202] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 11:15:05,299] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 11:15:05,436] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:15:05,437] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:15:05,439] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:15:05,440] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:15:05,709] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:15:05,710] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:15:05,711] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:15:05,712] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:15:12,376] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:15:12,376] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,376] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:15:12,376] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:15:12,392] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 172, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:15:12,392] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:15:12,392] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:15:12,392] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,392] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:15:12,407] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:15:12,408] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:15:12,410] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,411] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,411] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:15:12,411] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:15:12,412] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:15:12,412] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:15:12,413] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,413] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 172, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:15:12,413] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:15:12,413] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:15:12,414] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:15:12,415] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 172, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:15:12,416] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:15:12,416] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:15:12,418] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:15:12,419] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 172, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:15:12,420] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:15:12,422] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:15:12,422] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:15:12,423] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:15:12,424] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:15:12,425] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,425] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:15:12,425] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:15:12,426] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:15:12,427] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:15:12,430] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:15:12,432] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,432] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:15:12,433] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:15:12,433] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:15:12,434] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:15:12,434] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:15:12,434] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:15:12,435] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:12,436] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:15:12,436] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:15:12,436] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:15:12,437] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:15:12,437] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:15:12,437] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:15:12,437] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:15:12,438] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:15:12,438] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:15:12,439] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:15:12,439] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:15:12,439] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:15:12,440] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:15:12,440] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:15:12,442] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:15:12,446] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:15:12,449] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:15:12,451] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:15:18,893] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:15:18,893] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 172, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:15:18,893] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:15:18,893] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:15:18,893] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 172, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:15:18,914] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:15:18,917] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 11:15:18,918] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 11:15:18,920] INFO utils.services.queue_service Queued email 2e7b4717-8f99-4fc6-8596-46f343757da3 for 2 recipients
[2025-06-20 11:15:18,921] INFO utils.email_service Email queued successfully: 2e7b4717-8f99-4fc6-8596-46f343757da3
[2025-06-20 11:15:18,922] INFO cart.views Order confirmation email queued successfully for order ORD-000051 to eugenelo4@bpp.com
[2025-06-20 11:15:31,645] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:15:31,645] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:15:31,645] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:15:31,645] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:15:31,659] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:15:31,660] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:15:31,660] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:15:31,661] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:15:31,680] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:15:31,681] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:15:31,853] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 237, 10)
[2025-06-20 11:15:31,854] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 11:15:31,855] ERROR CSSUTILS No content to parse.
[2025-06-20 11:15:31,855] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 11:15:31,909] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:15:31,910] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:15:31,911] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:15:31,912] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:15:31,913] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:15:31,914] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:15:31,915] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:15:31,915] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:15:31,915] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:15:31,931] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:15:33,135] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:15:33,140] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 11:15:33,143] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:15:33,143] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:15:33,143] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:15:33,143] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:15:33,143] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:15:33,143] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:15:33,143] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:15:33,143] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:15:33,143] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:15:33,143] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:15:33,159] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:15:34,226] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:15:34,226] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 11:15:34,240] INFO utils.services.queue_service Successfully processed queue item 2e7b4717-8f99-4fc6-8596-46f343757da3
[2025-06-20 11:15:34,244] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 11:15:40,517] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:15:40,517] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:15:40,517] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:15:40,518] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:15:40,623] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:15:40,624] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:15:40,624] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:15:40,625] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:15:40,778] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:15:40,779] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:15:40,779] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:15:40,780] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:19:27,439] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:19:27,439] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,439] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:19:27,439] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:19:27,439] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 306.0, 'total_vat': 61.2, 'total_gross': 367.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 173, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 174, 'product_name': 'Mini ASET (April 2024 Paper) ', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 175, 'product_name': 'Series X Assignments (Marking)', 'net_amount': 210.0, 'vat_amount': 42.0, 'gross_amount': 252.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 176, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:19:27,464] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:19:27,467] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,467] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:19:27,468] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:19:27,469] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:19:27,469] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,470] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:19:27,470] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:19:27,471] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:19:27,471] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,474] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 306.0, 'total_vat': 61.2, 'total_gross': 367.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 173, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 174, 'product_name': 'Mini ASET (April 2024 Paper) ', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 175, 'product_name': 'Series X Assignments (Marking)', 'net_amount': 210.0, 'vat_amount': 42.0, 'gross_amount': 252.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 176, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:19:27,475] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:19:27,476] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:19:27,479] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 306.0, 'total_vat': 61.2, 'total_gross': 367.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 173, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 174, 'product_name': 'Mini ASET (April 2024 Paper) ', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 175, 'product_name': 'Series X Assignments (Marking)', 'net_amount': 210.0, 'vat_amount': 42.0, 'gross_amount': 252.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 176, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:19:27,480] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:19:27,483] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:19:27,484] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:19:27,484] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,486] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,486] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:19:27,486] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 11:19:27,487] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:19:27,487] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:19:27,488] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 11:19:27,488] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:19:27,490] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:19:27,491] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,491] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,491] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:19:27,491] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 306.0, 'total_vat': 61.2, 'total_gross': 367.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 173, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 174, 'product_name': 'Mini ASET (April 2024 Paper) ', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 175, 'product_name': 'Series X Assignments (Marking)', 'net_amount': 210.0, 'vat_amount': 42.0, 'gross_amount': 252.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 176, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:19:27,492] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:19:27,492] INFO rules_engine.custom_functions DEBUG: product_id: 91, subject_code: CB1
[2025-06-20 11:19:27,492] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,494] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:19:27,494] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}
[2025-06-20 11:19:27,495] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:19:27,495] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:19:27,497] INFO rules_engine.custom_functions DEBUG: product_id: 117, subject_code: CB1
[2025-06-20 11:19:27,497] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:19:27,498] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,499] INFO rules_engine.custom_functions DEBUG: Found marking product 117 with subject CB1
[2025-06-20 11:19:27,499] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:19:27,499] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:19:27,499] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 11:19:27,499] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,499] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:19:27,500] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,500] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 11:19:27,500] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-20 11:19:27,500] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:27,501] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 11:19:27,501] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,501] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 11:19:27,501] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:19:27,502] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 11:19:27,502] INFO rules_engine.custom_functions DEBUG: product_id: 91, subject_code: CB1
[2025-06-20 11:19:27,502] INFO rules_engine.custom_functions DEBUG: marking_subjects: {'CB1'}
[2025-06-20 11:19:27,502] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:19:27,502] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,502] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}
[2025-06-20 11:19:27,502] INFO rules_engine.custom_functions DEBUG: Final result: True
[2025-06-20 11:19:27,504] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:19:27,504] INFO rules_engine.custom_functions DEBUG: product_id: 91, subject_code: CB1
[2025-06-20 11:19:27,504] INFO rules_engine.custom_functions DEBUG: product_id: 117, subject_code: CB1
[2025-06-20 11:19:27,507] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,507] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}
[2025-06-20 11:19:27,508] INFO rules_engine.custom_functions DEBUG: product_id: 117, subject_code: CB1
[2025-06-20 11:19:27,510] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 11:19:27,510] INFO rules_engine.custom_functions DEBUG: Found marking product 117 with subject CB1
[2025-06-20 11:19:27,510] INFO rules_engine.custom_functions DEBUG: Found marking product 117 with subject CB1
[2025-06-20 11:19:27,510] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 11:19:27,510] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,511] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,512] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,512] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-20 11:19:27,513] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-20 11:19:27,514] INFO rules_engine.custom_functions DEBUG: product_id: 91, subject_code: CB1
[2025-06-20 11:19:27,514] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 11:19:27,514] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 11:19:27,514] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}
[2025-06-20 11:19:27,515] INFO rules_engine.custom_functions DEBUG: marking_subjects: {'CB1'}
[2025-06-20 11:19:27,515] INFO rules_engine.custom_functions DEBUG: marking_subjects: {'CB1'}
[2025-06-20 11:19:27,516] INFO rules_engine.custom_functions DEBUG: product_id: 117, subject_code: CB1
[2025-06-20 11:19:27,517] INFO rules_engine.custom_functions DEBUG: Final result: True
[2025-06-20 11:19:27,517] INFO rules_engine.custom_functions DEBUG: Final result: True
[2025-06-20 11:19:27,517] INFO rules_engine.custom_functions DEBUG: Found marking product 117 with subject CB1
[2025-06-20 11:19:27,523] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:19:27,528] INFO rules_engine.custom_functions DEBUG: product_id: 80, subject_code: CB1
[2025-06-20 11:19:27,529] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 11:19:27,532] INFO rules_engine.custom_functions DEBUG: marking_subjects: {'CB1'}
[2025-06-20 11:19:27,533] INFO rules_engine.custom_functions DEBUG: Final result: True
[2025-06-20 11:19:47,392] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:19:47,392] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 173, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 174, 'product_id': 91, 'subject_code': 'CB1', 'product_name': 'Mini ASET (April 2024 Paper) ', 'product_code': 'MAA', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '10.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}, {'id': 175, 'product_id': 117, 'subject_code': 'CB1', 'product_name': 'Series X Assignments (Marking)', 'product_code': 'X', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '210.00', 'metadata': {'variationId': 3, 'variationName': 'Marking Product'}}, {'id': 176, 'product_id': 80, 'subject_code': 'CB1', 'product_name': 'The Vault', 'product_code': 'VAU', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '70.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:19:47,392] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:19:47,404] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:19:47,404] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 306.0, 'total_vat': 61.2, 'total_gross': 367.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 173, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 174, 'product_name': 'Mini ASET (April 2024 Paper) ', 'net_amount': 10.0, 'vat_amount': 2.0, 'gross_amount': 12.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 175, 'product_name': 'Series X Assignments (Marking)', 'net_amount': 210.0, 'vat_amount': 42.0, 'gross_amount': 252.0, 'vat_rate': 0.2, 'is_exempt': False}, {'item_id': 176, 'product_name': 'The Vault', 'net_amount': 70.0, 'vat_amount': 14.0, 'gross_amount': 84.0, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:19:47,433] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:19:47,436] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 11:19:47,436] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 11:19:47,440] INFO utils.services.queue_service Queued email ce156bd7-8442-4058-b283-41bc1087e22f for 2 recipients
[2025-06-20 11:19:47,441] INFO utils.email_service Email queued successfully: ce156bd7-8442-4058-b283-41bc1087e22f
[2025-06-20 11:19:47,441] INFO cart.views Order confirmation email queued successfully for order ORD-000052 to eugenelo4@bpp.com
[2025-06-20 11:19:52,692] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:19:52,692] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:19:52,693] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:19:52,693] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:19:52,693] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:19:52,695] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:19:52,695] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:19:52,696] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:19:52,710] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:19:52,711] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:19:52,877] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 238, 10)
[2025-06-20 11:19:52,878] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 11:19:52,879] ERROR CSSUTILS No content to parse.
[2025-06-20 11:19:52,880] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 11:19:52,924] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:19:52,925] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:19:52,925] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:19:52,927] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:19:52,928] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:19:52,928] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:19:52,930] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:19:52,931] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:19:52,931] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:19:52,943] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:19:54,088] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:19:54,106] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 11:19:54,112] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:19:54,121] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:19:54,121] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:19:54,121] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:19:54,121] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:19:54,122] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:19:54,122] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:19:54,123] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:19:54,125] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:19:54,128] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:19:54,140] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:19:55,273] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:19:55,274] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 11:19:55,285] INFO utils.services.queue_service Successfully processed queue item ce156bd7-8442-4058-b283-41bc1087e22f
[2025-06-20 11:19:55,290] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 11:24:22,611] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:24:22,611] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:24:22,624] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:24:22,624] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 11:24:22,624] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 11:24:22,626] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 11:24:22,627] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 11:24:22,693] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 11:24:22,769] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:24:22,770] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:24:22,770] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:24:22,771] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:24:22,846] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:24:22,846] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:24:22,848] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:24:22,848] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:24:27,844] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:24:27,844] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,844] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:24:27,844] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:24:27,844] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 177, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:24:27,864] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:24:27,865] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,866] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:24:27,866] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:24:27,867] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:24:27,868] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:24:27,869] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,869] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 177, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:24:27,870] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:24:27,871] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:24:27,872] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:24:27,872] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,873] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:24:27,873] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:24:27,874] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:24:27,875] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:24:27,875] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:24:27,876] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 177, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:24:27,877] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:24:27,877] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:24:27,880] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:24:27,880] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:24:27,880] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,882] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:24:27,883] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:24:27,884] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:24:27,885] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:24:27,886] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:24:27,888] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:24:27,889] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:24:27,889] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:24:27,889] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:24:27,890] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:24:27,891] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:24:27,893] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,897] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:24:27,898] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:24:27,899] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:24:27,901] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:24:27,902] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:24:27,902] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:24:27,904] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:24:27,906] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:24:27,973] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:24:27,973] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,974] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:24:27,974] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:24:27,974] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 177, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:24:27,983] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:24:27,983] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:24:27,983] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:27,983] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:24:27,984] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:24:27,984] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:24:27,984] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:24:27,984] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:24:27,985] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:24:27,985] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:24:27,985] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:24:33,592] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:24:33,593] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 177, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:24:33,593] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:24:33,594] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:24:33,594] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 177, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:24:33,604] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:24:33,607] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 11:24:33,607] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 11:24:33,610] INFO utils.services.queue_service Queued email 666d19c4-ec40-4cb1-a9ad-a9c48c7fec93 for 2 recipients
[2025-06-20 11:24:33,610] INFO utils.email_service Email queued successfully: 666d19c4-ec40-4cb1-a9ad-a9c48c7fec93
[2025-06-20 11:24:33,610] INFO cart.views Order confirmation email queued successfully for order ORD-000053 to eugenelo4@bpp.com
[2025-06-20 11:24:38,594] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:24:38,594] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:24:38,594] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:24:38,594] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:24:38,594] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:24:38,594] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:24:38,599] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:24:38,600] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:24:38,628] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:24:38,628] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:24:38,894] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 11:24:38,895] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 11:24:38,896] ERROR CSSUTILS No content to parse.
[2025-06-20 11:24:38,897] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 11:24:39,059] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:24:39,060] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:24:39,060] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:24:39,060] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:24:39,060] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:24:39,060] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:24:39,060] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:24:39,073] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:24:39,073] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:24:39,120] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:24:40,262] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:24:40,268] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 11:24:40,286] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:24:40,286] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:24:40,286] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:24:40,287] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:24:40,287] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:24:40,287] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:24:40,288] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:24:40,288] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:24:40,289] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:24:40,291] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:24:40,300] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:24:41,320] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:24:41,324] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 11:24:41,329] INFO utils.services.queue_service Successfully processed queue item 666d19c4-ec40-4cb1-a9ad-a9c48c7fec93
[2025-06-20 11:24:41,332] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 11:28:45,796] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:28:45,796] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:28:45,796] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:28:45,796] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:28:45,880] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:28:45,880] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:28:45,880] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:28:45,880] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:28:45,960] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:28:45,960] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:28:45,960] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:28:45,960] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:28:52,729] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:28:52,729] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,733] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:28:52,733] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:28:52,738] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 178, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:28:52,738] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:28:52,740] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,740] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:28:52,741] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:28:52,742] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 178, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:28:52,754] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:28:52,754] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:28:52,755] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:28:52,755] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,756] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:28:52,756] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,756] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:28:52,756] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:28:52,757] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:28:52,757] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:28:52,757] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,757] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:28:52,757] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 178, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:28:52,758] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:28:52,758] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:28:52,759] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:28:52,759] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:28:52,759] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:28:52,760] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:28:52,761] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:28:52,761] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:28:52,763] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:28:52,763] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:28:52,764] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:28:52,765] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:28:52,767] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:28:52,769] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:28:52,770] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:28:52,773] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:28:52,774] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,776] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:28:52,777] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:28:52,780] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:28:52,783] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:28:52,785] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:28:52,787] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:28:52,787] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:28:52,788] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:28:52,858] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:28:52,858] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,858] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:28:52,859] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:28:52,859] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 178, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:28:52,866] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:28:52,866] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:28:52,867] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:52,867] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:28:52,867] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:28:52,867] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:28:52,867] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:28:52,868] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:28:52,868] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:28:52,868] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:28:52,868] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:28:58,598] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:28:58,598] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 178, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:28:58,598] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:28:58,598] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:28:58,598] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 178, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:28:58,614] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:28:58,625] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 11:28:58,625] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 11:28:58,627] INFO utils.services.queue_service Queued email 363d1360-c708-4f44-97b8-1789b5a4c762 for 2 recipients
[2025-06-20 11:28:58,628] INFO utils.email_service Email queued successfully: 363d1360-c708-4f44-97b8-1789b5a4c762
[2025-06-20 11:28:58,628] INFO cart.views Order confirmation email queued successfully for order ORD-000054 to eugenelo4@bpp.com
[2025-06-20 11:29:03,298] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:29:03,298] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:29:03,299] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:29:03,299] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:29:03,299] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:29:03,300] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:29:03,300] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:29:03,301] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:29:03,321] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:29:03,322] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:29:03,476] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 11:29:03,477] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 11:29:03,478] ERROR CSSUTILS No content to parse.
[2025-06-20 11:29:03,478] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 11:29:03,539] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:29:03,540] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:29:03,541] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:29:03,542] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:29:03,542] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:29:03,543] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:29:03,544] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:29:03,544] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:29:03,546] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:29:03,570] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:29:04,670] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:29:04,675] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 11:29:04,689] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:29:04,690] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:29:04,690] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:29:04,690] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:29:04,691] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:29:04,691] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:29:04,691] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:29:04,691] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:29:04,693] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:29:04,693] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:29:04,711] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:29:05,820] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:29:05,823] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 11:29:05,827] INFO utils.services.queue_service Successfully processed queue item 363d1360-c708-4f44-97b8-1789b5a4c762
[2025-06-20 11:29:05,829] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 11:54:47,812] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 11:54:47,847] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 11:54:47,877] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 11:54:47,896] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 11:54:47,927] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 11:54:47,975] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 11:54:48,005] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 11:54:51,071] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:54:51,078] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:54:51,079] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:54:51,080] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 11:54:51,082] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 11:54:51,127] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:54:51,129] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 11:54:51,129] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 11:54:51,131] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 11:54:51,131] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 11:54:51,366] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 11:54:51,369] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 11:54:51,382] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 11:54:51,389] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-20 11:54:51,564] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_540664511747037862
[2025-06-20 11:54:51,622] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:54:51,625] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:54:51,626] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:54:51,627] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:54:51,772] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_-5616254373995419659
[2025-06-20 11:54:51,882] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:54:51,882] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 11:54:51,883] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 11:54:51,884] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:54:51,947] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:54:51,948] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 11:54:51,948] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 11:54:51,950] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:54:59,988] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:54:59,999] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 11:54:59,999] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:54:59,999] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:54:59,999] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 11:55:00,003] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 11:55:00,009] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:00,010] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:00,010] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 11:55:00,010] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:00,010] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:00,011] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:00,011] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:00,012] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:00,012] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:00,052] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:00,053] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:00,053] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:00,054] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:00,056] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:00,071] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:00,074] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:00,077] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:00,079] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:00,081] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:00,085] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:00,086] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:55:00,090] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:55:00,094] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:00,095] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:00,096] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:00,097] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 11:55:00,098] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:00,098] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:00,102] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:00,103] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:00,103] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 11:55:00,107] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:00,111] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:00,112] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 11:55:00,115] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:00,120] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:00,121] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:00,125] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:00,127] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 11:55:00,129] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:00,129] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:00,130] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:00,132] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:00,133] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:00,133] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:00,133] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:00,133] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:00,133] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:00,135] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:00,135] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:00,135] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:00,137] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:55:00,139] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:55:00,139] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:00,139] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:00,140] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:03,227] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:55:03,227] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 11:55:03,228] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 11:55:03,229] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:55:03,425] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 11:55:03,425] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 11:55:03,426] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 11:55:03,426] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 11:55:03,530] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:03,531] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,531] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:03,531] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:03,532] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:03,552] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:03,554] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:03,554] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,554] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:03,556] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:03,556] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:03,556] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:55:03,557] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:55:03,558] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:03,558] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:03,559] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:03,591] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:03,591] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,592] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:03,593] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:03,596] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:03,609] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:03,610] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,612] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:03,612] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:03,612] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:03,612] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:03,613] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:03,613] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,614] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:03,614] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:03,614] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:03,615] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:55:03,616] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:55:03,616] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:03,617] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:03,618] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:03,624] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:03,625] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:03,625] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,627] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:03,628] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:03,628] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:03,629] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:55:03,631] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:55:03,633] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:03,635] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:03,635] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:03,688] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:03,688] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,689] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:03,690] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:03,690] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:03,693] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:03,693] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,693] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:03,694] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:03,695] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:03,701] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:03,704] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:03,705] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,705] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 11:55:03,705] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:03,706] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 11:55:03,706] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:03,706] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:03,706] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:03,707] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 11:55:03,707] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:55:03,707] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 11:55:03,707] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:55:03,707] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 11:55:03,708] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:03,708] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 11:55:03,708] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:03,708] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 11:55:03,709] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:03,709] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 11:55:03,710] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 11:55:03,710] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 11:55:09,457] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 11:55:09,457] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 180, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 11:55:09,457] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 11:55:09,457] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 11:55:09,457] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 180, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 11:55:09,475] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:55:09,478] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 11:55:09,478] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 11:55:09,481] INFO utils.services.queue_service Queued email 3330b4ef-72fe-4039-ae9d-68fa632c1136 for 2 recipients
[2025-06-20 11:55:09,482] INFO utils.email_service Email queued successfully: 3330b4ef-72fe-4039-ae9d-68fa632c1136
[2025-06-20 11:55:09,482] INFO cart.views Order confirmation email queued successfully for order ORD-000055 to eugenelo4@bpp.com
[2025-06-20 11:55:14,713] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:55:14,714] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:55:14,714] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:55:14,714] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:55:14,714] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:55:14,718] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:55:14,718] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:55:14,719] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:55:14,737] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:55:14,740] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:55:14,876] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 11:55:14,876] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 11:55:14,876] ERROR CSSUTILS No content to parse.
[2025-06-20 11:55:14,876] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 11:55:14,944] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:55:14,945] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 11:55:14,946] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:55:14,947] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:55:14,948] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 11:55:14,948] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:55:14,950] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:55:14,951] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 11:55:14,951] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 11:55:14,961] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:55:16,178] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:55:16,182] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 11:55:16,188] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 11:55:16,189] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 11:55:16,189] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 11:55:16,190] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 11:55:16,190] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 11:55:16,190] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 11:55:16,191] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 11:55:16,191] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 11:55:16,192] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:55:16,193] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 11:55:16,209] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 11:55:17,387] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 11:55:17,387] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 11:55:17,402] INFO utils.services.queue_service Successfully processed queue item 3330b4ef-72fe-4039-ae9d-68fa632c1136
[2025-06-20 11:55:17,405] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 11:59:36,811] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-20 11:59:38,541] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:01:32,458] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 12:01:33,893] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:01:47,160] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 12:01:49,297] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:02:39,084] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\admin.py changed, reloading.
[2025-06-20 12:02:41,184] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:03:03,959] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\admin.py changed, reloading.
[2025-06-20 12:03:05,090] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:04:14,033] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\admin.py changed, reloading.
[2025-06-20 12:04:17,131] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:16:23,244] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-20 12:16:28,398] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:16:37,201] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-20 12:16:40,766] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:16:49,040] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-20 12:16:54,434] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:25:06,509] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\models.py changed, reloading.
[2025-06-20 12:25:07,600] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:26:52,402] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:26:52,403] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:26:52,404] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:26:52,405] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 12:26:52,405] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 12:26:52,409] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 12:26:52,410] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 12:26:52,554] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_4269673648905438443
[2025-06-20 12:26:52,743] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:26:52,743] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:26:52,743] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:26:52,750] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:26:52,909] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:26:52,910] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:26:52,910] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:26:52,911] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:27:07,710] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:27:07,710] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:27:07,710] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,710] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,710] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:27:07,725] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:27:07,728] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:27:07,729] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:27:07,730] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:27:07,731] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 181, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:27:07,732] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,732] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 181, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:27:07,734] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:27:07,735] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:27:07,736] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:27:07,737] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,738] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 181, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:27:07,743] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:27:07,747] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:27:07,750] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:27:07,751] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:27:07,752] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:27:07,753] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 181, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:27:07,754] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:27:07,755] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:27:07,755] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,756] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,756] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:27:07,756] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:27:07,757] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:27:07,758] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,758] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:27:07,759] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:27:07,761] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:27:07,763] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:27:07,764] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:27:07,765] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:27:07,765] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:27:07,766] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:27:07,766] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:27:07,766] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:27:07,767] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:27:07,767] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 12:27:07,767] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 12:27:07,768] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:07,768] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:27:07,768] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 12:27:07,768] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 12:27:07,769] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:27:07,769] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 12:27:07,769] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 12:27:07,770] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 12:27:07,770] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:27:07,770] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 12:27:07,770] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:27:07,771] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:27:07,771] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:27:07,771] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 12:27:07,771] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:27:07,772] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:27:07,772] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:27:07,772] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:27:07,780] INFO rules_engine.custom_functions DEBUG: product_id: 89, subject_code: CB1
[2025-06-20 12:27:07,781] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:27:07,784] INFO rules_engine.custom_functions DEBUG: Found assignment product 89 with subject CB1
[2025-06-20 12:27:07,787] INFO rules_engine.custom_functions DEBUG: assignment_subjects: {'CB1'}
[2025-06-20 12:27:07,789] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:27:07,794] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:27:14,427] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:27:14,427] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 181, 'product_id': 89, 'subject_code': 'CB1', 'product_name': 'Mock Exam', 'product_code': 'M1', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '16.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:27:14,427] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:27:14,427] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:27:14,427] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 16.0, 'total_vat': 3.2, 'total_gross': 19.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 181, 'product_name': 'Mock Exam', 'net_amount': 16.0, 'vat_amount': 3.2, 'gross_amount': 19.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:27:14,447] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:27:14,454] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 12:27:14,454] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 12:27:14,457] INFO utils.services.queue_service Queued email 81e15b2a-4ad3-40dd-8821-a6a09fede9f5 for 2 recipients
[2025-06-20 12:27:14,457] INFO utils.email_service Email queued successfully: 81e15b2a-4ad3-40dd-8821-a6a09fede9f5
[2025-06-20 12:27:14,457] INFO cart.views Order confirmation email queued successfully for order ORD-000056 to eugenelo4@bpp.com
[2025-06-20 12:27:21,238] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 12:27:21,239] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 12:27:21,239] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 12:27:21,240] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 12:27:21,240] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 12:27:21,240] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 12:27:21,240] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 12:27:21,240] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 12:27:21,260] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:27:21,260] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:27:21,260] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:27:21,551] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 12:27:21,553] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 12:27:21,554] ERROR CSSUTILS No content to parse.
[2025-06-20 12:27:21,555] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 12:27:21,638] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:27:21,639] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:27:21,640] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:27:21,643] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:27:21,643] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:27:21,644] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:27:21,647] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:27:21,648] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:27:21,649] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:27:21,667] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:27:22,977] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:27:22,982] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 12:27:23,001] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 12:27:23,002] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 12:27:23,002] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 12:27:23,003] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 12:27:23,003] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 12:27:23,003] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 12:27:23,004] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 12:27:23,004] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 12:27:23,007] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:27:23,007] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:27:23,009] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:27:23,059] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:27:24,423] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:27:24,428] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 12:27:24,435] INFO utils.services.queue_service Successfully processed queue item 81e15b2a-4ad3-40dd-8821-a6a09fede9f5
[2025-06-20 12:27:24,440] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 12:33:56,787] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-20 12:33:59,154] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:34:10,731] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-20 12:34:12,771] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:35:11,728] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 12:35:11,745] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:35:11,748] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:35:11,749] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:35:11,917] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 12:35:11,917] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 12:35:11,918] ERROR CSSUTILS No content to parse.
[2025-06-20 12:35:11,918] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 12:35:11,973] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:11,973] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:11,974] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:35:11,976] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:11,976] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:11,977] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:35:11,979] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:11,981] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:11,981] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:35:11,998] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:35:13,138] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:35:20,913] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 12:35:20,920] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:35:20,920] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:35:20,935] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:35:21,082] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 12:35:21,082] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 12:35:21,084] ERROR CSSUTILS No content to parse.
[2025-06-20 12:35:21,086] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 12:35:21,128] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:21,129] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:21,129] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:35:21,130] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:21,131] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:21,132] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:35:21,134] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:21,135] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:35:21,135] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:35:21,145] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:35:22,223] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:35:45,385] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-20 12:35:46,623] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:35:56,505] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-20 12:35:57,512] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 12:36:24,912] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 12:36:24,932] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:36:24,935] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:36:24,938] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:36:25,136] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 12:36:25,138] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 12:36:25,138] ERROR CSSUTILS No content to parse.
[2025-06-20 12:36:25,138] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 12:36:25,204] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:25,204] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:25,204] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:36:25,216] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:25,216] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:25,216] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:36:25,218] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:25,219] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:25,220] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:36:25,229] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:36:26,343] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:36:35,846] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 12:36:35,860] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:36:35,868] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:36:35,869] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:36:36,021] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 12:36:36,021] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 12:36:36,021] ERROR CSSUTILS No content to parse.
[2025-06-20 12:36:36,021] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 12:36:36,084] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:36,085] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:36,085] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:36:36,086] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:36,087] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:36,088] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:36:36,089] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:36,089] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:36:36,089] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:36:36,100] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:36:37,087] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:47:54,371] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:47:54,371] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:47:54,371] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:47:54,371] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 12:47:54,371] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 12:47:54,371] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 12:47:54,371] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 12:47:54,448] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4250429161055748990
[2025-06-20 12:47:54,526] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:47:54,526] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:47:54,526] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:47:54,527] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:47:54,601] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:47:54,601] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:47:54,601] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:47:54,601] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:48:47,641] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:48:47,641] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:48:47,642] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:48:47,642] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,644] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,644] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,645] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:48:47,646] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:48:47,647] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:48:47,647] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:48:47,648] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:48:47,649] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:48:47,649] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:48:47,649] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 182, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:48:47,649] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 182, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:48:47,650] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,650] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 182, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:48:47,652] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:48:47,659] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:48:47,664] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 182, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:48:47,665] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:48:47,665] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:48:47,666] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:48:47,667] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:48:47,667] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:48:47,668] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,668] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:48:47,669] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,670] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:48:47,670] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,671] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:48:47,671] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:48:47,671] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:48:47,671] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:48:47,672] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:48:47,672] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:48:47,672] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:48:47,672] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:48:47,672] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:48:47,674] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:48:47,674] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:48:47,674] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:48:47,674] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:48:47,675] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:48:47,675] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:48:47,676] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:48:47,676] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:48:47,676] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:48:47,676] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:48:47,677] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:48:47,677] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:48:47,677] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:48:47,677] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:48:47,678] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:48:47,678] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:48:47,678] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:48:47,678] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:48:47,678] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:48:47,678] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:48:47,681] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:48:47,682] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:48:47,683] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:48:47,686] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:48:47,693] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:49:09,724] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:49:09,724] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 182, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:49:09,724] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:49:09,724] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:49:09,724] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 182, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:49:09,753] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:49:09,759] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 12:49:09,760] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 12:49:09,763] INFO utils.services.queue_service Queued email e67d2b23-d58a-4f6f-b8f6-b0b6faa29573 for 2 recipients
[2025-06-20 12:49:09,763] INFO utils.email_service Email queued successfully: e67d2b23-d58a-4f6f-b8f6-b0b6faa29573
[2025-06-20 12:49:09,765] INFO cart.views Order confirmation email queued successfully for order ORD-000057 to eugenelo4@bpp.com
[2025-06-20 12:49:17,598] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 12:49:17,598] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 12:49:17,598] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 12:49:17,604] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 12:49:17,604] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 12:49:17,605] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 12:49:17,605] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 12:49:17,606] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 12:49:17,623] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:49:17,631] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:49:17,632] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:49:17,786] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 12:49:17,788] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 12:49:17,789] ERROR CSSUTILS No content to parse.
[2025-06-20 12:49:17,789] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 12:49:17,824] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:49:17,824] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:49:17,824] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:49:17,838] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:49:17,839] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:49:17,839] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:49:17,842] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:49:17,842] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:49:17,842] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:49:17,850] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:49:19,026] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:49:19,031] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 12:49:19,042] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 12:49:19,043] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 12:49:19,043] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 12:49:19,043] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 12:49:19,044] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 12:49:19,044] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 12:49:19,044] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 12:49:19,045] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 12:49:19,046] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:49:19,046] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:49:19,047] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:49:19,065] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:49:20,217] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:49:20,221] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 12:49:20,231] INFO utils.services.queue_service Successfully processed queue item e67d2b23-d58a-4f6f-b8f6-b0b6faa29573
[2025-06-20 12:49:20,234] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 12:57:11,777] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 12:57:11,777] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 12:57:11,777] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 12:57:11,783] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 12:57:11,785] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 12:57:11,786] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 12:57:11,875] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 12:57:13,965] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:13,965] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 12:57:13,966] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 12:57:13,966] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 12:57:13,967] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:13,967] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 12:57:13,967] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:57:13,970] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:57:13,971] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 12:57:13,971] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 12:57:13,972] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 12:57:13,974] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-20 12:57:13,976] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 12:57:13,978] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 12:57:14,198] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4250429161055748990
[2025-06-20 12:57:14,312] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_-1426505643509434757
[2025-06-20 12:57:14,408] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:14,409] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:57:14,409] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:57:14,411] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:14,522] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:14,523] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 12:57:14,523] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 12:57:14,526] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:14,593] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:14,593] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:57:14,594] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:57:14,595] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:15,801] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:15,801] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:57:15,802] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:57:15,804] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:15,860] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:15,861] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 12:57:15,861] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 12:57:15,863] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:16,103] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:16,104] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:57:16,104] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:57:16,106] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:16,266] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:16,268] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 12:57:16,268] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 12:57:16,270] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:16,477] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:16,478] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 12:57:16,479] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 12:57:16,479] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:23,759] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:23,776] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 12:57:23,780] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:23,783] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:23,784] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 12:57:23,795] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 12:57:23,805] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:23,808] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 12:57:23,810] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:23,810] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:23,810] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:23,811] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:23,812] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 12:57:23,812] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 12:57:23,815] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:23,816] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:23,818] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:23,819] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 12:57:23,819] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:23,821] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:23,823] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:23,825] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:23,828] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:23,828] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:23,829] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:23,829] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:23,832] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:23,832] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 12:57:23,832] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:23,833] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:23,835] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:23,839] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:23,841] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:23,843] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:23,845] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:23,849] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:23,852] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:23,856] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:23,858] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:23,860] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:23,863] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:23,864] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:57:23,864] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:57:23,865] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:23,866] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:23,867] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:23,922] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:23,924] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:23,925] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:23,927] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:23,928] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:23,940] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:23,940] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:23,941] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:23,941] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:23,942] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:23,942] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:23,943] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:57:23,943] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:57:23,944] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:23,944] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:23,944] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:25,721] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:25,722] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 12:57:25,723] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 12:57:25,724] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:25,913] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 12:57:25,913] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 12:57:25,914] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 12:57:25,915] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 12:57:26,030] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:26,030] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,031] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:26,031] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:26,031] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:26,040] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:26,040] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:26,040] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,040] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:26,049] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:26,050] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:26,050] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:57:26,050] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:57:26,052] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:26,052] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:26,053] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:26,106] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:26,107] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,108] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:26,110] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:26,112] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:26,131] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:26,133] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:26,133] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,133] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:26,135] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:26,135] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:26,136] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:57:26,136] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:57:26,136] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:26,138] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:26,140] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:26,154] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:26,156] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,158] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:26,161] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:26,162] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:26,184] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:26,185] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:26,189] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,190] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:26,190] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:26,191] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:26,192] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:57:26,195] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:57:26,198] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:26,199] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:26,199] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:26,241] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:26,246] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,249] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:26,252] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:26,254] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:26,256] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:26,258] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,261] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:26,263] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:26,264] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:26,272] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:26,273] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:26,273] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,276] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:26,279] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:26,283] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:26,285] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:57:26,287] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 12:57:26,287] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:57:26,288] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 12:57:26,288] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:26,289] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:26,289] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:26,291] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 12:57:26,291] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:26,292] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 12:57:26,294] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 12:57:26,294] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 12:57:26,296] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 12:57:26,296] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 12:57:26,297] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 12:57:26,300] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 12:57:31,441] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 12:57:31,441] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 184, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 12:57:31,441] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 12:57:31,455] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 12:57:31,455] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 184, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 12:57:31,462] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:57:31,474] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 12:57:31,474] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 12:57:31,477] INFO utils.services.queue_service Queued email 43b9d781-4cfe-441f-9685-ee399f2b68a8 for 2 recipients
[2025-06-20 12:57:31,478] INFO utils.email_service Email queued successfully: 43b9d781-4cfe-441f-9685-ee399f2b68a8
[2025-06-20 12:57:31,479] INFO cart.views Order confirmation email queued successfully for order ORD-000058 to eugenelo4@bpp.com
[2025-06-20 12:57:36,890] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 12:57:36,891] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 12:57:36,892] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 12:57:36,892] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 12:57:36,893] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 12:57:36,893] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 12:57:36,894] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 12:57:36,894] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 12:57:36,911] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:57:36,915] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:57:36,917] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:57:37,102] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 12:57:37,104] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 12:57:37,105] ERROR CSSUTILS No content to parse.
[2025-06-20 12:57:37,106] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 12:57:37,169] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:57:37,170] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 12:57:37,171] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:57:37,172] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:57:37,174] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 12:57:37,175] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:57:37,176] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:57:37,183] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 12:57:37,184] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 12:57:37,198] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:57:38,405] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:57:38,417] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 12:57:38,425] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 12:57:38,425] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 12:57:38,425] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 12:57:38,425] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 12:57:38,425] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 12:57:38,425] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 12:57:38,425] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 12:57:38,432] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 12:57:38,433] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 12:57:38,433] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:57:38,434] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 12:57:38,440] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 12:57:39,541] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 12:57:39,554] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 12:57:39,562] INFO utils.services.queue_service Successfully processed queue item 43b9d781-4cfe-441f-9685-ee399f2b68a8
[2025-06-20 12:57:39,567] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 13:04:52,868] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 13:04:52,871] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 13:04:52,871] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 13:04:52,872] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 13:04:52,872] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 13:04:52,874] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 13:04:52,875] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 13:04:52,926] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_-4250429161055748990
[2025-06-20 13:04:53,003] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 13:04:53,003] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 13:04:53,003] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 13:04:53,003] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 13:04:53,076] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 13:04:53,076] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 13:04:53,076] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 13:04:53,078] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 13:04:53,245] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 13:04:53,245] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'subject': ['7'], 'page': ['1'], 'page_size': ['20']}>
[2025-06-20 13:04:53,245] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 13:04:53,245] INFO exam_sessions_subjects_products.views Filtering subject_ids: ['7'], subject_code: None
[2025-06-20 13:04:53,248] INFO exam_sessions_subjects_products.views After subject_ids filter, queryset count: 22
[2025-06-20 13:04:53,248] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 13:04:53,249] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 22
[2025-06-20 13:04:53,250] INFO exam_sessions_subjects_products.views Pagination: total=22, start=0, end=20, page_size=20
[2025-06-20 13:04:53,317] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 22, cached with key: products_list_-3166617803203189717
[2025-06-20 13:04:53,386] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 13:04:53,386] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'subject': ['7'], 'page': ['1'], 'page_size': ['20']}>
[2025-06-20 13:04:53,386] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 13:04:53,386] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 13:05:00,354] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 13:05:00,354] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 13:05:00,354] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,370] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,370] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 13:05:00,370] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 13:05:00,371] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 13:05:00,371] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 13:05:00,371] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 13:05:00,371] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 185, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 13:05:00,377] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 185, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 13:05:00,378] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,380] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 13:05:00,381] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 13:05:00,382] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 13:05:00,383] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 185, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 13:05:00,385] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,385] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 13:05:00,387] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 13:05:00,389] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 13:05:00,390] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 13:05:00,391] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 13:05:00,392] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 13:05:00,393] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,394] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,394] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 185, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 13:05:00,395] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 13:05:00,395] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 13:05:00,395] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 13:05:00,396] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 13:05:00,396] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 13:05:00,397] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 13:05:00,397] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,397] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 13:05:00,399] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 13:05:00,400] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 13:05:00,400] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 13:05:00,401] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 13:05:00,401] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 13:05:00,402] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CM2
[2025-06-20 13:05:00,402] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 13:05:00,402] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CM2
[2025-06-20 13:05:00,402] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 13:05:00,403] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 13:05:00,403] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 13:05:00,403] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 13:05:00,403] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 13:05:00,403] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 13:05:00,404] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:00,404] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 13:05:00,404] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CM2
[2025-06-20 13:05:00,405] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 13:05:00,405] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 13:05:00,405] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 13:05:00,406] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 13:05:00,408] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 13:05:00,410] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 13:05:00,412] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 13:05:00,413] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 13:05:00,415] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 13:05:00,419] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CM2
[2025-06-20 13:05:00,421] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 13:05:00,424] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 13:05:00,427] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 13:05:06,595] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 13:05:06,595] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 185, 'product_id': 71, 'subject_code': 'CM2', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '42.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 13:05:06,596] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 13:05:06,596] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 13:05:06,596] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 42.0, 'total_vat': 8.4, 'total_gross': 50.4, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 185, 'product_name': 'Additional Mock Pack', 'net_amount': 42.0, 'vat_amount': 8.4, 'gross_amount': 50.4, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 13:05:06,613] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 13:05:06,616] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 13:05:06,617] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 13:05:06,619] INFO utils.services.queue_service Queued email 5bfc4f6b-2ec4-4257-aa28-fa60c7a7c258 for 2 recipients
[2025-06-20 13:05:06,621] INFO utils.email_service Email queued successfully: 5bfc4f6b-2ec4-4257-aa28-fa60c7a7c258
[2025-06-20 13:05:06,621] INFO cart.views Order confirmation email queued successfully for order ORD-000059 to eugenelo4@bpp.com
[2025-06-20 13:05:12,992] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 13:05:12,992] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 13:05:13,005] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 13:05:13,005] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 13:05:13,006] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 13:05:13,006] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 13:05:13,006] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 13:05:13,006] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 13:05:13,023] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 13:05:13,026] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 13:05:13,027] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 13:05:13,177] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 13:05:13,177] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 13:05:13,178] ERROR CSSUTILS No content to parse.
[2025-06-20 13:05:13,179] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 13:05:13,226] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 13:05:13,226] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 13:05:13,226] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 13:05:13,226] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 13:05:13,226] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 13:05:13,226] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 13:05:13,226] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 13:05:13,226] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 13:05:13,238] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 13:05:13,248] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 13:05:14,442] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 13:05:14,455] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 13:05:14,462] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 13:05:14,462] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 13:05:14,462] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 13:05:14,462] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 13:05:14,462] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 13:05:14,462] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 13:05:14,462] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 13:05:14,470] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 13:05:14,471] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 13:05:14,471] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 13:05:14,472] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 13:05:14,488] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 13:05:15,525] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 13:05:15,528] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 13:05:15,528] INFO utils.services.queue_service Successfully processed queue item 5bfc4f6b-2ec4-4257-aa28-fa60c7a7c258
[2025-06-20 13:05:15,540] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 13:18:24,263] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-20 13:18:25,236] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 13:18:37,925] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\cart\views.py changed, reloading.
[2025-06-20 13:18:39,736] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 13:19:24,122] INFO utils.services.content_insertion_service Processed 2 placeholders in template order_confirmation
[2025-06-20 13:19:41,262] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 13:19:41,280] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 13:19:41,283] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 13:19:41,285] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 13:19:41,422] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 13:19:41,422] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 13:19:41,424] ERROR CSSUTILS No content to parse.
[2025-06-20 13:19:41,424] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 13:19:41,465] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 13:19:41,466] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 13:19:41,468] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 13:19:41,469] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 13:19:41,470] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 13:19:41,470] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 13:19:41,474] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 13:19:41,474] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 13:19:41,475] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 13:19:41,485] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 13:19:42,679] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:24:42,121] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 14:24:42,121] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 14:24:42,121] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 14:24:42,128] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 14:24:42,129] WARNING django.request Unauthorized: /api/products/product-group-filters/
[2025-06-20 14:24:42,130] WARNING django.request Unauthorized: /api/subjects/
[2025-06-20 14:24:42,220] WARNING django.request Unauthorized: /api/products/current/list/
[2025-06-20 14:24:44,044] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:44,044] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:24:44,045] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:24:44,046] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 14:24:44,046] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 14:24:44,048] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 14:24:44,050] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 14:24:44,077] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:44,087] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:24:44,088] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:24:44,088] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 14:24:44,089] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 14:24:44,098] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 14:24:44,100] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=50, page_size=50
[2025-06-20 14:24:44,162] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_5288912844303394431
[2025-06-20 14:24:44,286] INFO exam_sessions_subjects_products.views Paginated queryset count: 50, total: 393, cached with key: products_list_-8921247985221935298
[2025-06-20 14:24:44,359] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:44,361] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:24:44,361] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:24:44,362] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:44,505] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:44,506] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:24:44,506] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:24:44,507] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:44,579] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:44,579] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:24:44,580] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:24:44,580] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:45,119] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:45,121] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:24:45,121] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:24:45,121] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:45,156] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:45,156] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:24:45,158] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:24:45,159] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:45,333] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:45,334] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:24:45,334] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:24:45,335] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:45,449] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:45,450] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:24:45,450] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:24:45,451] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:45,641] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:24:45,644] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:24:45,644] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:24:45,645] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:24:52,551] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:24:52,551] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 14:24:52,551] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:24:52,568] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:24:52,571] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:24:52,571] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:24:52,572] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:24:52,574] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 14:24:52,575] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 14:24:52,577] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:24:52,584] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:24:52,585] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:24:52,585] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 0, 'total_vat': 0, 'total_gross': 0, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [], 'calculation_timestamp': None}
[2025-06-20 14:24:52,590] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 14:24:52,590] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:24:52,596] DEBUG rules_engine.models Field 'cart_value' not found in path 'cart_value', returning None
[2025-06-20 14:24:52,596] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:24:52,603] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:24:52,606] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:24:52,606] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:24:52,608] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:24:52,608] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:24:52,608] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 14:24:52,609] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:24:52,610] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:24:52,611] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:24:52,612] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:24:52,612] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:24:52,612] INFO rules_engine.custom_functions DEBUG: cart_items: []
[2025-06-20 14:24:52,612] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:24:52,612] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:24:52,612] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:24:52,613] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:24:52,613] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:24:52,613] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:24:52,613] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:24:52,613] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:24:52,615] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:24:52,615] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:24:52,615] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:24:52,615] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:24:52,615] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:24:52,616] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:24:52,618] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:24:52,618] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:24:52,622] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:24:52,623] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:24:52,625] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:24:52,628] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:24:52,628] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:24:52,629] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:24:52,631] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:24:52,633] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:24:52,635] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:24:52,638] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:24:52,639] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:24:52,641] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:24:52,643] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:24:52,646] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:24:52,647] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:24:52,650] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:24:52,654] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:18,923] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:26:18,925] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:26:18,925] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:26:18,927] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:26:19,034] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:26:19,035] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:26:19,035] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:26:19,036] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:26:19,287] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:19,290] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,293] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:19,293] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:19,293] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:19,297] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:19,299] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,302] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:19,303] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:19,304] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:19,307] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:19,308] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:19,309] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:19,310] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,310] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,311] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:19,311] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:19,312] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:19,312] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:19,312] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:19,312] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:19,312] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:19,313] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:19,313] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,314] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:19,314] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:19,314] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:19,315] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:19,316] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:19,316] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:19,317] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:19,317] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:19,317] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:19,319] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:19,321] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:19,322] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:19,322] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:19,324] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:19,325] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:19,325] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,327] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:19,328] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:19,330] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:19,332] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:19,333] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:19,336] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:19,340] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:19,342] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:19,469] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,481] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:19,481] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:19,481] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:19,481] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:19,482] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:19,482] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:19,482] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:19,484] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:19,484] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:19,484] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:19,489] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:19,489] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:19,490] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:19,490] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:19,491] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:19,491] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:19,492] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:19,493] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:19,493] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:19,494] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:19,494] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:42,315] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:26:42,317] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:26:42,317] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:26:42,318] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:26:42,457] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:26:42,457] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['50']}>
[2025-06-20 14:26:42,457] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=50
[2025-06-20 14:26:42,458] INFO exam_sessions_subjects_products.views Returning cached products data
[2025-06-20 14:26:42,728] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:42,729] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,729] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:42,729] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:42,730] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:42,744] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:42,745] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:42,747] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,751] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:42,752] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:42,756] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:42,759] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:42,760] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:42,761] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:42,763] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:42,767] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:42,768] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:42,772] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,776] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:42,779] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:42,781] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:42,785] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:42,791] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,794] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:42,796] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:42,799] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:42,801] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:42,805] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:42,806] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,810] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:42,811] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:42,812] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:42,812] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:42,812] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:42,813] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:42,813] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:42,813] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,813] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:42,814] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:42,814] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:42,814] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:42,814] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:42,814] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:42,816] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:42,816] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:42,817] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:42,817] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:42,818] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:42,883] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:42,885] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,885] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:42,885] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:42,886] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:42,893] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:42,893] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:42,893] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,895] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:42,895] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:42,895] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:42,895] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:42,895] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:42,896] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:42,896] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:42,896] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:26:42,943] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:26:42,944] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,944] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:26:42,944] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:26:42,945] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:26:42,950] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:26:42,952] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:26:42,952] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:26:42,952] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:26:42,953] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:26:42,953] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:26:42,953] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:26:42,953] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:26:42,953] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:26:42,954] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:26:42,954] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:27:41,289] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:27:41,289] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:27:41,290] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:27:41,290] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:27:41,290] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:27:41,300] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:27:41,300] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:27:41,301] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:27:41,301] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:27:41,301] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:27:41,303] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:27:41,304] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:27:41,305] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:27:41,305] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:27:41,306] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:27:41,306] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:27:56,974] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:27:56,975] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:27:56,976] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:27:56,976] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:27:56,976] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:27:56,982] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:27:56,982] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:27:56,983] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:27:56,983] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:27:56,984] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:27:56,984] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:27:56,985] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:27:56,985] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:27:56,985] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:27:56,986] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:27:56,986] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:29:10,835] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:29:10,836] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:29:10,836] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:29:10,836] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:29:10,837] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:29:10,845] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:29:10,845] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:29:10,845] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:29:10,850] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:29:10,850] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:29:10,850] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:29:10,852] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:29:10,852] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:29:10,853] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:29:10,853] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:29:10,853] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:29:56,067] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:29:56,068] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:29:56,069] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:29:56,070] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:29:56,070] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:29:56,085] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:29:56,086] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:29:56,087] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:29:56,088] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:29:56,088] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:29:56,089] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:29:56,089] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:29:56,090] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:29:56,090] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:29:56,091] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:29:56,091] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:31:08,126] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:31:08,127] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:31:08,127] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:31:08,128] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:31:08,129] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:31:08,146] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:31:08,146] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:31:08,147] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:31:08,147] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:31:08,148] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:31:08,148] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:31:08,149] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:31:08,150] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:31:08,150] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:31:08,150] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:31:08,150] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:31:26,833] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:31:26,834] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:31:26,835] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:31:26,835] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:31:26,837] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:31:26,853] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:31:26,854] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:31:26,855] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:31:26,856] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:31:26,857] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:31:26,857] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:31:26,857] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:31:26,858] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:31:26,858] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:31:26,860] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:31:26,860] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:31:51,654] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:31:51,654] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:31:51,655] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:31:51,656] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:31:51,656] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:31:51,670] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:31:51,671] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:31:51,671] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:31:51,672] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:31:51,672] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:31:51,673] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:31:51,673] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:31:51,674] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:31:51,674] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:31:51,675] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:31:51,675] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:32:01,511] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:32:01,511] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:32:01,511] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:32:01,511] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:32:01,511] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:32:01,527] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:32:01,528] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:32:01,528] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:32:01,529] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:32:01,529] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:32:01,529] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:32:01,530] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:32:01,530] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:32:01,531] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:32:01,531] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:32:01,531] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:32:58,935] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:32:58,935] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:32:58,935] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:32:58,940] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:32:58,940] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:32:58,953] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:32:58,954] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:32:58,954] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:32:58,955] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:32:58,955] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:32:58,955] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:32:58,956] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:32:58,957] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:32:58,957] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:32:58,957] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:32:58,958] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:34:54,661] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:34:54,662] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:34:54,663] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:34:54,664] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:34:54,664] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:34:54,682] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:34:54,682] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:34:54,684] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:35:13,039] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:35:13,039] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:35:13,040] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:35:13,040] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:35:13,041] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:35:13,051] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:35:13,052] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:35:13,052] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:35:13,053] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:35:13,053] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:35:13,053] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:35:13,054] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:35:13,055] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:35:13,056] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:35:13,056] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:35:13,056] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:36:08,248] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:36:08,248] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:36:08,249] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:36:08,250] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:36:08,250] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:36:08,257] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:36:08,258] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:36:08,258] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:36:08,259] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:36:08,259] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:36:08,259] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:36:08,260] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:36:08,260] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:36:08,260] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:36:08,260] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:36:08,261] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:36:33,342] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:36:33,357] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:36:33,357] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:36:33,358] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:36:33,358] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:36:33,358] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:36:33,359] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:36:33,359] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:37:58,823] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:37:58,823] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 187, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 1, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:37:58,823] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:37:58,823] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:37:58,823] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 21.0, 'total_vat': 4.2, 'total_gross': 25.2, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 187, 'product_name': 'Additional Mock Pack', 'net_amount': 21.0, 'vat_amount': 4.2, 'gross_amount': 25.2, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:37:58,842] INFO cart.views Using default country 'United Kingdom' for user eugenelo4@bpp.com
[2025-06-20 14:37:58,863] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:37:58,874] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 14:37:58,875] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 14:37:58,878] INFO utils.services.queue_service Queued email e050078f-db91-49e0-b2a0-27a0319d0ccc for 2 recipients
[2025-06-20 14:37:58,879] INFO utils.email_service Email queued successfully: e050078f-db91-49e0-b2a0-27a0319d0ccc
[2025-06-20 14:37:58,879] INFO cart.views Order confirmation email queued successfully for order ORD-000060 to eugenelo4@bpp.com
[2025-06-20 14:38:10,204] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 14:38:10,204] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 14:38:10,205] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 14:38:10,205] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 14:38:10,205] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 14:38:10,206] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 14:38:10,206] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 14:38:10,207] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 14:38:10,231] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:38:10,234] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:38:10,236] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 14:38:10,450] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 14:38:10,450] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 14:38:10,450] ERROR CSSUTILS No content to parse.
[2025-06-20 14:38:10,450] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 14:38:10,529] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:38:10,530] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:38:10,531] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:38:10,532] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:38:10,533] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:38:10,533] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:38:10,535] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:38:10,536] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:38:10,537] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:38:10,543] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 14:38:11,735] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:38:11,743] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 14:38:11,751] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 14:38:11,752] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 14:38:11,752] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 14:38:11,752] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 14:38:11,753] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 14:38:11,753] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 14:38:11,753] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 14:38:11,754] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 14:38:11,755] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:38:11,755] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:38:11,757] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 14:38:11,773] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 14:38:12,781] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:38:12,781] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 14:38:12,791] INFO utils.services.queue_service Successfully processed queue item e050078f-db91-49e0-b2a0-27a0319d0ccc
[2025-06-20 14:38:12,794] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 14:43:24,729] INFO utils.services.content_insertion_service Processed 2 placeholders in template order_confirmation
[2025-06-20 14:43:46,752] INFO utils.services.queue_service Processed 0 queue items: 0 successful, 0 failed
[2025-06-20 14:44:08,804] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 14:44:08,816] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:44:08,819] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:44:08,821] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 14:44:08,973] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 14:44:08,973] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 14:44:08,974] ERROR CSSUTILS No content to parse.
[2025-06-20 14:44:08,975] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 14:44:09,026] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:09,026] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:09,027] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:44:09,028] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:09,028] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:09,029] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:44:09,031] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:09,031] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:09,032] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:44:09,042] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 14:44:10,221] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:44:34,606] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 14:44:34,859] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:44:34,859] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:44:34,859] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 14:44:35,051] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 14:44:35,052] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 14:44:35,053] ERROR CSSUTILS No content to parse.
[2025-06-20 14:44:35,054] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 14:44:35,099] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:35,100] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:35,100] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:44:35,101] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:35,102] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:35,103] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:44:35,104] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:35,105] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:44:35,105] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:44:35,119] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 14:44:36,226] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:45:52,421] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 14:45:53,727] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 14:46:09,266] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 14:46:10,717] INFO django.utils.autoreload Watching for file changes with StatReloader
[2025-06-20 14:46:53,101] INFO utils.services.content_insertion_service Processed 3 placeholders in template order_confirmation
[2025-06-20 14:46:53,101] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:47:02,109] INFO utils.email_service Using master template approach for order_confirmation -> order_confirmation_content
[2025-06-20 14:47:03,026] INFO utils.services.content_insertion_service Processed 3 placeholders in template order_confirmation
[2025-06-20 14:47:03,026] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:47:03,030] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:47:03,032] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 14:47:03,358] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 14:47:03,359] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 14:47:03,361] ERROR CSSUTILS No content to parse.
[2025-06-20 14:47:03,361] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 14:47:03,493] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:03,493] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:03,493] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:47:03,499] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:03,499] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:03,500] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:47:03,503] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:03,503] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:03,507] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:47:03,535] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 14:47:04,681] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:47:22,073] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:47:22,082] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:47:22,084] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:47:22,084] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:47:22,085] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:47:22,085] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:47:22,086] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 14:47:22,086] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 14:47:22,086] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 14:47:22,087] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 14:47:22,093] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 14:47:22,094] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 14:47:22,094] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 14:47:22,098] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 14:47:22,167] INFO exam_sessions_subjects_products.views --- list_products called ---
[2025-06-20 14:47:22,180] INFO exam_sessions_subjects_products.views Query params: <QueryDict: {'page': ['1'], 'page_size': ['20']}>
[2025-06-20 14:47:22,191] INFO exam_sessions_subjects_products.views Pagination: page=1, page_size=20
[2025-06-20 14:47:22,208] INFO exam_sessions_subjects_products.views Filtering subject_ids: [], subject_code: None
[2025-06-20 14:47:22,225] INFO exam_sessions_subjects_products.views Filtering main_category_ids: [], delivery_method_ids: []
[2025-06-20 14:47:22,231] INFO exam_sessions_subjects_products.views After product group filter, queryset count: 393
[2025-06-20 14:47:22,236] INFO exam_sessions_subjects_products.views Pagination: total=393, start=0, end=20, page_size=20
[2025-06-20 14:47:22,249] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1266696577741658944
[2025-06-20 14:47:22,256] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1266696577741658944
[2025-06-20 14:47:22,363] INFO exam_sessions_subjects_products.views Paginated queryset count: 20, total: 393, cached with key: products_list_1266696577741658944
[2025-06-20 14:47:29,625] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:47:29,629] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,632] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:47:29,635] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:47:29,636] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:47:29,638] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 188, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:47:29,640] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,640] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:47:29,640] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:47:29,640] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 188, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:47:29,667] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:47:29,669] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:47:29,669] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:47:29,669] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:47:29,669] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,670] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:47:29,670] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,670] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:47:29,671] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,673] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:47:29,674] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:47:29,675] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:47:29,677] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:47:29,677] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 188, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:47:29,677] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:47:29,678] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:47:29,679] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:47:29,679] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:47:29,681] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:47:29,682] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:47:29,683] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:47:29,684] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:47:29,685] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:47:29,686] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:47:29,687] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:47:29,691] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:47:29,691] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:47:29,692] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:47:29,692] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:47:29,694] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,694] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:47:29,704] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:47:29,707] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:47:29,710] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:47:29,712] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:47:29,712] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:47:29,712] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:47:29,717] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:47:29,777] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:47:29,790] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,794] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:47:29,796] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:47:29,798] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 188, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:47:29,813] INFO rules_engine.custom_functions DEBUG: check_same_subject_products called
[2025-06-20 14:47:29,814] INFO rules_engine.custom_functions DEBUG: cart_items type: <class 'list'>
[2025-06-20 14:47:29,814] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:29,815] INFO rules_engine.custom_functions DEBUG: params: {'assignment_ids': [85, 89], 'marking_ids': [117, 79]}
[2025-06-20 14:47:29,815] INFO rules_engine.custom_functions DEBUG: assignment_ids: [85, 89]
[2025-06-20 14:47:29,815] INFO rules_engine.custom_functions DEBUG: marking_ids: [117, 79]
[2025-06-20 14:47:29,816] INFO rules_engine.custom_functions DEBUG: Processing item: {'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}
[2025-06-20 14:47:29,816] INFO rules_engine.custom_functions DEBUG: product_id: 71, subject_code: CB1
[2025-06-20 14:47:29,817] INFO rules_engine.custom_functions DEBUG: assignment_subjects: set()
[2025-06-20 14:47:29,817] INFO rules_engine.custom_functions DEBUG: marking_subjects: set()
[2025-06-20 14:47:29,818] INFO rules_engine.custom_functions DEBUG: Final result: False
[2025-06-20 14:47:38,283] INFO rules_engine.custom_functions DEBUG: calculate_vat_standard called
[2025-06-20 14:47:38,284] INFO rules_engine.custom_functions DEBUG: cart_items: [{'id': 188, 'product_id': 71, 'subject_code': 'CB1', 'product_name': 'Additional Mock Pack', 'product_code': 'AMP', 'product_type': None, 'quantity': 3, 'price_type': 'standard', 'actual_price': '21.00', 'metadata': {'variationId': 1, 'variationName': 'Vitalsource eBook'}}]
[2025-06-20 14:47:38,284] INFO rules_engine.custom_functions DEBUG: params: {'function': 'calculate_vat_standard', 'vat_rate': 0.2, 'description': 'Standard UK VAT at 20%', 'threshold_amount': 0, 'exempt_product_types': ['book', 'educational_material']}
[2025-06-20 14:47:38,285] INFO rules_engine.custom_functions VAT calculation completed
[2025-06-20 14:47:38,285] INFO rules_engine.custom_functions DEBUG: VAT calculation result: {'calculation_type': 'standard_vat', 'vat_rate': 0.2, 'total_net': 63.0, 'total_vat': 12.6, 'total_gross': 75.6, 'meets_threshold': True, 'threshold_amount': 0.0, 'item_calculations': [{'item_id': 188, 'product_name': 'Additional Mock Pack', 'net_amount': 63.0, 'vat_amount': 12.6, 'gross_amount': 75.6, 'vat_rate': 0.2, 'is_exempt': False}], 'calculation_timestamp': None}
[2025-06-20 14:47:38,293] INFO cart.views Using default country 'United Kingdom' for user eugenelo4@bpp.com
[2025-06-20 14:47:38,303] INFO utils.email_service Development mode: Redirecting email from ['eugenelo4@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:47:38,307] INFO utils.services.queue_service Found template configuration for order_confirmation
[2025-06-20 14:47:38,308] DEBUG utils.services.queue_service Successfully serialized context for order_confirmation
[2025-06-20 14:47:38,311] INFO utils.services.queue_service Queued email 4b740541-6e15-4f4f-8607-63bb94ef5cf7 for 2 recipients
[2025-06-20 14:47:38,312] INFO utils.email_service Email queued successfully: 4b740541-6e15-4f4f-8607-63bb94ef5cf7
[2025-06-20 14:47:38,312] INFO cart.views Order confirmation email queued successfully for order ORD-000061 to eugenelo4@bpp.com
[2025-06-20 14:47:52,593] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 14:47:52,594] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 14:47:52,594] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 14:47:52,594] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 14:47:52,595] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 14:47:52,595] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 14:47:52,595] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 14:47:52,596] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 14:47:52,622] INFO utils.services.content_insertion_service Processed 3 placeholders in template order_confirmation
[2025-06-20 14:47:52,623] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:47:52,626] INFO utils.email_service Development mode: Redirecting email from ['eugenelo@bpp.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:47:52,628] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 14:47:52,822] ERROR CSSUTILS MediaQuery: No match: ('IDENT', 'mso', 240, 10)
[2025-06-20 14:47:52,823] ERROR CSSUTILS MediaQuery: No match for None in Choice(Sequence(ONLY|NOT, media_type, Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))), Sequence(Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END), Sequence(AND, Sequence(expression, media_feature, Sequence(colon, Choice(ColorValue, Dimension, Value)), expression END))))
[2025-06-20 14:47:52,825] ERROR CSSUTILS No content to parse.
[2025-06-20 14:47:52,825] ERROR CSSUTILS MediaQuery: No content.
[2025-06-20 14:47:52,887] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:52,887] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:105: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:52,888] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:47:52,890] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:52,891] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:140: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:52,892] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:47:52,895] ERROR CSSUTILS Property: No ":" after name found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:52,896] ERROR CSSUTILS Property: No property value found: \n\t\t\t\t\t\t\t [1:138: \n\t\t\t\t\t\t\t]
[2025-06-20 14:47:52,896] ERROR CSSUTILS CSSStyleDeclaration: Syntax Error in Property: \n\t\t\t\t\t\t\t
[2025-06-20 14:47:52,916] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 14:47:54,159] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:47:54,196] INFO utils.services.queue_service Email sent successfully to eugenelo@bpp.com
[2025-06-20 14:47:54,209] INFO utils.services.queue_service Found 0 attachments for template order_confirmation
[2025-06-20 14:47:54,209] DEBUG utils.services.queue_service DEBUG: Processing template 'order_confirmation' (ID: 1)
[2025-06-20 14:47:54,210] DEBUG utils.services.queue_service DEBUG: Use master template: True
[2025-06-20 14:47:54,210] DEBUG utils.services.queue_service DEBUG: Content template name: order_confirmation_content
[2025-06-20 14:47:54,210] DEBUG utils.services.queue_service DEBUG: Using MASTER TEMPLATE system for order_confirmation
[2025-06-20 14:47:54,210] DEBUG utils.services.queue_service DEBUG: Master template mapping: order_confirmation -> order_confirmation_content
[2025-06-20 14:47:54,211] DEBUG utils.services.queue_service DEBUG: Content template file path: C:\Code\Admin3\backend\django_Admin3\utils\templates\emails\mjml\order_confirmation_content.mjml
[2025-06-20 14:47:54,212] DEBUG utils.services.queue_service DEBUG: Content template file exists: True
[2025-06-20 14:47:54,226] INFO utils.services.content_insertion_service Processed 3 placeholders in template order_confirmation
[2025-06-20 14:47:54,226] INFO utils.email_service Processed dynamic content for template: order_confirmation
[2025-06-20 14:47:54,227] INFO utils.email_service Development mode: Redirecting email from ['eugene.lo1030@gmail.com'] to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:47:54,228] INFO utils.email_service MJML compilation successful for dynamic content
[2025-06-20 14:47:54,249] DEBUG utils.email_service Applied Outlook compatibility enhancements to MJML-generated HTML
[2025-06-20 14:47:55,446] INFO utils.email_service Dynamic MJML email sent successfully with Outlook enhancement to ['eugenelo@bpp.com', 'eugene.lo1030@gmail.com']
[2025-06-20 14:47:55,449] INFO utils.services.queue_service Email sent successfully to eugene.lo1030@gmail.com
[2025-06-20 14:47:55,452] INFO utils.services.queue_service Successfully processed queue item 4b740541-6e15-4f4f-8607-63bb94ef5cf7
[2025-06-20 14:47:55,455] INFO utils.services.queue_service Processed 1 queue items: 1 successful, 0 failed
[2025-06-20 14:48:13,580] INFO django.utils.autoreload C:\Code\Admin3\backend\django_Admin3\utils\email_service.py changed, reloading.
[2025-06-20 14:48:14,704] INFO django.utils.autoreload Watching for file changes with StatReloader
